window["geobase_client_build"]="15/10/2010 12:28:16 p.m.";window["GB_VERSION"]="3.5.2.13";(function(){(function(){window.offscreenBuffer=true;var A1=document.createElement("meta");A1.setAttribute("http-equiv","imagetoolbar");A1.setAttribute("content","no");document.getElementsByTagName("head")[0].appendChild(A1)})();var Aq,o,Am,AM,p,Aa,v,Ab,c,AR,F,y,Z,E,I,q,AY,C,AS,P,Ae,L,AO,AT,AJ,AX,U,Av,Ah,D,AN,r,G,Ay,S,Ai,k,AF,Q,d,Ak,a,Au,AA,K,J,AC,u,As,At,O,s,AH,x,f,Ag,h,Al,n,V,AV,w,Az,Ax,AB,b,g,AU,Y,AQ,T,H,AI,A,AP,Af,AG,N,Ar,AW,Ap,j,Aw,Ad,m,Ao,An=Math.PI,B=Math.abs,X=Math.asin,AE=Math.atan,R=Math.atan2,AZ=Math.ceil,Aj=Math.cos,i=Math.exp,M=Math.floor,AL=Math.log,Ac=Math.max,AD=Math.min,t=Math.pow,A0=Math.round,l=Math.sin,e=Math.sqrt,AK=Math.tan,W=[],z=true;(function(){window.Telogis={};var A2;var A1;AS=Telogis.GeoBase={destroy:function(){Am.destroyInstances();Q.destroyInstances();P.destroy();A(AS);o.flush()},disableValidation:function(){z=false},enableValidation:function(){z=true},getCopyright:function(A4){var A3=function(A5){A4("Copyright \xA9"+A5)};P.invoke(P.SETTINGS_PAGE,"GetCopyrightString",null,A3)},getAvailableData:function(A3){P.invoke(P.SETTINGS_PAGE,"GetAvailableData",[],A3)},getDefaultDataSet:function(A3){P.invoke(P.SETTINGS_PAGE,"GetDefaultDataSet",[],A3)},setAuthToken:function(A3,A4){P.register(A3);if(!isNaN(A4)){setTimeout(function(){AS.AuthExpiry.trigger()},A4)}},addDataSet:A2=function(A3){W.push(A3.toString())},addDataSets:function(A3){for(var A4=0,A5=A3.length;A4<A5;A4++){A2(A3[A4].toString())}},clearDataSets:function(){W=[]},removeDataSet:A1=function(A4){var A3=v.indexOf(W,A4.toString());W.splice(A3,1)},removeDataSets:function(A3){for(var A4=0,A5=A3.length;A4<A5;A4++){A1(A3[A4].toString())}},setDataSet:function(A3){W=[A3.toString()]},setDataSets:function(A4){W=[];for(var A3=0;A3<A4.length;A3++){W[A3]=A4[A3].toString()}},setService:function(A3){AT.serviceURLs=AT.getServiceSet(A3)}}})();(function(){AY=Telogis.GeoBase.Errors={};var A1=function(A2){var A5=function(A6){this.message=""+A6};var A3=Ag||Error;var A4=new A3();A2+="Error";A4.name="Telogis.GeoBase.Errors."+A2;A4.toString=function(){return this.name+": "+this.message};A5.prototype=A4;AY[A2]=A5;return A5};Ag=A1("GeoBase");At=A1("AJAX");O=A1("ArgumentType");s=A1("Auth");AH=A1("Class");x=A1("Configuration");f=A1("EnumValue");h=A1("JSON");Al=A1("Layout");n=A1("NotReady");V=A1("RPC");AV=A1("Scope");w=A1("ShapeMetric");d=A1("TimeOut");Az=A1("XML")})();(function(){v=AS.Arrays=function(){var A2,A1,A3;return{contains:function(A4,A6){if(!A4){return }var A5=A2(A4,A6);if(!isNaN(A5)){return A5!==-1}},count:function(A4){if(typeof (A4)!=="object"){return }var A6=0;for(var A5 in A4){if(A4.hasOwnProperty(A5)){A6++}}return A6},indexOf:A2=function(A4,A6){if(!(A4 instanceof Array)){return }if(A4.indexOf){return A4.indexOf(A6)}else{for(var A5=0,A7=A4.length;A5<A7;A5++){if(A4[A5]===A6){return A5}}return -1}},intersection:function(){var BB=arguments[0],BD;if(!(BB instanceof Array)){return }for(var A9=0,A4=arguments.length;A9<A4;A9++){BD=[];var BA=arguments[A9];if(!(BA instanceof Array)){break}var A7=BB.length,A6=BA.length;for(var A8=0;A8<A7;A8++){var BC=BB[A8];for(var A5=0;A5<A6;A5++){if(BC===BA[A5]){BD.push(BC)}}}BB=BD}return A3(BD)},move:function(A5,A9,A8){if(!(A5 instanceof Array)){return }if(isNaN(A9)||isNaN(A8)){return }var A4=A5.slice(),A7=A5.length;if(A9<0||A9>=A7){return A4}if(A8<0||A8>=A7){return A4}var A6=A5[A9];A4.splice(A9,1);A4.splice(A8,0,A6);return A4},place:function(A5,A8,A6){if(!(A5 instanceof Array)){return }var A4=A5.slice(),A7=A1(A4,A8,A6);A4.splice(A7,0,A8);return A4},query:function(A4,A7){if(!(A4 instanceof Array)){return }if(typeof (A7)!=="function"){return }var A6=A4.length;for(var A5=0;A5<A6;A5++){if(A7(A4[A5])){return A5}}return -1},search:A1=function(A4,A8,A5){if(!(A4 instanceof Array)){return }A5=A5||function(BB,BA){return BB-BA};var A6=A4.length,A9=-1;while(A6-A9>1){var A7=A6+A9>>1;if(A5(A4[A7],A8)<0){A9=A7}else{A6=A7}}return A6},swap:function(A5,A9,A8){if(!(A5 instanceof Array)){return }var A4=A5.slice(),A7=A4[A9],A6=A4[A8];if(typeof (A7)==="undefined"){return A4}if(typeof (A6)==="undefined"){return A4}A4[A9]=A6;A4[A8]=A7;return A4},toSet:A3=function(A5){if(!(A5 instanceof Array)){return }var A4=[],A8=A5.length;for(var A7=0;A7<A8;A7++){for(var A6=A7+1;A6<A8;A6++){if(A5[A7]===A5[A6]){A6=++A7}}A4.push(A5[A7])}return A4},toString:function(A4){if(!(A4 instanceof Array)){return }var A8="",A7="",A6=A4.length;for(var A5=0;A5<A6;A5++){A8+=A7+A4[A5];A7=", "}return"["+A8+"]"}}}()})();(function(){AG=function(A4,A3){var A6="";var A5="";if(!A3){A3=4}var A2=0;for(var A1 in A4){if(typeof (A4[A1])!=="function"){A2++;if(A2>A3){break}A5+=A6+A1;A6=", "}}if(A2>A3){A5+=A6+"..."}return"{"+A5+"}"};AS.Objects={freeHandlers:A=function(A2){for(var A1 in A2){if(A2.hasOwnProperty(A1)){if(A2[A1] instanceof C){AI(A2,A1)}}}},freeProperty:AI=function(A4,A2){if(typeof (A4[A2])==="undefined"){E.warn("could not free '"+A2+"' property: not found.");return }if(A4[A2] instanceof Array){for(var A1=A4[A2].length-1;A1>=0;A1--){if(A4[A2][A1]){AI(A4[A2],A1);A4[A2].splice(A1,1)}}}else{if(typeof (A4[A2])==="object"&&A4[A2]){if(N(A4[A2])){T(A4[A2])}else{if(typeof (A4[A2].destroy)==="function"){A4[A2].destroy()}}}}try{delete A4[A2]}catch(A5){try{A4[A2]=null}catch(A3){E.warn("could not free '"+A2+"' property: access denied.")}}},isElement:N=function(A2){if(!A2||typeof (A2)!=="object"){return false}var A1=A2.nodeType,A3=A2.nodeName;return(typeof (A1)==="number"||(A1 instanceof Number))&&(typeof (A3)==="string"||(A3 instanceof String))},lookupObject:function(A2,A1){A1=A1||window;var A4=A2.split(".");for(var A6=A4.length,A3=0;A3<A6;A3++){var A5=A4[A3];if(A5===""){continue}if(typeof (A1)!=="object"){A1=null;break}else{A1=A1[A5]}}return A1}}})();(function(){E=AS.Console=function(){var A3,A7,A2,A6=function(A8){if(typeof (console)==="object"){console.log(""+A8)}},A5=A6,A4=null,A1=0;return{WARNING_PREFIX:A3="** warning: ",getWarningCount:function(){return A1},off:function(){A4=A5;A7(null)},on:function(){if(A4){A5=A4}},redirect:A7=function(A9){var A8=typeof (A9);if(A8==="undefined"){A5=A6}else{if(A8!=="function"){A5=null}else{A5=function(BA){A9(""+BA)}}}},resetWarningCount:function(){A1=0},warn:function(A8){A1++;A2(A3+A8)},writeLine:A2=function(A8){if(typeof (A8)==="undefined"){A8=""}if(A5){A5(A8)}}}}()})();(function(){AT=function(){var A1=0;Y=function(A4,A3){if(typeof (A3)!=="object"){A3={}}for(var A2 in A4){if(A4.hasOwnProperty(A2)){A3[A2]=A4[A2]}}return A3};AP=function(){var A3=W.length;if(A3){var A4="";var A5="&data=";for(var A2=0;A2<A3;A2++){A5+=A4+W[A2];A4=","}return A5}else{return""}};return{getServiceSet:function(A2){var A5=(A2 instanceof Array)?A2.slice():[A2];for(var A4=0,A6=A5.length;A4<A6;A4++){var A3=A5[A4];if(A3.charAt(A3.length-1)!=="/"){A5[A4]+="/"}}return A5},getServiceURL:function(){var A2=AT.serviceURLs;A1=(A1+1)%A2.length;return A2[A1]},serviceURLs:["http://localhost/geostream/"],USE_ACTIVEX:(typeof (ActiveXObject)==="function"),USE_IE:(navigator.appName.indexOf("Microsoft")!==-1),USE_FF2:(navigator.userAgent.indexOf("Firefox/2")!==-1),ZIndices:{INACTIVE_TILE_TRANSITION:10,TILE:20,PATH:30,REGION:40,FENCE:50,CANVAS_LAYER:60,OBJECT:70,BALLOON:80,BALLOON_RAISED:85,ACTIVE_TILE_TRANSITION:90,ZOOM_INDICATOR:100,COPYRIGHT:110,MAP_CONTROL:120,MENU:130,TOP:9999999}}}()})();(function(){Aq=AS.Class=function(){var A9={};var A2=1;var BB={};var A5={};var A1={};var A7={};var BF={};var BA={};var BE={};var BD={};var A6=function(BK,BG,BJ){var BH;var BI=BK.prototype;if(BG){for(BH in BG){if(BG.hasOwnProperty(BH)){BI[BH]=BG[BH]}}}if(BJ){for(BH in BJ){if(BJ.hasOwnProperty(BH)){BK[BH]=BJ[BH]}}}if(BG&&BG.hasOwnProperty("toString")){BI.toString=BG.toString}};var A4=function(BH,BJ){var BG=BJ.validConfigs;for(var BI in BH){if(BH.hasOwnProperty(BI)&&!BG[BI]){throw new x("Unrecognised configuration property: "+BI)}}};var A8=function(BG){var BH=function(BI){return function(){var BJ=arguments[0];if(BJ===A9){return }if(!(this instanceof BH)){throw new AV("invalid managed class instance. Did you forget 'new'?")}if(BI.validConfigs&&typeof (BJ)==="object"){A4(BJ,BI)}BI.apply(this,arguments)}}(BG.init);return BH};var BC=function(BL,BI,BK){var BJ=BK[BL.id];var BG=null;if(BJ){BG=BJ[BI]}if(!BG){var BH=BL.Base;BG=BH?BC(BH,BI,BK):BI}return BG};var A3=function(BH,BK){for(var BG=0,BJ=BH.length;BG<BJ;BG++){var BI=BH[BG];if(!BK.hasOwnProperty(BI)){throw new AH("Incomplete implementation of abstract class: missing property '"+BI+"'.")}}};return{configure:b=function(BM,BN){BN=BN||[];var BQ=BM.prototype.init;var BG=BQ.validConfigs||{};for(var BI=0,BL=BN.length;BI<BL;BI++){var BR=BN[BI];if(BR instanceof Array){for(var BH=0,BK=BR.length;BH<BK;BH++){BG[BR[BH]]=true}}else{BG[BN[BI]]=true}}var BJ=BM.Base;if(BJ){var BO=BJ.prototype.init.validConfigs;if(typeof (BO)==="object"){for(var BP in BO){if(BO.hasOwnProperty(BP)){BG[BP]=true}}}}BQ.validConfigs=BG},create:g=function(BG,BH){return H(null,BG,BH)},createUnmanaged:AU=function(BG,BI){var BH=BG.init||function(){};A6(BH,BG,BI);BH.id=A2++;BB[BH.id]=BH;return BH},extend:H=function(BI,BG,BK){if(typeof (BI)==="undefined"){throw new AH("undefined base class")}if(!BG){BG={}}if(!BK){BK={}}if(!BG.init){if(BI){BG.init=function(){BI.prototype.init.apply(this,arguments)}}else{BG.init=function(){}}}var BL=A8(BG);BL.id=A2++;BL.Derived=[];BB[BL.id]=BL;if(BI){BL.Base=BI;BI.Derived.push(BL);BL.prototype=new BI(A9);BL.prototype.constructor=BL;var BJ=BI.virtualProps;if(BJ){A3(BJ,BG)}for(var BH in BI){if(BI.hasOwnProperty(BH)){switch(BH){case"Base":case"Derived":case"id":case"prototype":case"virtualProps":break;default:BL[BH]=BI[BH];break}}}}else{BL.Base=null}A6(BL,BG,BK);return BL},getDNClassDesc:function(BG){return A5[BG.id]||null},getDNPropName:function(BH,BG){return BC(BH,BG,A1)},getInstantiator:function(BG){return A7[BG.id]||null},getJSClass:function(BJ){var BK=BE[BJ[1]];if(BK){var BH=BJ[0];var BG=BH.indexOf("`");if(BG>=0){BH=BH.substr(0,BG+2)}var BI=BK[BH];if(BI){return BB[BI]}}else{return null}},getJSPropName:function(BH,BG){return BC(BH,BG,BA)},isConfigured:function(BG){var BH=BG.prototype.init;return(BH&&typeof (BH.validConfigs)==="object")},isSerializable:function(BH,BJ){if(!BJ&&(BH===Number||BH===String||BH===Array||BH===Object||BH===Boolean)){return true}if(!BH.id||!A5.hasOwnProperty(BH.id)){return false}var BG=true;var BI=BH;do{if(BJ){var BK=BD[BI.id];BG=!BK||!BK[BJ]}BG=BG&&!BF[BI.id]}while(BG&&(BI=BI.Base));return BG},serializeAs:j=function(BI,BH,BG){if(!BG){BH="Telogis.GeoBase."+BH;BG="geobase.net"}var BJ=BE[BG]=BE[BG]||{};BJ[BH]=BI.id;A5[BI.id]=[BH,BG]},serializeWith:Aw=function(BG,BK){var BI=BA[BG.id]=BA[BG.id]||{};var BN=A1[BG.id]=A1[BG.id]||{};for(var BJ=0,BH=BK.length;BJ<BH;BJ++){var BL=BK[BJ];if(BL.length!==2){throw new AH("invalid serialization property alias: "+BL)}var BO=BL[0];var BM=BL[1];BI[BM]=BO;BN[BO]=BM}},serializeWithout:Ad=function(BG,BI){if(!BI){BF[BG.id]=true}else{if(!BD[BG.id]){BD[BG.id]={}}var BJ=BD[BG.id];for(var BH=0;BH<BI.length;BH++){BJ[BI[BH]]=true}}},setInstantiator:m=function(BG,BH){A7[BG.id]=BH},virtualize:Ao=function(BH,BG){var BJ=BH.virtualProps=BH.virtualProps||[];for(var BI=0,BK=BG.length;BI<BK;BI++){BJ.push(BG[BI])}}}}()})();(function(){Z=AS.Color=g({r:0,g:0,b:0,a:1,init:function(A4,A3,A1,A2){if(isNaN(A4)){if(typeof (A4)==="object"){this.init(A4.r,A4.g,A4.b,A4.a)}}else{this.r=A4;if(!isNaN(A3)){this.g=A0(A3)}if(!isNaN(A1)){this.b=A0(A1)}if(!isNaN(A2)){this.a=A2}}},fromCSSHex:function(A1){var A2=A1.search("#");if(A2!==-1){A1=A1.substr(A2+1)}var A3=+("0x"+A1);this.r=M(A3/65536);A3-=this.r*65536;this.g=M(A3/256);A3-=this.g*256;this.b=M(A3)},fromHSV:function(A7,BC,BB){var A1,A8,BA;if(!BC){A1=BB;A8=BB;BA=BB}else{var A6=A7/60;var A9=M(A6);var A4=A6-A9;var A5=BB*(1-BC);var A3=BB*(1-BC*A4);var A2=BB*(1-BC*(1-A4));switch(A9){case 1:A1=A3;A8=BB;BA=A5;break;case 2:A1=A5;A8=BB;BA=A2;break;case 3:A1=A5;A8=A3;BA=BB;break;case 4:A1=A2;A8=A5;BA=BB;break;case 5:A1=BB;A8=A5;BA=A3;break;default:A1=BB;A8=A2;BA=A5;break}}this.r=A0(A1*255);this.g=A0(A8*255);this.b=A0(BA*255)},toCSSHex:function(){var A4=this.b+256*this.g+65536*this.r;var A3=A4.toString(16);var A2="#";var A1;for(A1=0;A1<6-A3.length;A1++){A2+="0"}for(A1=0;A1<A3.length;A1++){A2+=A3.charAt(A1)}return A2},toCSSRGBA:function(){return"rgba("+this.r+","+this.g+","+this.b+","+this.a+")"}});I=AS.DistanceUnit={FEET:"ft",KILOMETERS:"km",KNOTS:"kt",METERS:"m",MILES:"mi",RADIANS:"rad",YARDS:"yd"};AS.FeatureInfo=function(){var A1=g({toString:function(){return this._offset+"_"+this._file}});j(A1,"FeatureInfo");Aw(A1,[["_offset","offset"],["_file","file"]]);return A1}();AS.DataSet=function(){var A1=g({toString:function(){return this.name}});j(A1,"GeoStream.Server.DataSet");Aw(A1,[["name","m_name"],["countries","m_countries"]]);return A1}();AS.DataFolder=function(){var A1=H(AS.DataSet,{});j(A1,"GeoStream.Server.DataFolder");return A1}();AS.SingleDataSet=function(){var A1=H(AS.DataSet,{});j(A1,"GeoStream.Server.SingleDataSet");return A1}();AJ=AS.LatLon=AU({init:function(A1,A2){if((typeof (A1)==="number"||(A1 instanceof Number))&&(typeof (A2)==="number"||(A2 instanceof Number))){this.lat=A1;this.lon=A2}else{if(A1 instanceof AJ){this.lat=+A1.lat;this.lon=+A1.lon}}},lat:0,lon:0,distanceTo:function(A1,A2){return D.distance(this,A1,A2)},equals:function(A1,A2){if(isNaN(A2)){A2=0}var A4=this.wrap();var A3=A1.wrap();return B(A4.lat-A3.lat)<=A2&&B(A4.lon-A3.lon)<=A2},toString:function(A1){if(typeof (A1)!=="number"){A1=6}if(-180<=this.lon&&this.lon<=180){return"("+this.lat.toPrecision(A1)+", "+this.lon.toPrecision(A1)+")"}else{return this.wrap().toString(A1)}},wrap:function(){return new AJ(this.lat,D.positiveModulo(this.lon+180,360)-180)}},{SERIAL_DP:9});j(AJ,"LatLon");Aw(AJ,[["lat","Lat"],["lon","Lon"]]);AS.POI=function(){var A1=g({_foodType:null,_loc:null,_name:null,_phoneNumber:null,_type:null,getFoodType:function(){return this._foodType},getLocation:function(){return new AJ(this._loc)},getName:function(){return this._name},getPhoneNumber:function(){return this._phoneNumber},getType:function(){return this._type},toString:function(){var A3=this._name,A2=this._phoneNumber;if(A2){A3+=" ("+A2+")"}return A3}});j(A1,"Poi");Aw(A1,[["_foodType","FoodType"],["_loc","Location"],["_name","Name"],["_phoneNumber","Phone"],["_type","Type"]]);return A1}();AS.POIType={AIRPORT:4581,AMUSEMENT_PARK:7996,ATM:3578,AUTOMOBILE_CLUB:8699,BANK:6000,BOOK_STORE:9995,BORDER_CROSSING:9999,BOWLING_CENTER:7933,BRITISH_RAIL:10001,BUS_STATION:4170,BUSINESS:5000,BUSINESS_SERVICE:9994,CAR_DEALER:5511,CAR_REPAIR:7538,CASINO:7985,CEMETERY:9591,CHURCH:9992,CINEMA:7832,CITY_HALL:9121,COFFEE_SHOP:9996,CONVENTION_CENTER:7990,COMMUNITY_CENTER:7994,COMMUTER_RAIL_STATION:4100,COURT_HOUSE:9211,FERRY_TERMINAL:4482,FIRE_STATION:7392,GOLF_COURSE:7992,GROCERY_STORE:5400,HIGHER_EDUCATION:8200,HOSPITAL:8060,HOTEL_MOTEL:7011,ICE_SKATING_RINK:7998,LIBRARY:8231,LONDON_UNDERGROUND:10002,MARINA:4493,MONUMENT:5999,MOTORCYCLE_DEALERSHIP:5571,MUSEUM:8410,NIGHTLIFE:5913,PARK:7947,PARK_AND_RIDE:7522,PARKING_GARAGE:7521,PARKING_LOT:7520,PERFORMING_ARTS:7929,PETROL_STATION:5540,PHARMACY:9997,POLICE_STATION:9221,PUBLIC_SPORT_AIRPORT:4580,RENTAL_CAR:7510,REST_AREA:7897,RESTAURANT:5800,SCHOOL:8211,SHOPPING:6512,SKI_RESORT:7012,SPORTS_CENTER:7997,SPORTS_COMPLEX:7940,TOURIST_ATTRACTION:7999,TOURIST_INFORMATION:7389,TRAIN_STATION:4013,UNKNOWN:0,WINERY:2084};G=AS.Point=AU({init:function(A1,A2){if(typeof (A1)==="number"||(A1 instanceof Number)){this.x=A1;this.y=((typeof (A2)==="number"||(A2 instanceof Number))?A2:A1)}else{if(typeof (A1)==="object"){if(A1 instanceof G){this.x=A1.x;this.y=A1.y}else{if(A1 instanceof AF){this.x=A1.width;this.y=A1.height}else{if(A1.offsetLeft||A1.offsetTop){this.x=A1.offsetLeft;this.y=A1.offsetTop}else{if(A1.left&&A1.top){this.x=A1.left;this.y=A1.top}else{if(A1.style.left&&A1.style.top){this.x=parseInt(A1.style.left);this.y=parseInt(A1.style.top)}}}}}}}},x:0,y:0,add:function(A1){this.x+=A1.x;this.y+=A1.y;return this},distSqr:function(A1){var A2=new G(this.x-A1.x,this.y-A1.y);return A2.x*A2.x+A2.y*A2.y},equals:function(A1,A2){if(isNaN(A2)){A2=0}return B(this.x-A1.x)<=A2&&B(this.y-A1.y)<=A2},midPoint:function(A1){return new G(A0((this.x+A1.x)/2),A0((this.y+A1.y)/2))},multiply:function(A1){this.x*=A1;this.y*=A1;return this},round:function(){this.x=A0(this.x);this.y=A0(this.y);return this},subtract:function(A1){this.x-=A1.x;this.y-=A1.y;return this},toString:function(){return"("+this.x+", "+this.y+")"}});AS.Rectangle=function(){var A1=g({init:function(){this.x1=0;this.x2=0;this.y1=0;this.y2=0}});j(A1,"Rectangle");return A1}();AS.RemoteStreetLink=function(){var A1=g({toString:function(){return this._street.toString()}});j(A1,"RemoteStreetLink");Aw(A1,[["_firstNumberLeft","LAddrRef"],["_firstNumberRight","RAddrRef"],["_flags","Flags"],["_lastNumberLeft","LAddrNRef"],["_lastNumberRight","RAddrNRef"],["_linkID","linkid"],["_linkNumber","linkno"],["_names","Names"],["_points","Points"],["_postcodeLeft","LPostcode"],["_postcodeRight","RPostcode"],["_street","Street"],["_zLevelEnd","Z_End"],["_zLevelStart","Z_Start"]]);return A1}();AF=AS.Size=function(){var A1=function(A4,A3){if(typeof (A4)==="number"||(A4 instanceof Number)){this.width=A4;this.height=((typeof (A3)==="number"||(A3 instanceof Number))?A3:A4)}else{if(typeof (A4)==="object"){if(A4 instanceof A1){this.width=A4.width;this.height=A4.height}else{if(A4 instanceof G){this.width=A4.x;this.height=A4.y}else{if(A4.offsetWidth||A4.offsetHeight){this.width=A4.offsetWidth;this.height=A4.offsetHeight}else{if(A4.width&&A4.height){this.width=A4.width;this.height=A4.height}else{if(A4.style.width&&A4.style.height){this.width=parseInt(A4.style.width);this.height=parseInt(A4.style.height)}}}}}}}};var A2=A1.prototype;A2.width=0;A2.height=0;A2.isNonZero=function(){return(this.width!==0||this.height!==0)};A2.multiply=function(A3){this.width*=A3;this.height*=A3;return this};A2.toString=function(){return""+this.width+"x"+this.height};return A1}();AS.Street=function(){var A1=g({toString:function(){var A3="";var A2=0;while(!this._points[A2]&&A2<this._points.length){A2++}if(this._points[A2]){A3+=new AJ(this._points[A2]).toString();if(this._points[this._points.length-1]){A3+=" -> ";A3+=new AJ(this._points[this._points.length-1]).toString()}}if(this._linkID){if(this._points[A2]){A3+=": "}A3+=this._linkID.toString()}return A3}});j(A1,"Street");Aw(A1,[["_flags","Flags"],["_linkID","link_id"],["_links","m_links"],["_names","names"],["_linkCount","num_links"],["_points","Points"],["_zipLeft","leftzip"],["_zipRight","rightzip"]]);return A1}();AR=AS.BoundingBox=function(){var A1=function(){var A4=this.getSW();var A3=this.getNE();delete this._items;this.add(A4);this.add(A3)};var A2=g({init:function(A4,A3){if(A4){this.add(A4);if(A3){this.add(A3)}}},_items:null,add:function(A6){if(A6 instanceof A2){this.add(A6.getSW());this.add(A6.getNE())}else{if(A6 instanceof AJ){var A3=this._items,A4=A6.lat,A5=A6.lon;if(!A3){this._items=[A4,A5,A4,A5]}else{if(A4<A3[0]){A3[0]=A4}else{if(A4>A3[2]){A3[2]=A4}}if(A5<A3[1]){A3[1]=A5}else{if(A5>A3[3]){A3[3]=A5}}}}}},getCenter:function(){var A3=this._items;return new AJ((A3[0]+A3[2])/2,(A3[1]+A3[3])/2)},contains:function(A3){if(A3 instanceof AJ){var A4=this._items;return A4&&A4[0]<=A3.lat&&A3.lat<=A4[2]&&A4[1]<=A3.lon&&A3.lon<=A4[3]}else{if(A3 instanceof A2){return this.contains(A3.getSW())&&this.contains(A3.getNE())}}},getNE:function(){var A3=this._items;return new AJ(A3[2],A3[3])},getSW:function(){var A3=this._items;return new AJ(A3[0],A3[1])},inflate:function(A4){var A3=this._items;A3[0]-=A4;A3[1]-=A4;A3[2]+=A4;A3[3]+=A4;A1.call(this)},inflateBy:function(A7){var A6=this._items,A8=A6[3]-A6[1],A3=A6[2]-A6[0],A5=A8*(A7-1)/2,A4=A3*(A7-1)/2;A6[0]-=A4;A6[1]-=A5;A6[2]+=A4;A6[3]+=A5;A1.call(this)},intersects:function(A3){var A4=this._items,A5=A3._items;return A4&&A4[0]<=A5[2]&&A4[1]<=A5[3]&&A4[2]>=A5[0]&&A4[3]>=A5[1]}});j(A2,"BoundingBox");return A2}()})();(function(){var A2=v.contains,A1=v.indexOf;C=AS.EventHandler=AU({init:function(){this._callbacks=[];this._transients=[]},_callbacks:null,_enabled:true,_transients:null,append:function(A3){this._callbacks.push(A3)},appendOnce:function(A3){A3.__once=true;this._callbacks.push(A3)},appendTransient:function(A4,A3){if(A3){this._transients=[A4]}else{this._transients.push(A4)}},disable:function(){this._enabled=false},destroy:function(){delete this._callbacks;delete this._transients},enable:function(){this._enabled=true},isRegistered:function(A3){return A2(this._callbacks,A3)||A2(this._transients,A3)},remove:function(A3){this._callbacks.splice(A1(this._callbacks,A3),1)},replace:function(A3){this.appendTransient(A3,true)},trigger:function(){var A6=this._callbacks,A5=this._transients;if(!this._enabled||!A6){return }var A4,A7,A3=arguments;if(A5.length>0){A7=A5.shift();A7.apply(window,A3)}else{for(A4=0;A4<A6.length;A4++){if((A6=this._callbacks)&&A6[A4]){A7=A6[A4];if(A7.__once){A6.splice(A4--,1)}A7.apply(window,A3)}}}}});Ad(C);AS.AuthExpiry=new C()})();(function(){AT.DOM=function(){var A8=AT.USE_FF2,A4=AT.USE_IE,A7,A5,A9,A3,BB,BE,A6="__naturalZIndex",A2=(typeof (getComputedStyle)==="function"),BA=null,BD={},BF=null,A1=function(BM){var BL=BM,BI=0,BO=0;while(BL){var BJ=A2?getComputedStyle(BL,null):BL.currentStyle,BN=parseInt(A2?BJ.getPropertyValue("border-left-width"):BJ.borderLeftWidth),BK=parseInt(A2?BJ.getPropertyValue("border-top-width"):BJ.borderTopWidth);if(!isNaN(BN)){BI+=BN}if(!isNaN(BK)){BO+=BK}BL=BL.offsetParent}return new AS.Point(BI,BO)},BC=function(BL){var BK=BL,BI=0,BN=0;while(BK){var BM=BK.offsetLeft,BJ=BK.offsetTop;if(!isNaN(BM)){BI+=BM}if(!isNaN(BJ)){BN+=BJ}BK=BK.offsetParent}return new AS.Point(BI,BN)},BH={absMousePos:A7=function(BN){var BM,BK,BL,BP=0,BO=0;if(BK=BN.pageX,BL=BN.pageY,(BK||BL)&&!A8){BP=BK;BO=BL}else{if((BM=BN.currentTarget)===window){BP=BN.screenX+BM.pageXOffset;BO=BN.screenY+BM.pageYOffset}else{if(BK=BN.clientX,BL=BN.clientY,BK||BL){var BJ=document.body,BI=document.documentElement;BP=BK+BJ.scrollLeft+BI.scrollLeft;BO=BL+BJ.scrollTop+BI.scrollTop}}}return new AS.Point(BP,BO)},applyStyle:function(BL,BK){var BI=BL.style;for(var BJ in BK){if(BK.hasOwnProperty(BJ)){BI[BJ]=BK[BJ]}}},bordersOutside:function(){if(typeof (BE)==="undefined"){var BJ=document.createElement("div"),BI=BJ.style;BI.position="absolute";BI.left="-20px";BI.top="0px";BI.width="10px";BI.height="10px";BI.border="5px solid black";document.body.appendChild(BJ);BE=(BJ.offsetWidth>10);document.body.removeChild(BJ)}return BE},clearPosition:function(BJ){var BI=BJ.style;BI.position="absolute";BI.left=BI.right=BI.top=BI.bottom=""},createElement:AQ=function(BI,BJ,BM,BL){var BK=document.createElement(BI);A5(BK);if(BM){BK.id=BM}if(typeof (BL)==="function"){BL(BK)}if(typeof (BJ)==="string"||(BJ instanceof String)){BJ=document.getElementById(BJ)}if(BJ){BJ.appendChild(BK)}return BK},detachElement:T=function(BI){var BJ="geobase_garbage";if(!BI){return }if(!BA){BA=document.createElement("div");BA.id=BJ;BA.style.display="none";document.body.appendChild(BA)}BB(BI);if(BI.id===BJ){BI.parentNode.removeChild(BI)}else{BA.appendChild(BI);BA.innerHTML=""}},disableSelection:A5=function(){if(A4){return function(BJ){BJ.unselectable="on"}}else{var BI=document.createElement("div").style;if("MozUserSelect" in BI){return function(BJ){BJ.style.MozUserSelect="none"}}else{return function(BJ){BJ.onselectstart=AW}}}}(),enableTranslucency:function(BJ){var BI=BJ.style;if(BJ&&("filters" in BI)){var BK=BI.filter||"";BK+=" progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+BJ.src+"');";BI.filter=BK}},getImageSize:Af=function(BK,BL){var BJ=BD[BK];if(BJ instanceof AF){BL(BJ)}else{if(BJ instanceof Array){BJ.push(BL)}else{BD[BK]=[BL];var BI=new Image();Ax(BI,"load",function(){var BN=new AF(BI);var BO=BD[BK];BD[BK]=BN;for(var BM=0,BP=BO.length;BM<BP;BM++){BO[BM](BN)}Ap(BI)});BI.src=BK}}},makeInert:function(BI){BI.onmousedown=BI.ondragstart=BI.oncontextmenu=AW},mouseInside:function(BM,BL){var BI=A3(BM,BL),BK=BI.x,BJ=BI.y;return(0<=BK&&BK<=BL.offsetWidth&&0<=BJ&&BJ<=BL.offsetHeight)},opposite:function(BI){switch(BI){case"left":return"right";case"right":return"left";case"top":return"bottom";case"bottom":return"top"}},popFromTop:A9=function(BJ){var BI=BJ[A6];if(typeof (BI)==="number"||(BI instanceof Number)){BJ.style.zIndex=BI;BJ[A6]=undefined}},preLoad:function(BI){(new Image()).src=BI},pushToTop:function(BJ,BK){if(BF){A9(BF)}BF=BJ;var BI=BJ.style;BJ[A6]=BI.zIndex;BI.zIndex=isNaN(BK)?AT.ZIndices.TOP:BK},relMousePos:A3=function(BL,BJ){var BM=A7(BL),BI=BC(BJ),BK=A1(BJ);BM.x-=BI.x+BK.x;BM.y-=BI.y+BK.y;return BM},setOpacity:function(BM,BN){var BJ=BM.style;if(BM.filters){var BI=BJ.filter,BL=/alpha\([.]*\)/g,BK="alpha(opacity="+BN*100+")";BM.contentEditable="false";BI=BI.match(BL)?BI.replace(BL,BK):BK;BJ.filter=BI}else{BJ.opacity=BN}},stripScripts:BB=function(BK){var BJ=BK.childNodes;for(var BI=0,BL=BJ.length;BI<BL;BI++){BB(BJ[BI])}Ap(BK);if(BK.onselectstart){BK.onselectstart=null}}};var BG=function(BL,BJ,BO){if(BL[BJ]){return BL[BJ]}else{if(BL[BO]){return BL[BO]}else{var BI=A2?getComputedStyle(BL,null):BL.currentStyle;var BN=A2?BI.getPropertyValue(BO):BI[BO];if(BN){var BK=BN.substr(BN.search(/[^0-9]+/)),BM=parseInt(BN);if(BK!=="%"){return BM}else{if(BL.parentNode){return BG(BL.parentNode,BJ,BO)*BM/100}else{return 0}}}else{if(BL.parentNode){return BG(BL.parentNode,BJ,BO)}else{return 0}}}}};return BH}()})();(function(){var A1=AS.destroy;Telogis.Events=o=AT.Events=function(){var A6=AT.DOM.absMousePos,A5,A4="__eventID",A2=[],A3=function(A9,A8,BG,BA){var BC,BB,BH,BF=typeof (A9);if(BF==="number"||(A9 instanceof Number)){BH=A2[A9];if(BH){var BE=BH[0];if(BE){A9=BE.elem}}}else{if(BF==="function"){for(BC=A2.length-1;BC>=0;BC--){BB=A3(BC,A9,BA);if(!isNaN(BB)){return BB}}}else{if(BF==="object"&&A9){var BD=typeof (A8);BG=(BD==="function"?A8:BG);A8=(BD==="string"||(A8 instanceof String)?A8:undefined);BB=A9[A4];BH=A2[BB];if(BH){for(BC=BH.length-1;BC>=0;BC--){var A7=BH[BC];if(A8&&A8!==A7.name){continue}if(BG&&BG!==A7.callback){continue}if(BA(BH,BC)){return BB}}}}}}};return{add:Ax=function(BA,A8,BC){if(BA&&(typeof (BA)==="string"||(BA instanceof String))){BA=document.getElementById(BA)}if(!BA){return }var A7="on"+A8;if(BA.addEventListener){BA.addEventListener(A8,BC,false)}else{if(BA.attachEvent){BA.attachEvent(A7,BC)}else{BA[A7]=BC}}var BB=BA[A4];if(isNaN(BB)){BB=BA[A4]=A2.length}var A9=A2[BB];if(!A9){A9=A2[BB]=[]}A9.push({elem:BA,name:A8,callback:BC})},addFocal:function(A9,A7,A8,BB){var BA=false;Ax(A9,"mouseover",function(){BA=true});Ax(A9,"mouseout",function(){BA=false});Ax(A8,A7,function(BC){if(BA){return BB(BC)}})},beginDrag:AB=function(A9,BC,BB){var BA=null,A8=function(BD){if(BA){var BE=A6(BD);BC.call(A9,BE.subtract(BA),BD)}BA=A6(BD);return AW(BD)},A7=function(BD){if(BB){BB.call(A9)}Ap(document,"mouseup",A7);Ap(document,"mousemove",A8)};Ax(document,"mousemove",A8);Ax(document,"mouseup",A7)},flush:function(){if(!A2){return }for(var A9=A2.length-1;A9>=0;A9--){var A8=A2[A9];if(A8){var A7=A8[0];if(A7){var BA=A7.elem;if(BA&&BA[A4]){Ap(BA)}}}}},maskUI:Ar=function(A9){var A7=["click","contextmenu","dblclick","mousedown","mouseup"];for(var A8=0,BA=A7.length;A8<BA;A8++){Ax(A9,A7[A8],A5)}},nothing:AW=function(A7){if(A7){if(A7.preventDefault){A7.preventDefault()}A7.returnValue=false}return false},onMouseOut:function(BG,BH){if(!(BG instanceof Array)){BG=[BG]}var BF=[],BA=[],BC=function(){for(var BI=0,BL=BG.length;BI<BL;BI++){var BK=BG[BI],BJ=BA[BI];Ap(BK,"mouseout",BJ.out);Ap(BK,"mouseover",BJ.over)}BH()},A7=function(){setTimeout(function(){var BI=false;for(var BJ=0,BK=BF.length;BJ<BK;BJ++){if(BF[BJ]){BI=true;break}}if(!BI){BC()}},50)};for(var BD=0,A8=BG.length;BD<A8;BD++){var A9=BG[BD],BE=function(BI){return function(){BF[BI]=true}}(BD),BB=function(BI){return function(){BF[BI]=false;A7()}}(BD);BF[BD]=(BD===0);BA[BD]={over:BE,out:BB};Ax(A9,"mouseover",BE);Ax(A9,"mouseout",BB)}},registered:function(A9,A8,BA){var A7=false;A3(A9,A8,BA,function(){A7=true;return true});return A7},remove:Ap=function(A8,A7,BA){var A9=A3(A8,A7,BA,function(BD,BC){var BF=BD[BC],BG=BF.callback,BE=BF.elem,BB=BF.name;if(BE.removeEventListener){BE.removeEventListener(BB,BG,false)}else{if(BB.substring(0,2)!=="on"){BB="on"+BB}if(BE.detachEvent){BE.detachEvent(BB,BG)}else{if(BE[BB]){BE[BB]=null}}}BD.splice(BC,1)});if(!isNaN(A9)&&A2[A9].length===0){A2[A9]=undefined}},terminate:A5=function(A7){if(A7.stopPropagation){A7.stopPropagation()}else{A7.cancelBubble=true}}}}();Ax(window,"unload",function(){A1()})})();(function(){AT.HTTPClient=function(){var A4=E.writeLine,A9=[],A7=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0","Msxml2.XMLHTTP","Microsoft.XMLHTTP"],A1=function(){var BE=null;if(typeof (XMLHttpRequest)!=="undefined"){BE=new XMLHttpRequest()}else{if(typeof (ActiveXObject)!=="undefined"){var BA=0,BD=A7.length;while(!BE&&BA<BD){try{var BB=A7[BA];BE=new ActiveXObject(BB);if(BE){A7=[BB]}}catch(BC){}BA++}}}if(!BE){throw new At("could not find an XHR constructor")}return BE},A2=function(){if(A9.length>0){return A9.pop()}else{return A1()}},A8=function(BA){BA.onreadystatechange=function(){};A9.push(BA)},A3=function(BA){var BC=BA.status,BB=(200<=BC)&&(BC<300);return(!BC||BB||(BC===304))},A5=function(BE,BC,BA){var BB=this;A4("opening an HTTP "+BE+" request for "+BC+"...");var BD=A2();BD.onreadystatechange=function(){if(BD.readyState===4){A4("response received from "+BC+".");var BF=BD.status,BG=BD.responseText;if(A3(BD)){BB.Load.trigger(BF,BG,BD.responseXML)}else{BB.Error.trigger(BF,BG)}A8(BD)}};BD.open(BE,BC,true);BD.send(BA)},A6=g({init:function(){this.Load=new C();this.Error=new C()},Error:null,Load:null,get:function(BA){A5.call(this,"GET",BA,null)},post:function(BB,BA){A5.call(this,"POST",BB,BA)}});return A6}()})();(function(){AT.JSON=function(){var A7="_class";var A3="__json";var A4=A3+"RRefs";var A9=A3+"Visited";var BA;var A2;var A8=function(BI,BH,BK,BJ){if(BI instanceof AJ){BK=AJ.SERIAL_DP}var BF=BH.objects;var BG=BH.strings;var BC=typeof (BI);var BM="";var BE=-1;if(BC==="undefined"||BI===null){return"null"}else{if(BC==="number"||(BI instanceof Number)){BM+=(BK>=0?BI.toFixed(BK):BI)}else{if(BC==="boolean"||(BI instanceof Boolean)){BM+=BI}else{if(BC==="string"||(BI instanceof String)){BE=BG[BI];if(typeof (BE)!=="undefined"){BM+="{_ref:"+BE+"}"}else{BG[BI]=BE=BH.nextID++;BM+="_["+BE+']="'+BI+'"'}}else{if(BC==="object"){for(var BL=0,BD=BF.length;BL<BD;BL++){if(BF[BL]===BI){BE=BL}}if(BE!==-1){BM+="{_ref:"+BE+"}"}else{BE=BH.nextID++;BF[BE]=BI;if(BI instanceof Array){BM+=BA(BI,BH,BK,BJ)}else{BM+=A2(BI,BH,BK,BJ)}BM="_["+BE+"]="+BM}}}}}}return BM};BA=function(BI,BE,BH,BG){var BC="";var BL="[";for(var BF=0,BD=BI.length;BF<BD;BF++){var BK=BI[BF];if(typeof (BK)!=="function"){if(BK&&!Aq.isSerializable(BK.constructor)){continue}var BJ=(BG||"")+"["+BF+"]";BL+=BC+A8(BK,BE,BH,BJ);BC=","}}BL+="]";return BL};A2=function(BG,BE,BI,BH){var BJ=BG.constructor;var BF=Aq.getDNClassDesc(BJ);if(!BF){throw new h("The object "+AG(BG)+' ("'+BH+'") is of unregistered class and cannot be serialized.')}BG[A7]=BF;var BM="{";var BD="";for(var BL in BG){var BC=BG[BL];if(typeof (BC)!=="function"){if(!Aq.isSerializable(BJ,BL)){continue}if(BC&&!Aq.isSerializable(BC.constructor)){continue}BM+=BD;BL=Aq.getDNPropName(BJ,BL);if(/^[a-zA-Z_\$][a-zA-Z0-9_\$]*$/.test(BL)){BM+=BL}else{BM+='"'+BL+'"'}var BK=BH?BH+"."+BL:BL;BM+=":"+A8(BC,BE,BI,BK);BD=","}}BM+="}";delete BG[A7];return BM};var A5=function(BE,BC){for(var BF=0,BD=BC.nextID;BF<BD;BF++){if(BE.search("{_ref:"+BF+"}")<0){BE=BE.replace("_["+BF+"]=","")}}return BE};var BB=function(BG){if(typeof (BG)!=="object"||!BG||BG[A9]){return BG}if(!BG[A7]&&!(BG instanceof Array)){return BG}var BN;var BI;var BL=BG[A7]?Aq.getJSClass(BG[A7]):null;var BJ=BL?Aq.getInstantiator(BL):null;var BE=function(BO){return BG.hasOwnProperty(BO)&&BO!==A7&&BO.indexOf(A3)!==0};if(BL){var BD={};for(BN in BG){if(BE(BN)||BN===A4){BD[Aq.getJSPropName(BL,BN)]=BG[BN]}}BG=BD;if(Aq.isConfigured(BL)){BI=new BL({})}else{if(BJ){BI=new BL()}else{BI=new BL(BG)}}}else{if(BG instanceof Array){BI=BG}else{BI={}}}BI[A9]=true;var BM=BG[A4];if(BM){for(var BF=0,BC=BM.length;BF<BC;BF++){var BH=BM[BF];BH[0][BH[1]]=BI}}var BK=BJ?BG:BI;for(BN in BG){if(BE(BN)){BK[BN]=BB(BG[BN])}}if(BJ){BJ.call(BI,BG)}return BI};var A6=function(BE,BD){var BH=[BE];while(BH.length>0){var BJ=BH.pop();if(typeof (BJ)==="object"){for(var BK in BJ){if(BJ.hasOwnProperty(BK)&&BK!==A4){var BC=BJ[BK],BF=typeof (BC);if(BC!==null&&(BF==="object"||BF==="string")){if(typeof (BC._ref)!=="undefined"){var BG=BD[BC._ref],BI=BG[A4];if(!BI){BI=BG[A4]=[]}BI.push([BJ,BK]);BJ[BK]=BG}else{BH.push(BC)}}}}}}};var A1=function(BF){var BC=(BF instanceof Array);if(typeof (BF)==="object"&&BF&&(BF[A9]||BC)){delete BF[A4];delete BF[A9];if(BC){for(var BE=0,BG=BF.length;BE<BG;BE++){A1(BF[BE])}}else{for(var BD in BF){if(BF.hasOwnProperty(BD)){A1(BF[BD])}}}}};return{CLASS_TAG:A7,deserialize:function(BD){if(BD){window["_"]={};var BC=window["eval"]("("+BD+")");A6(BC,window["_"]);BC=BB(BC);A1(BC);return BC}},serialize:function(BE){var BC={nextID:1,strings:{},objects:[]};var BD=A8(BE,BC,-1,"");return A5(BD,BC)}}}()})();(function(){k=AT.RTreeRect=AU({init:function(A6,A1){if(A6 instanceof k){this._minLat=A6._minLat;this._minLon=A6._minLon;this._maxLat=A6._maxLat;this._maxLon=A6._maxLon}else{if(!A1){A1=A6}var A3=A6.lon,A2=A1.lon,A5=A6.lat,A4=A1.lat;this._minLat=AD(A5,A4);this._minLon=AD(A3,A2);this._maxLat=Ac(A5,A4);this._maxLon=Ac(A3,A2)}},_minLat:0,_minLon:0,_maxLat:0,_maxLon:0,area:function(){return(this._maxLat-this._minLat)*(this._maxLon-this._minLon)},contains:function(A1){return this._minLat<=A1._maxLat&&this._maxLat>=A1._minLat&&this._minLon<=A1._maxLon&&this._maxLon>=A1._minLon},intersects:function(A1){return this._minLat<=A1._maxLat&&this._maxLat>=A1._minLat&&this._minLon<=A1._maxLon&&this._maxLon>=A1._minLon},union:function(A2){var A1=new k(this);A1._minLat=AD(A1._minLat,A2._minLat);A1._minLon=AD(A1._minLon,A2._minLon);A1._maxLat=Ac(A1._maxLat,A2._maxLat);A1._maxLon=Ac(A1._maxLon,A2._maxLon);return A1}});Ai=AT.RTreeNode=function(){var A3=10;var A7=function(A8){var BA=this._rect,A9=this._parent;if(BA){this._rect=BA.union(A8)}else{this._rect=new k(A8)}if(A9){A7.call(A9,A8)}};var A6=function(){var BA=this._children,A8=BA.length,BB=null;if(A8){BB=BA[0]._rect;for(var A9=1;A9<A8;A9++){BB=BB.union(BA[A9]._rect)}}return BB};var A2=function(){var A9=this._children,BD=A9.length,BB=-Infinity,BH=[-1,-1];for(var BE=0,BA=BD-1;BE<BA;BE++){for(var BC=BE+1;BC<BD;BC++){var BF=A9[BE]._rect,A8=A9[BC]._rect,BG=BF.union(A8).area()-BF.area()-A8.area();if(BG>BB){BH[0]=BE;BH[1]=BC;BB=BG}}}return BH};var A1=function(BD){var BA=this._children,BC=Infinity,BH=null;for(var BE=0,BB=BA.length;BE<BB;BE++){var A9=BA[BE],BG=A9._rect,BI=BG.area(),A8=BG.union(BD).area()-BI,BF;if(A8<=BC){if(A8<BC||BI<BF){BH=A9;BF=BH._rect.area()}BC=A8}}return BH};var A5=function(){this._rect=A6.call(this);var A8=this._parent;if(A8){A5.call(A8)}};var A4=AU({init:function(A8){this._tree=A8;this._children=[]},data:null,_isLeaf:true,_children:null,_tree:null,_parent:null,_rect:null,addChild:function(BD){var BA=this._children,A8=BA.length,A9=BD._rect;if(A8<A3){BA.push(BD);if(!this._isLeaf){BD._parent=this}A7.call(this,A9)}else{this.split();var BB=this._parent,BC;if(this._isLeaf){BC=BB.findTarget(A9)}else{BC=A1.call(BB,A9)}BC.addChild(BD)}},findTarget:function(A8){if(this._isLeaf){return this}else{return A1.call(this,A8).findTarget(A8)}},query:function(BA,BC){var A9=this._children;for(var A8=0;A8<A9.length;A8++){var BB=A9[A8];if(BB._rect.intersects(BA)){if(this._isLeaf){BC(BB.data,BB)}else{BB.query(BA,BC)}}}},queryAll:function(BB){var A9=this._children;for(var A8=A9.length-1;A8>=0;A8--){var BA=A9[A8];if(this._isLeaf){BB(BA.data,BA)}else{BA.queryAll(BB)}}},remove:function(BB,BD){var A9=this._children,BA=this._parent;for(var A8=0,BF=A9.length;A8<BF;A8++){var BE=A9[A8],BC=BE.data;if(BC&&BC===BB.data){A9.splice(A8,1);if(A9.length===0&&BA){BA.remove(this,true)}else{A5.call(this)}return true}else{if(!this._isLeaf&&!BD&&BE._rect.contains(BB._rect)){if(BE.remove(BB,false)){return true}}}}return false},split:function(){var BJ=this._parent,BO=this._tree;if(!BJ){BJ=new A4(BO);BO._root=BJ;BJ._isLeaf=false;BJ.addChild(this)}var BL=A2.call(this),BK=BL[0],A9=BL[1],BH=this._children,BG=new A4(BO),BN=this._children=[],BB=BG._children;this._rect=null;BG._isLeaf=this._isLeaf;this.addChild(BH[BK]);BH[BK]=null;BG.addChild(BH[A9]);BH[A9]=null;for(var BE=0,BA=BH.length;BE<BA;BE++){var A8=BH[BE];if(!A8){continue}var BF=A8._rect,BM=this._rect,BD=BG._rect,BC=BM.union(BF).area()-BM.area(),BI=BD.union(BF).area()-BD.area();if(BC<BI){this.addChild(A8)}else{if(BI<BC){BG.addChild(A8)}else{if(BN.length<BB.length){this.addChild(A8)}else{BG.addChild(A8)}}}}BJ.addChild(BG)}});return A4}();S=AT.RTree=AU({init:function(){this._root=new Ai(this)},_root:null,insert:function(A3,A4){var A2=new Ai(this),A1=new k(A4);A2.data=A3;A2._rect=A1;this._root.findTarget(A1).addChild(A2)},query:function(A1,A2){this._root.query(A1,A2)},queryAll:function(A1){this._root.queryAll(A1)},remove:function(A2,A4){var A1=this._root;if(A2 instanceof Ai){return A1.remove(A2,false)}else{var A3=false;A1.query(new k(A4),function(A6,A5){if(A6===A2){A1.remove(A5,false);A3=true}});return A3}}})})();(function(){P=AS.GeoStream=function(){var A5=AT.JSON,BF=AT.USE_IE,BG=A5.deserialize,BL=AT.getServiceURL,BC=A5.serialize,A4=E.writeLine,BI,A7,BM,A2,BB,A6,A1,BE="AuthenticationRequiredException",A3="GeoStream.",BA=2083,BJ=5000,A8=[],BK=[],A9=0,BH=false,BD=function(BQ){var BP=[[/%7b/gi,"{"],[/%7d/gi,"}"],[/%5b/gi,"["],[/%5d/gi,"]"],[/%3a/gi,":"],[/%3d/gi,"="],[/%2c/gi,","],[/%22/g,'"'],[/%20/g,"+"]];BQ=encodeURIComponent(BQ);for(var BO=0,BR=BP.length;BO<BR;BO++){var BN=BP[BO];BQ=BQ.replace(BN[0],BN[1])}return BQ};return{DATAQUERY_PAGE:"dataquery.ashx",GEOCODER_PAGE:"geocoder.ashx",GEOFENCE_PAGE:"geofence.ashx",ROUTING_PAGE:"route.ashx",SETTINGS_PAGE:"settings.ashx",TRAFFIC_PAGE:"traffic.ashx",REGISTER_PAGE:BM="register.aspx",REQUEST_TIMEOUT:BI=60000,callback:function(BO){var BN=A8[BO];if(BN){if(!BH){A4("received GeoStream '"+BN.method+"' invocation #"+BO+".")}AI(A8,BO);return function(BS){var BP=BG(BS);if(BP.failed()){var BU=BP.getError(),BT=(BU.getInnerException()||BU).getType(),BR;if(BT===BE){BR=new s("authentication failed for request #"+BO+".")}else{BR=new V("a "+BT+" was thrown by the GeoStream server: "+BU)}var BQ=BN.errorCallback;if(BQ){BQ(BR)}}else{BN.callback(BP.getResult())}}}else{return function(){}}},destroy:function(){A(this)},invoke:function(BU,BN,BR,BW,BT,BV){var BP=A9++,BS=new A7(BN,(BR instanceof Array)?BR:[BR]),BX=BD(BC(BS));A8[BP]={callback:BW,errorCallback:BT,method:BN,json:BX,timeout:BV,type:BU};if(!BH){A4("invoking GeoStream function '"+BN+"' #"+BP+" from '"+BU+"'...")}var BO=BL()+BU,BQ=BO+"?c=Telogis.GeoBase.GeoStream.callback("+BP+")&p="+BX;if(BQ.length>BA){throw new At("maximum URL length exceeded for request #"+BP+".")}else{A1(function(){BB(BQ,null,function(BY){AI(A8,BP);if(BT){BT(new d("request #"+BP+" timed out ("+BY+"ms)."))}},BV)})}},JSONRequest:function(){var BN=0;A7=g({init:function(BP,BO){this._id=BN++;this._method=BP;this._params=BO.slice();if(W.length){this._dataSets=W}},_id:0,_method:"",_clientVersion:window["GB_VERSION"],_params:null});j(A7,A3+"JSONRequest");Aw(A7,[["_dataSets","datasets"],["_id","id"],["_method","method"],["_clientVersion","clientVersion"],["_params","params"]]);return A7}(),JSONResponse:function(){var BN=g({_error:null,_result:null,failed:function(){return !!this._error},getError:function(){return this._error},getResult:function(){return this._result}});j(BN,A3+"JSONResponse");Aw(BN,[["_error","error"],["_id","id"],["_result","result"]]);return BN}(),register:function(BQ){var BT=AT.serviceURLs,BS=BT.length,BO=0,BU=function(BV){return function(){Ap(BV);BO++;if(BO>=BS){for(var BW=0;BW<BK.length;BW++){BK[BW]()}BK=null}}};for(var BP=0;BP<BS;BP++){var BR=BT[BP]+BM+"?a="+BQ,BN=new Image();Ax(BN,"load",BU(BN));BN.src=BR}},runScript:BB=function(BV,BU,BS,BQ){if(!BV){return }var BR=document.getElementsByTagName("head")[0],BW=BR.appendChild(document.createElement("script")),BN=0,BO=function(){BW.onload=BW.onreadystatechange=null;if(BN){clearTimeout(BN)}setTimeout(function(){BR.removeChild(BW);if(!BH){var BX=BV.search(/i=/);if(BX>=0){var BZ=BV.substring(BX+2);var BY=BZ.indexOf("&");if(BY>=0){BZ=BZ.substring(0,BY)}A4("cleaned up request #"+BZ+".")}}},BJ)},BP=function(){if(BU){BU()}BO()},BT=function(){if(BS){BS(BQ)}BO()};if(BF){BW.onreadystatechange=function(){var BX=this.readyState;if(BX==="loaded"){BP()}}}else{BW.onload=BP}if(BS){if(isNaN(BQ)){BQ=BI}BN=setTimeout(BT,BQ)}BW.setAttribute("type","text/javascript");BW.setAttribute("src",BV)},ServerExceptionInfo:function(){A2=g({getInnerException:function(){return this._innerException},getType:function(){return this._type},toString:function(){return this._message}});j(A2,"Internal.ServerExceptionInfo");Aw(A2,[["_innerException","InnerException"],["_message","Message"],["_source","Source"],["_stackTrace","RemoteStackTrace"],["_type","OriginalExceptionType"]]);return A2}(),setVerbosity:A6=function(BN){BH=!!BN},silence:function(){A6(false)},unsilence:function(){A6(true)},whenRegistered:A1=function(BN){if(BK){BK.push(BN)}else{BN()}}}}()})();(function(){AC=AS.XMLDoc=function(){var A1=AT.USE_ACTIVEX,BC=1,A8=3,A4=4,BG=8,A6=9,A9="MSXML2.",BH=!A1?"":function(){var BN=null,BJ=[".6.0",".5.0",".4.0",".3.0"],BI=BJ.length,BK=0;while(!BN&&BK<BI){try{var BM=BJ[BK];BN=new ActiveXObject(A9+"DOMDocument"+BM);if(BN){return BM}}catch(BL){}BK++}return""}(),A3=A9+"DOMDocument"+BH,BE=A9+"FreeThreadedDOMDocument"+BH,BB=A9+"XSLTemplate"+BH,A2=function(BI){var BJ=null;if(typeof (ActiveXObject)!=="undefined"){BJ=new ActiveXObject(BE);BJ.async=true;BJ.resolveExternals=true;BJ.loadXML(BI.xml)}return BJ},BA=function(BJ,BL){var BI=null;if(typeof (ActiveXObject)!=="undefined"){var BK=new ActiveXObject(BB);BK.stylesheet=A2(BJ);BI=BK.createProcessor();BI.input=BL}return BI},A5=function(BK){var BJ=BK.childNodes;for(var BI=0,BN=BJ.length;BI<BN;BI++){var BM=BJ[BI];if(BM.tagName==="parsererror"){return BM}else{var BL=A5(BM);if(BL){return BL}}}return null},BD=function(BM,BL,BI){if(typeof (BI)==="undefined"){BI=true}var BN=null;if(typeof (BM.importNode)!=="undefined"){BN=BM.importNode(BL,BI)}else{switch(BL.nodeType){case BC:var BK,BO;BN=BM.createElement(BL.nodeName);for(BK=0,BO=BL.attributes.length;BK<BO;BK++){var BJ=BL.attributes[BK].nodeName;BN.setAttribute(BJ,BL.getAttribute(BJ))}if(BI){for(BK=0,BO=BL.childNodes.length;BK<BO;BK++){BN.appendChild(BD(BM,BL.childNodes[BK],BI))}}break;case A8:case A4:case BG:BN=BM.createTextNode(BL.nodeValue);break}}return BN},BF=function(BO){var BN=this.doc(),BI=[],BJ;if(typeof (XPathEvaluator)!=="undefined"){var BL=new XPathEvaluator();BJ=BL.evaluate(BO,BN,null,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null);if(BJ){var BM=BJ.iterateNext();while(BM){BI.push(BM);BM=BJ.iterateNext()}}}else{if(typeof (BN.selectNodes)!=="undefined"){BJ=BN.selectNodes(BO);for(var BK=0,BP=BJ.length;BK<BP;BK++){BI[BK]=BJ[BK]}}}return BI},A7=function(BM){var BL=this.doc(),BK=null;if(typeof (XPathEvaluator)!=="undefined"){var BJ=new XPathEvaluator(),BI=BJ.evaluate(BM,BL,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null);BK=BI.singleNodeValue}else{if(typeof (BL.selectSingleNode)!=="undefined"){BK=BL.selectSingleNode(BM)}}return BK};return g({init:function(BK){var BI=null,BJ=null;if(BK!==null){var BL=typeof (BK);if(BL==="string"||BK instanceof String){BJ=BK;BI=null}else{if(BL==="object"){if(BK instanceof AC){BJ=BK._text;BI=BK._doc}else{if(BK.namespaces){BJ=null;BI=BK}else{if(BK.xmlVersion){BJ=null;BI=BK}else{if(BK.xml){BJ=BK.xml;BI=null}else{if(N(BK)){BJ=null;BI=BK}}}}}}}}if(BI&&BI.ownerDocument===null&&typeof (BI.setProperty)!=="undefined"){BI.setProperty("SelectionLanguage","XPath")}this._text=BJ;this._doc=BI},appendChild:function(BL){var BK=new AC(BL).root();if(BK){var BI=this.root(),BJ=BI.ownerDocument;BI.appendChild(BD(BJ,BK));this._text=null}return this},doc:function(){if(!this._doc&&this._text){var BI;if(typeof (DOMParser)!=="undefined"){var BL=new DOMParser();this._doc=BL.parseFromString(this._text,"text/xml");BI=A5(this._doc);if(BI){var BJ=BI.textContent;this._doc=null;throw new Az(BJ)}}else{if(typeof (ActiveXObject)!=="undefined"){var BK=new ActiveXObject(A3);BK.async=false;BK.loadXML(this._text);this._doc=BK;if(this._doc.parseError){if(this._doc.parseError.errorCode!==0){BI=this._doc.parseError;this._doc=null;throw new Az("XML parsing error @"+BI.line+":"+BI.linepos+" -- "+BI.reason+"\r\n"+BI.srcText)}}}}}return this._doc},getAttribute:function(BI){return this.root().getAttribute(BI)},getTagName:function(){return this.root().tagName},parentNode:function(){return this.doc().parentNode},selectNodes:function(BL){var BJ=[],BI=BF.call(this,BL);for(var BK=0,BM=BI.length;BK<BM;BK++){BJ[BK]=new AC(BI[BK])}return BJ},selectSingleNode:function(BJ){var BK=A7.call(this,BJ),BI=new AC(BK);return BI.doc()?BI:null},setAttribute:function(BI,BJ){this.root().setAttribute(BI,BJ);this._text=null;return this},removeNode:function(BI){var BJ=A7.call(this,BI);if(BJ){BJ.parentNode.removeChild(BJ);return new AC(BJ)}else{return null}},replaceNode:function(BM,BK){var BL=A7.call(this,BM);if(BL){var BJ=BK.root(),BI=BL.ownerDocument;BL.parentNode.appendChild(BD(BI,BJ));BL.parentNode.removeChild(BL);return BK}else{return null}},root:function(){var BI=this.doc();if(BI&&BI.nodeType===A6){return BI.firstChild}else{return BI}},text:function(){var BL=this._doc;if(!this._text&&BL){if(typeof (XMLSerializer)!=="undefined"){var BK=new XMLSerializer();this._text=BK.serializeToString(BL)}else{var BJ=BL.nodeTypeString;if(typeof (BJ)==="string"||(BJ instanceof String)){if(BJ==="attribute"||BJ==="element"){this._text=BL.text}else{this._text=BL.xml}}else{var BI=this.root(),BM=document.createElement("div");BM.appendChild(BD(document,BI));this._text=BM.innerHTML}}}return this._text},transformXSL:function(BM,BN){var BQ,BO;var BS="";if(typeof (XSLTProcessor)!=="undefined"){BM=new AC(BM).doc();BO=new XSLTProcessor();BO.importStylesheet(BM);if(BN){for(BQ in BN){if(BN.hasOwnProperty(BQ)){BO.setParameter(null,BQ,BN[BQ])}}}var BP=BO.transformToDocument(this.doc());var BR=BP.firstChild;if(BR){if(BR.tagName==="transformiix:result"){BS=BR.textContent}else{var BK=BP.getElementsByTagName("html");if(BK&&BK[0]){var BI=BK[0].getElementsByTagName("body");if(BI&&BI[0]){var BL=BI[0].getElementsByTagName("pre");if(BL&&BL[0]){BS=BL[0].textContent}}}}}}else{if(typeof (ActiveXObject)!=="undefined"){BM=new AC(BM);if(!BN){return new AC(this.doc().transformNode(BM.doc()))}else{BO=BA(BM.doc(),this.doc());for(BQ in BN){if(BN.hasOwnProperty(BQ)){var BJ=BN[BQ];if(typeof (BJ)!=="function"){BO.addParameter(BQ,BJ)}}}BO.transform();BS=BO.output}}}return BS}},{encodeXML:function(BJ){var BI=BJ;BI=BI.replace("&","&amp;");BI=BI.replace("<","&lt;");BI=BI.replace(">","&gt;");BI=BI.replace('"',"&quot;");BI=BI.replace("'","&#39;");return BI}})}()})();(function(){AS.GeoCoder=function(){var A1=P.GEOCODER_PAGE,A2=P.invoke,A4=function(){var A5=g({_components:null,_confidence:0,_confidenceScores:null,_country:"",_matchType:"",_maxNumber:-1,_minNumber:-1,_number:-1,getCity:function(){return this.getComponent(1)},getComponent:function(A6){var A8=this._components;if(A8 instanceof Array){var A7=A8[A6];if(typeof (A7)!=="undefined"){return""+A7}}},getConfidence:function(){return this._confidence},getConfidenceScores:function(){return this._confidenceScores},getCountry:function(){return this._country},getLocation:function(){return new AJ(this._loc)},getMatchType:function(){return this._matchType},getMaxNumber:function(){return +this._maxNumber},getMinNumber:function(){return +this._minNumber},getNumber:function(){return +this._number},getPostalCode:function(){return this.getComponent(3)},getRegion:function(){return this.getComponent(2)},getStreet:function(){return this.getComponent(0)},toString:function(){var A7=this._components,A6=this.getNumber(),A8="";if(A6>0){A8+=A6+" "}if(A7 instanceof Array){A8+=this._components.join(", ").replace(/^[, ]+/,"")}return A8}});j(A5,"GeocodeAddress");Aw(A5,[["_components","m_values"],["_confidence","Confidence"],["_confidenceScores","m_confidenceScores"],["_country","Country"],["_loc","Location"],["_matchType","MatchType"],["_maxNumber","MaxNumber"],["_minNumber","MinNumber"],["_number","Number"]]);return A5}(),A3=function(){var A5=g({_city:"",_country:"",_number:-1,_postalCode:"",_region:"",_regions:null,_streetNames:null,getCity:function(){var A6=this._city;if(!A6){var A7=this._regions;if(A7){A6=A7[0]}}return A6||""},getCounty:function(){var A6=this._regions;if(A6){return A6[A6.length-2]||""}else{return""}},getCountry:function(){return this._country},getNumber:function(){return +this._number},getPostalCode:function(){return this._postalCode},getRegion:function(){var A6=this._region;if(!A6){var A7=this._regions;if(A7){A6=A7[A7.length-1]}}return A6||""},getStreet:function(){return this._streetNames[0]},toString:function(){var BG="";var BH="";var A7=this._country;var BD=this._streetNames;var BA=this._number;var A9=this._regions;var A6=this._postalCode;if(BA>0){BG+=BA+" "}if(BD.length>0&&BD[0].length>0){BG+=BD[0];BH=", "}if(!A9){var BB=this._city;var BF=this._region;if(BB&&BB.length>0){BG+=BH+BB;BH=", "}if(BF&&BF.length>0){BG+=BH+BF;BH=", "}}else{for(var BC=0,BE=A9.length;BC<BE;BC++){var A8=A9[BC];if(A8){BG+=BH+A8;BH=", "}}}if(A6&&A6.length>0){BG+=BH+A6;BH=", "}if(A7!=="TrinidadTobago"&&A7!=="Unknown"){BG+=BH+A7}return BG}});j(A5,"Address");Aw(A5,[["_city","city"],["_country","country"],["_streetNames","names"],["_number","number"],["_postalCode","postalcode"],["_region","region"],["_regions","regions"]]);return A5}();return{Address:A3,CanadaGeoCodeAddress:function(){var A5=H(A4,{getState:function(){return this.getComponent(2)}});j(A5,"CanadaGeocodeAddress");return A5}(),GeoCodeAddress:A4,GeoCodeFull:function(){var A5=g({_address:null,_crossStreet:null,_crossStreetFound:false,_heading:0,_intersection:null,getAddress:function(){return this._address},getCrossStreet:function(){return this._crossStreet},getIntersection:function(){return new AJ(this._intersection)},getStreetLink:function(){return this._streetLink},toString:function(){return this._address+" (closest to intersection "+this._intersection+" on "+this._streetLink+")"}});j(A5,"GeoCodeFull");Aw(A5,[["_address","Address"],["_heading","heading"],["_crossStreet","crossStreet"],["_crossStreetFound","crossStreetFound"],["_intersection","Intersection"],["_streetLink","StreetLink"]]);return A5}(),HMMGeoCodeAddress:function(){var A5=H(A4);j(A5,"Internal.HMMGeocodeAddress");return A5}(),USGeoCodeAddress:function(){var A5=H(A4,{getState:function(){return this.getComponent(2)},getZIPCode:function(){return this.getComponent(3)}});j(A5,"USGeocodeAddress");return A5}(),geoCode:function(A5,A7,A8,A6){A2(A1,"GeoCode",[A5,A7],A8,A6)},geoCodeExtended:function(A5,BA,A8,A7,A9,BB,A6){A2(A1,"GeoCodeExtended",[A5,BA,A8,A7,A9],BB,A6)},reverseGeoCode:function(A6,A7,A5){A2(A1,"ReverseGeoCode",A6,A7,A5)},reverseGeoCodeFull:function(A6,A7,A5){A2(A1,"ReverseGeoCodeFull",A6,A7,A5)}}}()})();(function(){K=AS.Transitions=function(){return{log:function(A1){return t(A1,0.8)},sine:function(A1){return(Aj(An*(1-A1))+1)/2},TimeLine:g({init:function(){this.running=false;this.interval=1000/30;this.transitions=[];this.pending=[]},append:function(A3){var A1=this;var A2=new Date().getTime();if(A3.start+A3.duration<A2){return }if(A3.start>A2){this.pending.push(A3)}else{this.transitions.push(A3)}if(!this.running){this.running=true;this.tick.id=setInterval(function(){A1.tick()},this.interval)}return A3},replace:function(A3){var A1=this;var A2=new Date().getTime();if(A3.start+A3.duration<A2){return }if(A3.start>A2){this.pending=[A3];this.transitions=[]}else{this.transitions=[A3];this.pending=[]}if(!this.running){this.running=true;this.tick.id=setInterval(function(){A1.tick()},this.interval)}return A3},tick:function(){if(!this.running){clearInterval(this.tick.id);return }var A3=[];var A5=[];var A8=this.pending.length;var A4=this.transitions.length;var A6=new Date().getTime();var A7;var A2,A1;for(A2=0;A2<A4;A2++){A7=this.transitions[A2];if(!A7){continue}if(A7.start+A7.duration<=A6){A7.tick(1)}else{A1=(A6-A7.start)/A7.duration;A7.tick(A1);A5.push(A7)}}this.transitions=A5;for(A2=0;A2<A8;A2++){A7=this.pending[A2];if(!A7){continue}if(A7.start<A6){A1=(A6-A7.start)/A7.duration;A7.tick(A1);this.transitions.push(A7)}else{A3.push(A7)}}this.pending=A3;if(this.transitions.length===0&&this.pending.length===0){this.running=false;clearInterval(this.tick.id)}}}),Transition:g({init:function(A2,A3,A1){this.start=new Date().getTime();this.duration=A2;this.tick=A3;this.modifier=A1},tick:function(A1){if(this.modifier){A1=this.modifier(A1)}this.tick(A1)}})}}()})();(function(){D=AS.MathUtil=function(){var A2=180/An;var A3=An/180;var A7;var A1;var A6=function(A8){return X(Ac(-1,AD(A8,1)))};var A4=function(A9,A8){if(A8===I.RADIANS){return A9}var BA=A9*180*60/An;switch(A8){case I.KNOTS:return BA;case I.FEET:return BA*6076.11549;case I.YARDS:return BA*2025.37183;case I.MILES:return BA*1.15077945;case I.METERS:return BA*1852;case I.KILOMETERS:return BA*1.852}};var A5=function(A9,A8){var BA=0;switch(A8){case I.RADIANS:return A9;case I.KNOTS:BA=A9;break;case I.FEET:BA=A9/6076.11549;break;case I.YARDS:BA=A9/2025.37183;break;case I.MILES:BA=A9/1.15077945;break;case I.METERS:BA=A9/1852;break;case I.KILOMETERS:BA=A9/1.852;break}return BA/(180*60/An)};return{bearing:function(BE,BD){var BC=A3*BE.lat;var A9=A3*BE.lon;var BA=A3*BD.lat;var A8=A3*BD.lon;var BB=R(l(A8-A9)*Aj(BA),Aj(BC)*l(BA)-l(BC)*Aj(BA)*Aj(A8-A9));return(A2*BB+360)%360},bearingToCompass:function(A8){var A9=A0(A1(A8,360)/45)%8;return["N","NE","E","SE","S","SW","W","NW","N"][A9]},convertUnits:A7=function(BA,A8,A9){return A4(A5(BA,A8),A9)},displace:function(BF,BE,BH,BD){var BA=A3*BH;var BG=A5(BE,BD);var A9=A3*BF.lat;var BC=A3*BF.lon;var A8=A6(l(A9)*Aj(BG)+Aj(A9)*l(BG)*Aj(BA));var BB=BC+R(Aj(A9)*l(BG)*l(BA),Aj(BG)-l(A9)*l(A8));return new AJ(A2*A8,A2*BB)},distance:function(BF,BG,BD){var BA=A3*BF.lat;var BC=A3*BF.lon;var A9=A3*BG.lat;var BB=A3*BG.lon;var BH=l((A9-BA)/2);var A8=l((BB-BC)/2);var BE=BH*BH+Aj(BA)*Aj(A9)*A8*A8;var BI=2*R(e(BE),e(1-BE));return A7(BI,I.RADIANS,BD||I.MILES)},positiveModulo:A1=function(BA,A9){var A8=BA%A9;return A8<0?A8+B(A9):A8},toRadians:function(A8){return A3*A8},toDegrees:function(A8){return A2*A8}}}()})();(function(){Ay=AS.Routing=function(){var A9=I.MILES,A2=I.RADIANS,A3=P.ROUTING_PAGE,BT=D.convertUnits,BU=P.invoke,BZ="Routing.",Bg,A1,BA,Bb,A7,BX,BK,BR,BG,A5,BC,BI,BV,BB,BW,BJ,A8,Bc,BO,A6,BY,Be,BN,BE,Bf,BQ,A4,BF,BM,Bh,BS,BP=function(){var Bi,Bj=g({_event:null,getDistance:function(Bk){var Bl=this._event;return((Bl&&Bl.getDistance)?Bl.getDistance(Bk):0)},getHeading:function(){var Bk=this._event;return(Bk?Bk.getHeading():0)},getInstructions:Bi=function(){var Bk=this._event;return(Bk?Bk._englishDirections+". ":"")},toString:Bi,getLocation:function(){var Bk=this._event;return(Bk?Bk.getLocation():null)},getNotes:function(){var Bk=this._event;return(Bk?Bk.getNotes():[])},getPoints:function(){var Bk=this._event;return(Bk?Bk.getPoints():[])},getStreet:function(){var Bk=this._event;return(Bk?Bk.getTargetStreet():"")},getTime:function(){var Bk=this._event;return(Bk?Bk.getTime():0)},isArrival:function(){return(this._event instanceof BA)},isDeparture:function(){return(this._event instanceof A7)}});j(Bj,BZ+"Direction");Aw(Bj,[["_event","dir"]]);return Bj}(),Ba=function(){var Bi,Bj=g({_distance:0,_englishDirections:"",_heading:0,_lastStreet:"",_loc:null,_notes:null,_points:null,_renderPoints:null,_targetStreet:"",_time:0,getDistance:function(Bk){return BT(this._distance,A2,Bk||A9)},getEnglishDirections:Bi=function(){return this._englishDirections},toString:Bi,getHeading:function(){return this._heading},getLastStreet:function(){return this._lastStreet},getLocation:function(){return this._loc},getNotes:function(){var Bk=this._notes;if(!Bk){this._notes=Bk=[]}return Bk},getPoints:function(){return this._renderPoints||this._points},getTargetStreet:function(){return this._targetStreet},getTime:function(){return this._time}});j(Bj,BZ+"DrivingEvent");Aw(Bj,[["_distance","distance"],["_heading","heading"],["_lastStreet","last_street"],["_loc","location"],["_notes","notes"],["_points","points_cache"],["_renderPoints","renderPoints"],["_targetStreet","_t_street"],["_time","Time"]]);return Bj}(),BH=function(){var Bi=H(Ba,{_distance:0,_loc:null,getDistance:function(){return this._distance},getLocation:function(){return new AJ(this._loc)}});j(Bi,BZ+"DrivingNote");Aw(Bi,[["_loc","Loc"],["_distance","noteDistance"]]);return Bi}(),BL=function(){var Bi=H(Ba,{_type:0,getType:function(){return this._type}});j(Bi,BZ+"MovementEvent");Aw(Bi,[["_type","m_type"]]);return Bi}(),BD=function(){var Bi=H(BL,{_exitNumber:"",_isLeftExit:false,exitNumber:function(){return this._exitNumber},isLeftExit:function(){return this._isLeftExit}});j(Bi,BZ+"RampMovementEvent");Aw(Bi,[["_exitNumber","ExitNumber"],["_isLeftExit","LeftExit"]]);return Bi}(),Bd={ArriveEvent:A1=H(Ba),ArrivalMovementEvent:BA=H(BL),DepartEvent:Bb=H(Ba),DepartureMovementEvent:A7=H(BL),Direction:BP,Directions:function(){var Bi,Bj=g({getDirection:function(Bk){return this._directs[Bk]},getLength:function(){return this._directs.length},getInstructions:Bi=function(){var Bm="",Bl=this._directs;for(var Bk=0,Bn=Bl.length;Bk<Bn;Bk++){Bm+=Bl[Bk].getInstructions()}return Bm},toString:Bi,getPoints:function(){return this._points}});j(Bj,BZ+"Directions");Aw(Bj,[["_directs","directs"],["_points","points_cache"],["_totalDistance","totalDistance"],["_totalTime","totalTime"],["_violations","m_Violations"]]);return Bj}(),DrivingEvent:Ba,DrivingNote:BH,FFRampMovementEvent:BX=H(BD),FSRampMovementEvent:BK=H(BD),Movement:BJ=function(){var Bi=H(BP,{_stop:null,_type:"",getStop:function(){return this._stop},getType:function(){return this._type}});j(Bi,BZ+"Movement");Aw(Bi,[["_stop","stop"],["_type","type"]]);return Bi}(),ArrivalMovement:BN=H(BJ),TurnMovement:BE=H(BJ),FerryMovement:Bf=H(BJ),DepartureMovement:BQ=H(BJ),RoundAboutMovement:A4=H(BJ),SplitMovement:BF=H(BJ),FFRampMovement:BM=H(BJ),SFRampMovement:Bh=H(BJ),FSRampMovement:BS=H(BJ),MovementEvent:BL,NameChangeNoteEvent:BR=H(BH),Note:A8=function(){var Bi=H(BP,{_type:0,getType:function(){return this._type}});j(Bi,BZ+"Note");Aw(Bi,[["_type","noteType"]]);return Bi}(),FreewayEndsNote:Bc=H(A8),NameChangeNote:BO=H(A8),StateChangesNote:A6=H(A8),TollwayBeginsNote:BY=H(A8),TollwayEndsNote:Be=H(A8),RoadCrossingBehavior:{ALLOWED:Bg="Allowed",DISCOURAGED:"Discouraged",FORBIDDEN:"Forbidden"},Route:function(){var Bk=16,Bj=function(){var Bl=this._stops.length;if(this._start){Bl++}if(this._end){Bl++}if(Bl<2){throw new n("not enough stops in routing request")}if(Bl>Bk){throw new At("too many stops in routing request")}},Bi=g({init:function(Bl){if(!Bl){Bl={}}this._start=null;this._end=null;this._strategy=Bl.strategy||new BI();this._stops=[];this.appendStops(Bl.stops||[]);this.useTraffic({})},_end:null,_start:null,_stops:null,_strategy:null,_trafficSource:null,_time:null,useTraffic:function(Bl){this._trafficSource=Bl.source||null;var Bm=this._time=Bl.time||new Date();if(typeof (Bm)!=="string"&&!(Bm instanceof String)){var Bn=function(Bo){Bo=""+Bo;while(Bo.length<2){Bo="0"+Bo}return Bo};this._time=Bm.getFullYear()+"-"+Bn(Bm.getMonth()+1)+"-"+Bn(Bm.getDate())+"T"+Bn(Bm.getHours())+":"+Bn(Bm.getMinutes())+":"+Bn(Bm.getSeconds())}},appendStop:function(Bl){this._stops.push(new BG(Bl))},appendWaypoint:function(Bl){this._stops.push(new A5(Bl))},addStopAt:function(Bm,Bl){this._stops.splice(Bl,0,new BG(Bm))},addWaypointAt:function(Bm,Bl){this._stops.splice(Bl,0,new A5(Bm))},appendStops:function(Bm){for(var Bl=0;Bl<Bm.length;Bl++){this.appendStop(Bm[Bl])}},getDirections:function(Bm,Bl){Bj.call(this);BU(A3,"GetDirectionsStateless",this,Bm,Bl)},getEnd:function(){return this._end.getLocation()},getStart:function(){return this._start.getLocation()},getStop:function(Bl){return this._stops[Bl].getLocation()},getStopCount:function(){return this._stops.length},optimize:function(Bo,Bm){Bj.call(this);var Bl=this;var Bn=function(Bq){Bl._stops=[];for(var Bp=0;Bp<Bq.length;Bp++){Bl.appendStop(Bq[Bp].getLocation())}if(typeof (Bo)==="function"){Bo()}};BU(A3,"OptimizeStateless",this,Bn,Bm)},setEnd:function(Bl){this._end=new BG(Bl)},setStart:function(Bl){this._start=new BG(Bl)},setStrategy:function(Bl){this._strategy=Bl}},{MAX_STOP_COUNT:Bk});b(Bi,["stops","strategy"]);j(Bi,BZ+"Route");Aw(Bi,[["_end","End"],["_start","Start"],["_stops","Stops"],["_strategy","Strategy"],["_time","CurrentTime"],["_trafficSource","TrafficSource"]]);return Bi}(),RouteStop:BG=function(){var Bi=g({init:function(Bj){if(typeof (Bj)==="object"){if(("lat" in Bj)&&("lon" in Bj)){this._loc=new AJ(Bj)}else{if("_loc" in Bj){this._loc=new AJ(Bj._loc)}}}},_loc:null,getAverageTime:function(){return this._averageTime},getDescription:function(){return this._desc||""},getHeading:function(){var Bj=this._heading;return isNaN(Bj)?NaN:Bj},getLocation:function(){return new AJ(this._loc)},getRoadIntersection:function(){var Bj=this._roadIntersection;return Bj?new AJ(this._roadIntersection):null},getStopNumber:function(){return this._stopNumber},getWindowEnd:function(){return this._windowStart},getWindowStart:function(){return this._windowStart},isEnd:function(){return this._isEnd},isStart:function(){return this._isStart}});j(Bi,"RouteStop");Aw(Bi,[["_averageTime","AverageTime"],["_desc","Description"],["_heading","Heading"],["_isEnd","m_End"],["_isStart","m_Start"],["_loc","Location"],["_point","m_Point"],["_roadIntersection","RoadIntersection"],["_stopNumber","StopNumber"],["_tag","Tag"],["_windowEnd","WindowEnd"],["_windowStart","WindowStart"],["_dontLoadBefore","DontLoadBefore"],["_incompatibleLoads","IncompatibleLoads"],["_load","Load"],["_penalty","Penalty"],["_skillsRequired","SkillsRequired"]]);return Bi}(),Waypoint:A5=function(){var Bj=BG.prototype,Bi=H(BG,{init:function(Bk){Bj.init.call(this,Bk)}});j(Bi,"Waypoint");return Bi}(),RoutingStrategy:function(){BC=g({init:function(Bi){if(typeof (Bi)==="object"){if("allowUTurns" in Bi){this._allowUTurns=Bi.allowUTurns}if("roadCrossingBehavior" in Bi){this._roadCrossingBehavior=Bi.roadCrossingBehavior}if("useTollRoads" in Bi){this._useTollRoads=Bi.useTollRoads}}},_allowUTurns:false,_roadCrossingBehavior:Bg,_useTollRoads:true,getAllowUTurns:function(){return this._allowUTurns},getRoadCrossingBehavior:function(){return this._roadCrossingBehavior},getUseTollRoads:function(){return this._useTollRoads},setAllowUTurns:function(Bi){this._allowUTurns=Bi},setRoadCrossingBehavior:function(Bi){this._roadCrossingBehavior=Bi},setUseTollRoads:function(Bi){this._useTollRoads=Bi}});b(BC,["allowUTurns","roadCrossingBehavior","useTollRoads"]);Aw(BC,[["_allowUTurns","AllowUTurns"],["_roadCrossingBehavior","RoadCrossingBehavior"],["_useTollRoads","UseTollRoads"]]);return BC}(),RoutingStrategyFastest:BI=H(BC),RoutingStrategyShortest:BV=H(BC),SFRampMovementEvent:BB=H(BL),SplitMovementEvent:BW=H(BL),TurnMovement:function(){var Bi=H(BL,{_isEndOfStreet:false,_isLeftTurn:false,_isRightTurn:false,_prevLeft:"",_prevLeftCount:-1,_prevRight:"",_prevRightCount:-1,getPrevLeft:function(){return this._prevLeft||""},getPrevLeftCount:function(){var Bj=this._prevLeftCount;return isNaN(Bj)?-1:Bj},getPrevRight:function(){return this._prevRight||""},getPrevRightCount:function(){var Bj=this._prevRightCount;return isNaN(Bj)?-1:Bj},isEndOfStreet:function(){return this._isEndOfStreet},isLeftTurn:function(){return this._isLeftTurn},isRightTurn:function(){return this._isRightTurn}});j(Bi,BZ+"TurnMovementEvent");Aw(Bi,[["_isEndOfStreet","m_EndOfStreet"],["_isLeftTurn","TurnLeft"],["_isRightTurn","TurnRight"],["_prevLeft","PrevLeft"],["_prevLeftCount","NumLefts"],["_prevRight","PrevRight"],["_prevRightCount","NumRights"]]);return Bi}()};j(A1,BZ+"ArriveEvent");j(BA,BZ+"ArrivalMovementEvent");j(Bb,BZ+"DepartEvent");j(A7,BZ+"DepartureMovementEvent");j(BX,BZ+"FFRampMovementEvent");j(BK,BZ+"FSRampMovementEvent");j(BR,BZ+"NameChangeNoteEvent");j(BI,BZ+"RoutingStrategyFastest");j(BV,BZ+"RoutingStrategyShortest");j(BB,BZ+"SFRampMovementEvent");j(BW,BZ+"SplitMovementEvent");j(BN,BZ+"ArrivalMovement");j(BE,BZ+"TurnMovement");j(Bf,BZ+"FerryMovement");j(BQ,BZ+"DepartureMovement");j(A4,BZ+"RoundAboutMovement");j(BF,BZ+"SplitMovement");j(BM,BZ+"FFRampMovement");j(Bh,BZ+"SFRampMovement");j(BS,BZ+"FSRampMovement");j(Bc,BZ+"FreewayEndsNote");j(BO,BZ+"NameChangeNote");j(A6,BZ+"StateChangesNote");j(BY,BZ+"TollwayBeginsNote");j(Be,BZ+"TollwayEndsNote");return Bd}()})();(function(){AS.DataQuery=function(){var A2=P.DATAQUERY_PAGE,A1=P.invoke;return{queryPOI:function(A7,A5,A4){var A6=0;while(typeof (arguments[A6])!=="function"){A6++}var A8=arguments[A6];var A3=arguments[A6+1];if(!(A5 instanceof Array)){A5=null}if(typeof (A4)!=="string"&&!(A4 instanceof String)){A4=""}A1(A2,"QueryPoi",[A7,A5,A4],A8,A3)}}}()})();(function(){AS.Skin=function(){Q=g({init:function(A1){this._images={};this._sizes={};this.Load=new C()},_images:null,_sizes:null,_initImageDiv:function(A4,A2){var A1=this._sizes[A2],A3=A4.style;A3.width=A1.width+"px";A3.height=A1.height+"px";A3.backgroundImage="url("+this._images[A2]+")";A3.backgroundPosition="center center";A3.padding="0px";return A4},destroy:function(){A(this)},isLoaded:function(){var A2=true,A1=this._images,A4=this._sizes;for(var A3 in A1){if(A1.hasOwnProperty(A3)){if(!A4[A3]){A2=false;break}}}return A2},load:function(){var A3=this,A2=this._images,A5=this.Load,A6=this._sizes;var A1=function(A7){return function(A8){A6[A7]=A8;if(A3.isLoaded()){A5.trigger()}}};for(var A4 in A2){if(A2.hasOwnProperty(A4)){Af(A2[A4],A1(A4))}}},whenLoaded:function(A1){if(this.isLoaded()){A1()}else{this.Load.appendOnce(A1)}}},{destroyInstances:function(){for(var A4=0;A4<Q.Derived.length;A4++){var A2=Q.Derived[A4];for(var A3 in A2){var A1=A2[A3];if(A1 instanceof A2){A1.destroy()}}}}});return Q}()})();(function(){AS.AbstractDOMEntity=function(){var A6=E.writeLine,BM=AT.DOM,A5=BM.disableSelection,BJ=BM.popFromTop,BC=BM.pushToTop,BE,BN,A8=0,BD=1,A4=2,BG=4,A3=8,A9=16,BH=32,BA=64,BI=128,BK=256,A2=512,BL=65535,BO=1,A1=2,BB=BO|A1,BF=0,A7={},BP=function(){var BR=this._showCallbacks;for(var BQ=0,BS=BR.length;BQ<BS;BQ++){BR[BQ].call(this)}this._showCallbacks=[];if(this.Show){this.Show.trigger(this._visibility)}};Am=g({init:function(BU,BS,BQ){if(!BU){BU={}}if(typeof (BS)==="function"){BQ=BS;BS=BB}else{if(!BS){BS=BB}}if(BS&BO){this.id=BU.id||("anonymous_"+BF++);this._silent=("silent" in BU)?BU.silent:false;A7[this.id]=this;this._showCallbacks=[];var BT=BU.events;if(isNaN(BT)){BT=BL}if(BT!==A8){if(BT&BD){this.Click=new C()}if(BT&A4){this.DoubleClick=new C()}if(BT&BG){this.Hide=new C()}if(BT&A3){this.MouseDown=new C()}if(BT&A9){this.MouseMove=new C()}if(BT&BH){this.MouseIn=new C()}if(BT&BA){this.MouseOut=new C()}if(BT&BI){this.MouseUp=new C()}if(BT&BK){this.RightClick=new C()}if(BT&A2){this.Show=new C()}}}if(BS&A1){var BV=this.elem=BQ?BQ.call(this,BU):document.createElement("div");if(!BV.id){BV.id=(this.id+"_elem")}A5(BV);if(BU.events!==A8){var BR=this;if(this.Click){Ax(BV,"click",function(BW){BR.Click.trigger(BW)})}if(this.DoubleClick){Ax(BV,"dblclick",function(BW){BR.DoubleClick.trigger(BW)})}if(this.MouseMove){Ax(BV,"mousemove",function(BW){BR.MouseMove.trigger(BW)})}if(this.MouseIn){Ax(BV,"mouseover",function(BW){BR.MouseIn.trigger(BW)})}if(this.MouseOut){Ax(BV,"mouseout",function(BW){BR.MouseOut.trigger(BW)})}if(this.MouseUp){Ax(BV,"mouseup",function(BW){BR.MouseUp.trigger(BW)})}if(this.MouseDown){Ax(BV,"mousedown",function(BW){BR.MouseDown.trigger(BW);return AW(BW)})}if(this.RightClick){Ax(BV,"contextmenu",function(BW){BR.RightClick.trigger(BW);return AW(BW)})}}if(BS&BO){this.setVisibility(!("show" in BU)||BU.show)}}},_showCallbacks:null,_silent:false,_visibility:0,elem:null,id:"",addEvent:function(BQ,BR){Ax(this.elem,BQ,BR)},attach:function(BQ){if(this.elem){if(this._visibility>0){BQ.appendChild(this.elem);BP.call(this)}else{this._parentNode=BQ}}},destroy:function(){delete A7[this.id];if(this.Hide){this.Hide.destroy();delete this.Hide}if(this.Show){this.Show.destroy();delete this.Show}if(this.elem){T(this.elem);delete this.elem}},detach:function(){if(this.elem){if(this._visibility>0){var BQ=this.elem.parentNode;if(BQ){BQ.removeChild(this.elem)}}else{delete this._parentNode}}},getVisibility:function(){return this._visibility},hide:BE=function(BR){if(isNaN(BR)){BR=0}this._visibility=BR;if(this.elem&&BR<=0){var BQ=this.elem.parentNode;if(BQ&&BQ.id){BQ.removeChild(this.elem);this._parentNode=BQ}if(this.Hide){this.Hide.trigger(BR)}}},hideCumulative:function(){BE.call(this,this._visibility-1)},isVisible:function(){return !!(this.elem&&this.elem.parentNode&&this.elem.parentNode.id)},log:function(BQ){if(!this._silent){A6(this.id+": "+BQ)}},popFromTop:function(){if(this.elem){BJ(this.elem)}},pushToTop:function(BQ){if(this.elem){BC(this.elem,BQ)}},removeEvent:function(BQ,BR){Ap(this.elem,BQ,BR)},setVisibility:function(BQ){if(BQ){this.show()}else{this.hide()}},show:BN=function(BQ,BR){if(typeof (BQ)==="function"){BR=BQ;BQ=undefined}if(isNaN(BQ)){BQ=1}this._visibility=BQ;if(this.elem&&BQ>0){if(this._parentNode){this._parentNode.appendChild(this.elem);delete this._parentNode}if(BR){BR()}if(this.elem.parentNode){BP.call(this)}}},showCumulative:function(BQ){BN.call(this,this._visibility+1)},toggleVisibility:function(){this.setVisibility(!this.elem||this._visibility<=0)},toString:function(){return this.id},whenDOMReady:function(BQ){if(this.elem){BQ.call(this)}else{this._showCallbacks.push(BQ)}},whenVisible:function(BQ){if(this.elem&&this.elem.parentNode){BQ.call(this)}else{this._showCallbacks.push(BQ)}}},{EVENT_ALL:BL,EVENT_CLICK:BD,EVENT_DOUBLE_CLICK:A4,EVENT_HIDE:BG,EVENT_MOUSE_DOWN:A3,EVENT_MOUSE_MOVE:A9,EVENT_MOUSE_IN:BH,EVENT_MOUSE_OUT:BA,EVENT_MOUSE_UP:BI,EVENT_NONE:A8,EVENT_RIGHT_CLICK:BK,EVENT_SHOW:A2,INIT_DATA:BO,INIT_DOM:A1,INIT_FULL:BB,destroyInstances:function(){for(var BQ in A7){if(A7.hasOwnProperty(BQ)){A7[BQ].destroy()}}A7=[]}});b(Am,["events","id","show","silent"]);Ao(Am,["destroy"]);Ad(Am,["_showCallbacks","_silent","_visibility","elem","id"]);return Am}()})();(function(){F=AS.Canvas=function(){var A2=4,BA=2,A1=1,A9=1,A4=2,BB=function(){var BC=document.createElement("canvas");return typeof (BC.getContext)==="function"}(),A3=BB?A9:A4,A6=A3===A9,A8=function(){if(A3===A9){var BD=this._container.getContext("2d"),BC=this._size;BD.clearRect(0,0,BC.width,BC.height)}},A7=Am.prototype,A5=H(Am,{init:function(BE,BC){var BJ=this;if(!BE){BE={}}BE.events=Am.EVENT_NONE;A7.init.call(this,BE,function(BL){var BM=BL.parent||document.body;if(BL.id&&document.getElementById(BL.id)){BM=document.getElementById(BL.id)}return AQ("div",BM,BJ.id,function(BP){var BO=BP.style;BO.overflow="hidden";BO.position="absolute";var BN=AQ(A3===A9?"canvas":"div",BP),BQ=BN.style;BQ.position="absolute";BQ.left="0px";BQ.top="0px";BJ._container=BN;if(BC){BC(BP)}})});var BH=!(("lineColor" in BE)&&!BE.lineColor)&&!(("lineColour" in BE)&&!BE.lineColour),BI=!!(BE.fillColor||BE.fillColour);this._lineWidth=isNaN(BE.lineWidth)?1:BE.lineWidth;this._lineColor=!BH?BH:(BE.lineColor||BE.lineColour||new Z(0,0,0));this._fillColor=!BI?BI:(BE.fillColor||BE.fillColour||new Z(255,255,255));this._offset=new G(0,0);this._shapes=[];var BK,BD=BE.size;if(BD){BK=new AF(BD)}else{var BF=this.elem,BG=BF.style;if(BG.width||BG.height){BK=new AF(BF)}else{BK=new AF(BF.parentNode)}}this.setSize(BK)},_container:null,_fillColor:null,_lineColor:null,_lineWidth:1,_locked:false,_offset:null,_shapes:null,_size:null,circle:function(BD,BC){return this.ellipse(BD,BC,BC)},destroy:function(){this._locked=true;var BC=this._shapes,BE=BC.length;A7.destroy.call(this);AI(this,"_container");for(var BD=BE-1;BD>=0;BD--){BC[BD].destroy()}},ellipse:function(BC,BF,BE){var BD=new A5.Shapes.Ellipse(this);BD.center=new G(BC);BD.radiusX=isNaN(BF)?0:BF;BD.radiusY=isNaN(BE)?0:BE;return BD},getFillColor:function(){var BC=this._fillColor;return(BC?new Z(BC):null)},getHeight:function(){return this._size.height},getLineColor:function(){var BC=this._lineColor;return(BC?new Z(BC):null)},getLineWidth:function(){return this._lineWidth},getSize:function(){return new AF(this._size)},getWidth:function(){return this._size.width},line:function(BD,BC){return this.polyline([BD,BC])},path:function(BD){var BC=[],BK=new A5.Shapes.Path(this);if(BD){var BI=BD.length;for(var BF=0;BF<BI;BF++){var BH=BD[BF],BG=BH.length,BJ=[BH[0]];for(var BE=1;BE<BG;BE++){BJ[BE]=new G(BH[BE])}BC[BF]=BJ}}BK.commands=BC;return BK},polyline:function(BF,BD){var BH=[],BC=new A5.Shapes.PolyLine(this);if(BF){var BG=BF.length;for(var BE=0;BE<BG;BE++){BH[BE]=new G(BF[BE])}}BC.points=BH;BC.closed=BD;return BC},rect:function(BE,BD){var BC=new A5.Shapes.Rect(this);BC.p1=new G(BE);BC.p2=new G(BD);return BC},setFillColor:function(BC){this._fillColor=(BC?new Z(BC):null)},setLineColor:function(BC){this._lineColor=(BC?new Z(BC):null)},setLineWidth:function(BC){this._lineWidth=BC},setSize:function(BK){if(!BK||typeof (BK)!=="object"){BK=this._size||new AF()}var BD=A0(BK.width),BI=A0(BK.height);if(!BD||!BI){throw new Al("no dimensions available for "+this.id)}BK=new AF(BD,BI);var BF=this.elem.style;BF.width=BD+"px";BF.height=BI+"px";if(A3===A9){var BC=this._container;BC.width=BD;BC.height=BI}else{var BH=this._container.style;BH.width=BD+"px";BH.height=BI+"px"}var BE=this._shapes,BJ=BE.length;for(var BG=0;BG<BJ;BG++){BE[BG]._setSize(BK)}this._size=BK;this.update()},update:function(){var BC=this._shapes,BE=BC.length;if(A6){A8.call(this)}for(var BD=0;BD<BE;BD++){BC[BD].draw()}}},{API:A3,COMMAND_BEZIER:A2,BEZIER_ARC_APPROX:0.2761423749154*2,API_CANVAS:A9,COMMAND_LINE:BA,COMMAND_MOVE:A1,USE_RASTER:A6,API_VML:A4});b(A5,["fillColor","fillColour","lineColor","lineColour","lineWidth","parent","size"]);return A5}()})();(function(){var A2=F.API,A5=F.API_CANVAS,A1=F.API_VML;F.Shapes=function(){var A9=F.COMMAND_BEZIER,A7=F.COMMAND_LINE,A6=F.COMMAND_MOVE,BA=function(BF,BD){var BE=BD._offset,BC=A0(BF.x+BE.x),BB=A0(BF.y+BE.y);return new G(BC,BB)},A8=function(){var BB=g({init:function(BF){if(!(BF instanceof F)){throw new O("shape created without a valid canvas")}var BC=BF._shapes,BE=BC.length;BC[BE]=this;this._index=BE;this._canvas=BF;this.fillColor=BF.getFillColor();this.lineColor=BF.getLineColor();this.lineWidth=BF.getLineWidth();if(A2===A1){var BD=this;this.elem=AQ("vml:shape",BF._container,null,function(BH){var BG=BH.style;BH.coordOrigin="0 0";BG.backgroundColor="transparent";BG.position="absolute";BG.left="0px";BG.top="0px";BD._fillElem=AQ("vml:fill",BH);BD._pathElem=AQ("vml:path",BH);var BI=AQ("vml:stroke",BH);BI.joinstyle="round";BI.endcap="round";BD._strokeElem=BI})}this._setSize(BF.getSize())},_canvas:null,fillColor:null,lineColor:null,lineWidth:1,_setSize:function(BE){if(A2===A1){var BG=this.elem,BD=BG.style,BF=BE.width,BC=BE.height;BG.coordsize=BF+" "+BC;BD.width=BF+"px";BD.height=BC+"px"}},destroy:function(){this._canvas._shapes.splice(this._index,1);if(this.elem){AI(this,"elem")}if(this._fillElem){AI(this,"_fillElem")}if(this._pathElem){AI(this,"_pathElem")}if(this._strokeElem){AI(this,"_strokeElem")}delete this._canvas},draw:function(){if(z){var BD=this._validate();if(BD){throw new w("invalid '"+BD+"' specification for shape")}}var BI=this.fillColor,BH=this.lineColor;switch(A2){case A5:var BE=this._canvas._container.getContext("2d");if(BH instanceof Z){BE.strokeStyle=BH.toCSSRGBA()}if(BI instanceof Z){BE.fillStyle=BI.toCSSRGBA()}BE.lineWidth=this.lineWidth;BE.lineJoin="round";BE.lineCap="round";this._draw(BE);if(BI){BE.fill()}if(BH){BE.stroke()}break;case A1:var BF=this.elem.style,BC=this._fillElem,BG=this._strokeElem;BF.display="none";BC.on=(BI?"true":"false");BG.on=(BH?"true":"false");if(BH){BG.color=BH.toCSSHex();BG.opacity=BH.a}if(BI){BC.color=BI.toCSSHex();BC.opacity=BI.a}BG.weight=this.lineWidth+"px";this._pathElem.v=this._draw()||"e";BF.display="block";break}}});Ao(BB,["_draw","_validate"]);Ad(BB);return BB}();return{Ellipse:H(A8,{center:null,radiusX:0,radiusY:0,_draw:function(BE){var BM,BB=BA(this.center,this._canvas),BJ=BB.x,BI=BB.y,BG=this.radiusX,BF=this.radiusY,BD=A0(BG),BC=A0(BF);switch(A2){case A5:var BL=F.BEZIER_ARC_APPROX,BH=A0(BL*BG),BK=A0(BL*BF);BE.beginPath();BE.moveTo(BJ-BD,BI);BE.bezierCurveTo(BJ-BD,BI-BK,BJ-BH,BI-BC,BJ,BI-BC);BE.bezierCurveTo(BJ+BH,BI-BC,BJ+BD,BI-BK,BJ+BD,BI);BE.bezierCurveTo(BJ+BD,BI+BK,BJ+BH,BI+BC,BJ,BI+BC);BE.bezierCurveTo(BJ-BH,BI+BC,BJ-BD,BI+BK,BJ-BD,BI);break;case A1:BM="ar ";BM+=(BJ-BD)+","+(BI-BC)+",";BM+=(BJ+BD)+","+(BI+BC)+",";BM+=(BJ-BD)+","+(BI)+",";BM+=(BJ-BD)+","+(BI)+" e";break}return BM},_validate:function(){var BB=this.center;if(typeof (BB)!=="object"){return"center"}if(isNaN(BB.x)){return"center.x"}if(isNaN(BB.y)){return"center.y"}if(isNaN(this.radiusX)){return"radiusX"}if(isNaN(this.radiusY)){return"radiusY"}}}),Path:H(A8,{commands:null,_draw:function(BB){var BO,BC=this._canvas,BM=this.commands,BL=BM.length;if(A2===A5){BB.beginPath()}for(var BF=0;BF<BL;BF++){var BG=[],BD=BM[BF],BI=BD[0],BN=BD.length;for(var BE=1;BE<BN;BE++){BG[BE-1]=BA(BD[BE],BC)}var BK=BG[0],BJ=BG[1],BH=BG[2];switch(A2){case A5:switch(BI){case A6:BB.moveTo(BK.x,BK.y);break;case A7:BB.lineTo(BK.x,BK.y);break;case A9:BB.bezierCurveTo(BK.x,BK.y,BJ.x,BJ.y,BH.x,BH.y);break}break;case A1:switch(BI){case A6:BO+="m "+BK.x+","+BK.y+" ";break;case A7:BO+="l "+BK.x+","+BK.y+" ";break;case A9:BO+="c "+BK.x+","+BK.y+","+BJ.x+","+BJ.y+","+BH.x+","+BH.y+" ";break}break}}return BO},_validate:function(){var BI=this.commands;if(!(BI instanceof Array)){return"commands"}var BG=BI.length;for(var BE=0;BE<BG;BE++){var BC=BI[BE],BF="commands ["+BE+"]";if(!(BC instanceof Array)){return BF}var BH;switch(BC[0]){case A6:case A7:BH=2;break;case A9:BH=4;break;default:return BF+"[0]"}if(BC.length!==BH){return BF+".length"}for(var BD=1;BD<BH;BD++){var BJ=BC[BD],BB=BF+"["+BD+"]";if(typeof (BJ)!=="object"){return BB}if(isNaN(BJ.x)){return BB+".x"}if(isNaN(BJ.y)){return BB+".y"}}}}}),PolyLine:H(A8,{closed:false,points:null,_draw:function(BB){var BK=this.points,BJ=BK.length;if(BJ<2){return }var BG,BC=this._canvas,BE=[];for(BG=0;BG<BJ;BG++){BE[BG]=BA(BK[BG],BC)}var BI=BE[0],BF=BI.x,BD=BI.y,BL,BH;switch(A2){case A5:BB.beginPath();BB.moveTo(BF,BD);for(BG=1;BG<BJ;BG++){BH=BE[BG];BB.lineTo(BH.x,BH.y)}if(this.closed){BB.lineTo(BF,BD)}break;case A1:BL="m "+BF+","+BD+" l ";for(BG=1;BG<BJ;BG++){BH=BE[BG];BL+=BH.x+","+BH.y+" "}if(this.closed){BL+=BF+","+BD+" e"}break}return BL},_validate:function(){var BE=this.points,BF=BE.length;if(!(BE instanceof Array)){return"points"}for(var BD=0;BD<BF;BD++){var BC="points["+BD+"]",BB=BE[BD];if(typeof (BB)!=="object"){return BC}if(isNaN(BB.x)){return BC+".x"}if(isNaN(BB.y)){return BC+".y"}}}}),Rect:H(A8,{p1:null,p2:null,_draw:function(BC){var BD=this._canvas,BI=BA(this.p1,BD),BG=BA(this.p2,BD),BE=BI.x,BF=BI.y,BH=BG.x,BB=BG.y,BJ;switch(A2){case A5:BC.beginPath();BC.rect(BE,BF,BH-BE,BB-BF);break;case A1:BJ="m "+BE+","+BF+" l ";BJ+=BH+","+BF+" ";BJ+=BH+","+BB+" ";BJ+=BE+","+BB+" ";BJ+=BE+","+BF+" e";break}return BJ},_validate:function(){var BC=this.p1,BB=this.p2;if(typeof (BC)!=="object"){return"p1"}if(typeof (BB)!=="object"){return"p2"}if(isNaN(BC.x)){return"p1.x"}if(isNaN(BC.y)){return"p1.y"}if(isNaN(BB.x)){return"p2.x"}if(isNaN(BB.y)){return"p2.y"}}})}}();if(A2===A1){var A3=document.namespaces;if(!A3.vml){A3.add("vml","urn:schemas-microsoft-com:vml")}var A4=document.createStyleSheet();A4.cssText="vml\\:shape, vml\\:fill, vml\\:stroke, vml\\:path {behavior:url(#default#VML)}"}})();(function(){F.Util=function(){var A7,A5,A2,A1=function(A8,A9){return(A8[0]*A9.x+A8[1]*A9.y+A8[2]>=0)},A6=function(BI,BH){var BB=BI[0],A9=BI[1],A8=BI[2],BG=BH[0],BF=BH[1],BD=BH[2],BA=BB*BF-A9*BG,BE=A0((A9*BD-A8*BF)/BA),BC=A0((A8*BG-BB*BD)/BA);return new G(BE,BC)},A4=function(BB,BD,BA,BC){var A9=BD-BC,A8=BA-BB,BE=-A9*BB-A8*BD;return[A9,A8,BE]},A3=function(A8,A9,BC){var BD=A8.length;if(BD<1){return }var BF,BB=0;if(!BC){BF=A8[0];if(!A1(A9,BF)){A8.splice(0,1)}else{BB++}}else{BF=A8[BD-1]}for(;BB<A8.length;BB++){var BE=A8[BB],BA=A1(A9,BF),BG=A1(A9,BE);if(BA&&!BG){A8.splice(BB,1,A6(A9,A4(BE.x,BE.y,BF.x,BF.y)))}else{if(!BA&&BG){A8.splice(BB,0,A6(A9,A4(BF.x,BF.y,BE.x,BE.y)));BB++}else{if(!BA&&!BG){A8.splice(BB,1);BB--}}}BF=BE}};return{clipPath:function(BB,BA,A9,A8){if(typeof (A8)==="undefined"){A8=true}A3(BB,A4(BA.x,A9.y,BA.x,BA.y),A8);A3(BB,A4(BA.x,BA.y,A9.x,BA.y),A8);A3(BB,A4(A9.x,BA.y,A9.x,A9.y),A8);A3(BB,A4(A9.x,A9.y,BA.x,A9.y),A8);return A2(BB,A8)},pathsEqual:function(BD,BC,A8,BB){var BA=BD.length;if(BA!==BC.length){return false}for(var A9=0;A9<BA;A9++){if(!BD[A9].equals(BC[A9],A8)){return false}}return true},polysEqual:function(A9,BE,BA){var BC=A9.length;if(BC!==BE.length){return false}for(var BD=0;BD<BC;BD++){var A8=true;for(var BB=0;BB<BC;BB++){if(!A9[(BB+BD)%BC].equals(BE[BB],BA)){A8=false;break}}if(A8){return true}}return BC===0},reducePath:function(BA,A9,A8){if(typeof (A8)==="undefined"){A8=128}return(BA.length<A8?A7:A5)(BA,A9)},reducePathByAltitude:A7=function(){var A8=function(BD,BB,A9){var BQ=Infinity;if(BD&&A9){var BN=BD.x,BM=BD.y,BC=BB.x,BA=BB.y,BF=A9.x,BE=A9.y;if(BN===BF){BQ=BC-BN;BQ*=BQ}else{if(BM===BE){BQ=BA-BM;BQ*=BQ}else{var BL=(BM-BE)/(BN-BF),BG=-1/BL,BP=BM-BN*BL,BO=BA-BG*BC,BK=(BP-BO)/(BG-BL),BJ=BG*BK+BO,BI=BC-BK,BH=BA-BJ;BQ=BI*BI+BH*BH}}}return BQ};return function(BH,BD){var BE=BH.length,BG=Ac(2,A0(BE*BD));if(BE>=2){var BC;for(BC=0;BC<BH.length;BC++){BH[BC].cost=A8(BH[BC-1],BH[BC],BH[BC+1])}while((BE=BH.length)>BG){var BA=0,BB=BH[BA].cost;for(BC=1;BC<BE;BC++){if(BH[BC].cost<BB){BA=BC;BB=BH[BA].cost}}BH.splice(BA,1);var BF=BH[BA-1],A9=BH[BA];BF.cost=A8(BH[BA-2],BF,A9);A9.cost=A8(BF,A9,BH[BA+1])}for(BC=0;BC<BE;BC++){delete BH[BC].cost}}return BH}}(),reducePathUniformly:A5=function(BA,A9){var BB=1/(1-A9);for(var A8=BB;A8<BA.length-1;A8+=BB){BA.splice(A8,1);A8--}return BA},removeRepeatedPoints:A2=function(BD,A9,A8){var BC,BB=A9?BD[BD.length-1]:BD[0];for(var BA=(A9?0:1);BA<BD.length;BA++){while((BC=BD[BA])&&BC.equals(BB,A8)){BD.splice(BA,1)}BB=BC}return BD},splitPath:function(BJ,BE,BD){var BB,BI=[];for(BB=0;BB<BJ.length-1;BB++){var BH=BJ[BB],BG=BJ[BB+1],BC=BH.x,BA=BH.y,A9=BG.x,A8=BG.y;var BF=(BC===BE.x&&A9===BE.x)||(BA===BE.y&&A8===BE.y)||(BC===BD.x&&A9===BD.x)||(BA===BD.y&&A8===BD.y);if(BF){BI.push(BJ.slice(0,BB+1));BJ=BJ.slice(BB+1);BB=-1}}BI.push(BJ);for(BB=0;BB<BI.length;BB++){if(BI[BB].length<2){BI.splice(BB,1);BB--}}return BI}}}()})();(function(){Ah=AS.MapLayers={}})();(function(){AM=Ah.AbstractLayer=function(){var A4=function(A6){var A5=this[A6];this[A6]=0;if(A5>0){this.update(A5)}};var A1=function(A6,A5){var A7=this[A6];if(A7<0){A7=A5}else{if(A7>0){A7=A7|A5}}this[A6]=A7};var A2=Am.prototype,A3=H(Am,{init:function(A5,A6){if(!A5){A5={}}A5.events=Am.EVENT_NONE;A2.init.call(this,A5);if("zIndex" in A5&&!isNaN(A5.zIndex)){this.elem.style.position="absolute";this.setZIndex(A5.zIndex)}this.Added=new C();this.Removed=new C();this.Update=new C();if(typeof (A6)==="function"){A6(this.elem)}if(("show" in A5)&&!A5.show){this.hide()}this._handlers=new Array();this.setMap(A5.map||A5.parent||null);Ah[this.id]=this},_hideState:0,_suspendState:0,Added:null,map:null,Removed:null,Update:null,destroy:function(){var A5=this.map;if(A5){this.setMap(null)}delete Ah[this.id];A2.destroy.call(this)},hide:function(A5){A2.hide.call(this,A5);if(isNaN(A5)||A5<=0){this._hideState=-1}},setZIndex:function(A5){if(this.elem){if(A5>AT.ZIndices.INACTIVE_TILE_TRANSITION&&A5<AT.ZIndices.BALLOON){this.elem.style.zIndex=A5}else{throw"zIndex has to be greater than "+AT.ZIndices.INACTIVE_TILE_TRANSITION+" and less than "+AT.ZIndices.BALLOON}}},getZIndex:function(){if(this.elem){return this.elem.style.zIndex}else{return NaN}},setMap:function(A8){var A6=this,A5=this.map;if(A8!==A5){if(A5){this.detach();A5.removeListener(this);if(this.Removed){this.Removed.trigger(A5)}}A8=this.map=((A8 instanceof U)?A8:J[A8])||null}if(A8){A8.whenVisible(function(){A6.attach(A8.container);A8.addListener(A6);A6.update(U.UPDATE_FULL);if(A6.Added){A6.Added.trigger(A8)}})}if(A8){for(var A7 in this._handlers){A8._checkEventType(A7)}}},show:function(A5,A6){if(isNaN(A5)||A5>0){A4.call(this,"_hideState")}A2.show.call(this,A5,A6)},suspend:function(){this._suspendState=-1},unsuspend:function(){A4.call(this,"_suspendState")},update:function(A5){var A6=this._suspendState;if(A6===0){var A7=this._hideState;if(A7===0){if(typeof (this._update)==="function"){this._update(A5)}}else{A1.call(this,"_hideState",A5)}}else{A1.call(this,"_suspendState",A5)}},whenAdded:function(A5){if(this.map){A5()}else{this.Added.appendOnce(A5)}},_handlers:null,addEvent:function(A5,A6){if(!this._handlers[A5]){this._handlers[A5]=new Array()}this._handlers[A5].push(A6);if(this.map){this.map._checkEventType(A5)}},removeEvent:function(A5,A6){this._handlers[A5].splice(this._handlers[A5].indexOf(A6),1)},shouldHandleEvent:function(A5){return true},_handleEvent:function(A6){if(this.shouldHandleEvent(A6)){if(this._handlers[A6.type]){for(var A5=0;A5<this._handlers[A6.type].length;A5++){this._handlers[A6.type][A5](A6)}}return true}return false}});b(A3,["map","parent","zIndex"]);Ao(A3,["destroy"]);Ad(A3,["_suspendState","Added","map","Removed","Update"]);return A3}()})();(function(){p=Ah.AbstractObject=function(){var BD,A6=1024,A8=2048,BF=4096,A2=8192,A3=16384,BB={},A7={},BC="implicit_objects",BE="pointer",A4=function(BJ){var BH=this.layer;if(!BH){return }if(BJ!==A7){this.setPosition()}if(this.layer._addObject){this.layer._addObject(this,this._loc)}if(!this._silent){this.log("added to "+this.layer.id+" at "+this._loc+".")}var BI=this._addedCallbacks;for(var BG=0,BK=BI.length;BG<BK;BG++){BI[BG].call(this)}this._addedCallbacks=[];if(this.Added){this.Added.trigger(this.layer)}},A1=function(BG){var BH=BG.balloonConfig;var BJ=!("layer" in BH);BH.id=this.id+"_balloon";BH.location=this._loc;if(!("events" in BH)){BH.events=BG.events}if(!("show" in BH)){BH.show=false}if(!("silent" in BH)){BH.silent=this._silent}if(BJ){BH.layer=this.layer}var BI=this._balloon=new Ab(BH);BI._pos=this._pos;BI._unmanaged=BJ;BI.setLayer(BH.layer);BI.setBehavior(this.elem)},BA=function(){var BG=this.layer;if(BG._removeObject){BG._removeObject(this,this._loc)}this.layer=null;if(!this._silent){this.log("removed from "+BG.id+" at "+this._loc+".")}if(this.Removed){this.Removed.trigger(BG)}},A9=Am.prototype,A5=H(Am,{init:function(BI,BL,BK){var BG=this;if(!BI){BI={}}this._anchorPoint=BI.anchorPoint||new G(0.5);this._size=BI.size||new AF();this._loc=BI.location||new AJ();A9.init.call(this,BI,Am.INIT_DATA);this._addedCallbacks=[];var BH=BI.events;if(isNaN(BH)){BH=Am.EVENT_ALL}if(BH&A6){this.Added=new C()}if(BH&A8){this.Drag=new C()}if(BH&BF){this.EndDrag=new C()}if(BH&A2){this.Move=new C()}if(BH&A3){this.Removed=new C()}this._beginDrag=function(BN){var BM=BG.layer.map;BM.Drag.disable();AB(BG,BG.moveBy,function(){BM.Drag.enable();if(BG.EndDrag){BG.EndDrag.trigger()}});if(BG.Drag){BG.Drag.trigger(BN)}};var BJ=(BI.layer||BI.map||BI.parent||BG.layer);if(BJ){this.setLayer(BJ,BB)}this._lazyCallbacks=[function(){A9.init.call(BG,BI,Am.INIT_DOM,function(BM){BG.elem=AQ("div",null,BG.id+"_elem",function(BN){BN.style.position="absolute"});if(BL){BL(BG.elem)}return BG.elem});BG.setDragEnabled(!!BI.dragEnabled);if(BG._size.width>0&&BG._size.height>0){BG.setSize(null,A7);BG.setLayer(BG.layer)}else{BG.setLayer(BG.layer,A7)}if(BI.balloonConfig){A1.call(BG,BI)}}];if(!("show" in BI)||BI.show){if(this.layer){this.show()}else{this._addedCallbacks.push(this.show)}}},_addedCallbacks:null,_anchorPoint:null,_balloon:null,_dragEnabled:false,_loc:null,_pos:null,_size:null,layer:null,destroy:function(){if(this._balloon){this._balloon.destroy();delete this._balloon}if(this.layer){this.setLayer(null)}A9.destroy.call(this)},disableDrag:function(){this.setDragEnabled(false)},enableDrag:function(){this.setDragEnabled(true)},getAnchorPixels:function(){return new G(this._anchorPoint.x*(this._size.width-1),this._anchorPoint.y*(this._size.height-1))},getAnchorPoint:function(){return new G(this._anchorPoint)},getBalloon:function(){return this._balloon},getLocation:function(){return new AJ(this._loc)},getSize:function(){return new AF(this._size)},hide:function(){var BG=this._balloon;if(BG&&(BG.elem&&BG._visibility>0)){BG.hide();this._showCallbacks.push(function(){BG.show()})}A9.hide.apply(this,arguments)},isDragEnabled:function(){return this._dragEnabled},moveBy:function(BI){var BG=new G();var BH=this.layer.map.getXY(this._loc);BG.x=BH.x+BI.x;BG.y=BH.y+BI.y;this.setPosition(BG)},setAnchorPoint:function(BG){if(BG){this._anchorPoint.x=BG.x;this._anchorPoint.y=BG.y}if(this.layer&&this.layer[this.id]){this.setPosition(this._pos,this._loc)}},setDragEnabled:function(BG){if(this._dragEnabled!==BG){if(BG){Ax(this.elem,"mousedown",this._beginDrag)}else{Ap(this.elem,"mousedown",this._beginDrag)}}this._dragEnabled=BG;this.elem.style.cursor=BG?BE:""},setLayer:function(BJ,BL){var BI;if(BJ!==this.layer){if(this.layer){BA.call(this)}if(BJ){BI=(BJ instanceof AM)?BJ:Ah[BJ];if(!BI){var BK=(BJ instanceof U)?BJ:J[BJ];if(BK){var BG=BK.id+"_"+BC;BI=BK[BG]||new AN({id:BG,map:BK})}}this.layer=BI||null}}BI=this.layer;if(BL!==BB&&BI){var BH=this;if(BI.elem&&BI.elem.parentNode){A4.call(this,BL)}else{BI._showCallbacks.push(function(){A4.call(BH,BL)})}}if(this._balloon){this._balloon.setLayer(BI,BL)}},setPosition:BD=function(BJ,BH){var BM=this._loc;if(!BM){return }if(!BJ&&!BH){BH=BM}else{if(BJ instanceof AJ){BH=BJ;BJ=null}}var BI=this.layer,BL=BI?BI.map:null;if(BL){if(!BJ&&BH){BJ=BL.getXY(BH)}else{if(!BH&&BJ){BH=BL.getLatLon(BJ)}}if(BJ){this._pos=BJ;if(this.elem){this.elem.style.left=(BJ.x-this._anchorPoint.x*(this._size.width-1)-BL._origin.x)+"px";this.elem.style.top=(BJ.y-this._anchorPoint.y*(this._size.height-1)-BL._origin.y)+"px"}}}if(BH&&(BH.lat!==BM.lat||BH.lon!==BM.lon)){if(this.Move){var BG=new AJ(BM)}if(BI&&BI._moveObject){BI._moveObject(this,BM,BH)}BM.lat=BH.lat;BM.lon=BH.lon;if(this.Move){this.Move.trigger(BG,BH)}}var BK=this._balloon;if(BK){if(BK.elem&&BK.elem.parentNode){BK.setPosition(BJ,BH)}else{BK._loc.lat=BH.lat;BK._loc.lon=BH.lon}}},setLocation:BD,setSize:function(BG,BJ){var BH=this._size;if(BG){BH.width=BG.width;BH.height=BG.height}if(this.elem){var BI=this.elem.style;BI.width=BH.width+"px";BI.height=BH.height+"px";if(BJ!==A7&&this.layer&&this.layer[this.id]){this.setPosition()}}},show:function(){if(this._lazyCallbacks){var BH=this._lazyCallbacks;delete this._lazyCallbacks;for(var BG=0,BI=BH.length;BG<BI;BG++){BH[BG].apply(this)}}A9.show.apply(this,arguments)},update:function(BG){if(BG&U.UPDATE_ZOOM){this.setPosition()}},whenAdded:function(BG){if(this.layer){BG.call(this)}else{this._addedCallbacks.push(BG)}}},{EVENT_ADDED:A6,EVENT_DRAG:A8,EVENT_END_DRAG:BF,EVENT_MOVE:A2,EVENT_REMOVED:A3,setDragCursor:function(BG){BE=BG||"pointer"}});Ao(A5,["destroy"]);b(A5,["anchorPoint","balloonConfig","dragEnabled","layer","map","parent","location","size"]);return A5}()})();(function(){AX=Ah.LayerCollection=function(){var A1=0;var A2=g({init:function(A3){if(!A3){A3={}}this.id=A3.id||("layer_collection_"+A1++);this._layers=[];var A5=A3.layers;if(A5){for(var A4=0,A6=A5.length;A4<A6;A4++){this.addLayer(A5[A4])}}Ah[this.id]=this},_layers:null,id:"",_update:function(A3){var A5=this._layers;for(var A4=0,A6=A5.length;A4<A6;A4++){A5[A4].update(A3)}},add:function(A4){if(A4 instanceof A2){for(var A3=0,A6=A4._layers.length;A3<A6;A3++){this.add(A4._layers[A3])}}else{var A5=((A4 instanceof AM)?A4:Ah[A4])||null;if(A5){this._layers.push(A5)}return A5}},destroy:function(){AI(this,"_layers");delete Ah[this.id]},setMap:function(A5){var A4=this._layers;for(var A3=0,A6=A4.length;A3<A6;A3++){A4[A3].setMap(A5)}},top:function(A3,A5){if(typeof (A3)==="function"){A5=A3;A3=null}if(!A3){A3=AM}var A6=this._layers;for(var A4=A6.length-1;A4>=0;A4--){if((A6[A4] instanceof A3)&&(!A5||A5(A6[A4]))){return A6[A4]}}return null},update:function(A3){var A5=this._layers;for(var A4=0,A6=A5.length;A4<A6;A4++){A5[A4].update(A3)}}});b(A2,["id","layers"]);return A2}()})();(function(){Ab=Ah.Balloon=function(){var BO=AT.DOM,A8=AT.ZIndices,A6=A8.BALLOON,BI=A8.BALLOON_RAISED,A1=BO.clearPosition,BF=o.onMouseOut,BB=BO.relMousePos,A4,BQ=1,BE=2,A3=4,BG=8,BR=16,BP=32768,BA=1,BJ=2,BC=4,BS=8,BL=16,BH=32,BN=64,BM=function(){var BZ=this._vAlign;if(!BZ){return }var BX=this._body,Bg=this._tag;if(!BX||!Bg){return }if(BX.offsetWidth){this._bodySize.width=BX.offsetWidth;this._bodySize.height=BX.offsetHeight}var Bb=this._bodySize.width,Be=this._skin,Ba=this._xOffset,BV=Be.getTagSize(),BU=BV.height-Be.getTagOverlap(),BT=(BX.offsetLeft<-Bb/2)?A3:BG,BW=Be.getTagAnchorPixels(BT,BZ),Bf=BW.x,Bd=BW.y,Bc=-Bf-Bb+BV.width,BY=-Bf;A1(BX);A1(Bg);if(BZ===BQ){BX.style.top=BU+"px";Bg.style.top=Bd+"px"}else{if(BZ===BR){BX.style.bottom=BU+"px";Bg.style.bottom=BU-Bd+"px"}}Ba=AD(Ba,BY);Ba=Ac(Ba,Bc);BX.style.left=Ba+"px";Bg.style.left=BY+"px";Bg.src=Be.getTagSrc(BT,BZ)},A9=function(BT,BU,BY){var BW=this._behaviorEvents;for(var BV=0,BX=BT.length;BV<BX;BV++){Ax(BT[BV],BU,BY);BW.push({elem:BT[BV],name:BU,callback:BY})}},A5=function(){if(!this.elem||this._visibility<=0){return }var Be=this._body,BU=this._bodySize;if(Be&&Be.offsetWidth){BU.width=Be.offsetWidth;BU.height=Be.offsetHeight}var Bb=10,BV=this.layer.map,Bd=BV.getSize(),BX=this._skin.getTagSize(),Bg=this._xOffset,Bj=BU.height+BX.height-1,BW=BU.width,BT=(this._body.offsetLeft<-BW/2)?A3:BG,Ba=this._skin.getTagAnchorPixels(BT,this._vAlign),Bi=BV.getXY(this._loc);Bi.x+=Ba.x;Bi.y+=Ba.y;var Bf=new G(Bi.x+Bg,Bi.y-Bj),Bc=new G(Bi.x+Bg+BW,Bi.y+Bj),BY=new G(Bb,Bb),Bh=new G(Bd.width-Bb,Bd.height-Bb),BZ=false;if(Bf.x<BY.x){this._xOffset=BY.x-Bi.x;BZ=true}else{if(Bc.x>=Bh.x){this._xOffset=Bh.x-Bi.x-BW;BZ=true}}if(this._vAlign===BR&&Bf.y<BY.y){this._vAlign=BQ;BZ=true}else{if(this._vAlign===BQ&&Bc.y>=Bh.y){this._vAlign=BR;BZ=true}}if(BZ){this._hAlign=0;BM.call(this)}},A7=function(){var BT=this;A9.call(this,[this._body],"mousedown",function(){if(BT._suspended){return }var BW=BT.layer.map;BW.Drag.disable();BT._suspended=true;var BV=function(BY,BX){BT._hAlign=0;BT._xOffset+=BY.x;if(BB(BX,BT._tag).y>=BT._skin.getTagSize().height){BT._vAlign=BQ}else{if(BB(BX,BT._tag).y<0){BT._vAlign=BR}}BM.call(BT)};var BU=function(){BW.Drag.enable();BT._suspended=false;var BY=BT._unsuspendCallbacks;for(var BX=0,BZ=BY.length;BX<BZ;BX++){BY[BX].call(BT)}BT._unsuspendCallbacks=[];if(BT.Unsuspend){BT.Unsuspend.trigger()}};AB(BT.elem,BV,BU)})},A2=function(BX,BZ){if(BX){this._hAlign=BX}if(BZ){this._vAlign=BZ}var BY=this._body,BU=this._bodySize;if(BY&&BY.offsetWidth){BU.width=BY.offsetWidth;BU.height=BY.offsetHeight}var Ba,BV=this._skin.getTagSize(),BT=(this._body.offsetLeft<-BU.width/2)?A3:BG,Bb=this._skin.getTagAnchorPixels(BT,this._vAlign),BW=-Bb.x-BU.width+BV.width;switch(this._hAlign){case A3:Ba=BW;break;case BE:Ba=A0(BW/2);break;case BG:Ba=0;break}if(!isNaN(Ba)){this._xOffset=Ba}BM.call(this)},BD=p.prototype,BK=H(p,{init:function(BU){var BT=this;if(!BU){BU={}}BU.anchorPoint=new G();if(!BU.show){BU.show=false}this._unsuspendCallbacks=[];if(isNaN(BU.events)||BU.events&BP){this.Unsuspend=new C()}this._behavior=("behavior" in BU)?BU.behavior:(("behaviour" in BU)?BU.behaviour:BS);this._content=BU.content||"";this._bodySize=new AF();this._behaviorEvents=[];this._hAlign=BU.hAlign||BG,this._vAlign=BU.vAlign||BR;BD.init.call(this,BU,function(BV){BT._skin=(BU.skin instanceof Ah.BalloonSkin)?BU.skin:Ah.BalloonSkin.standard;if(!BT._skin){throw new x("no skin available for "+BT.id+".")}BT._body=AQ("div",BV,BT.id+"_body",function(BW){BT._skin.applyBodyStyle(BW);BW.style.position="absolute";BW.style.display="inline-block"});BT._tag=AQ("img",BV,BT.id+"_tag",function(BW){BW.style.position="absolute"});BV.style.zIndex=A6;BV.style.width="0px";BV.style.height="0px";Ax(BV,"mouseover",function(){BT.pushToTop(BI)})})},_behavior:0,_behaviorEvents:null,_body:null,_bodySize:null,_hAlign:0,_skin:null,_static:false,_suspended:false,_tag:null,_target:null,_unsuspendCallbacks:null,_vAlign:0,_xOffset:0,Unsuspend:null,clearBehavior:function(){var BU=this._behaviorEvents;if(BU){for(var BT=0,BV=BU.length;BT<BV;BT++){Ap(BU[BT].elem,BU[BT].name,BU[BT].callback)}}this._behaviorEvents=[]},destroy:function(){this.clearBehavior();delete this._target;AI(this,"_body");AI(this,"_tag");BD.destroy.call(this)},hide:function(){if(!this._static){if(!this._suspended){BD.hide.apply(this,arguments)}else{this._unsuspendCallbacks.push(this.hide)}}},setAlignment:function(BT,BU){if(BT){this._hAlign=BT}if(BU){this._vAlign=BU}if(this.elem&&this.elem.parentNode){A2.call(this)}else{this._showCallbacks.push(A2)}},setBehavior:function(BX,BY){var BU=this;if(isNaN(BX)){BY=BX;BX=0}if(BX){BU._behavior=BX}if(BY){BU._target=BY}BX=BU._behavior;BY=BU._target;var BV=function(){BU.hide()},BT=function(){BU.toggleVisibility()};BU.clearBehavior();if(BX&BH){A9.call(BU,[BY],"click",BT)}if(BX&BN){A9.call(BU,[BY],"contextmenu",BT)}if(BX&BS){BU._hovering=false;A9.call(BU,[BY],"mouseover",function(){if(!BU._hovering){BU._hovering=true;BU.show();BF([BY,BU._body,BU._tag],function(){BU.hide();BU._hovering=false})}})}var BW=function(){if(BX&BA){A9.call(BU,[BU._body,BU._tag],"click",BV)}if(BX&BJ){A9.call(BU,[BU._body,BU._tag],"contextmenu",BV)}if(BX&BC){A7.call(BU)}};if(this.elem){BW()}else{this._showCallbacks.push(BW)}},setContent:function(BV){var BT=this;var BU=function(){if(typeof (BV)==="string"||(BV instanceof String)){BT._content=BV}if(BT._body){BT._body.innerHTML=BT._content}A2.call(BT)};if(this.elem){BU()}else{this._showCallbacks.push(BU)}},setLayer:function(){var BT=arguments;if(this._lazyCallbacks){this._lazyCallbacks.splice(0,0,function(){this.setLayer.apply(this,BT)})}else{BD.setLayer.apply(this,BT);if(this.layer){this.setAlignment()}}},setPosition:A4=function(BU,BT){BD.setPosition.call(this,BU,BT);if(this._behavior&BL){A5.call(this)}},setLocation:A4,show:function(){if(!this._static){if(!this._suspended){if(this._lazyCallbacks){this._lazyCallbacks.push(function(){this.setContent(this._content||this._loc.toString())})}BD.show.apply(this,arguments);this.setPosition()}else{this._unsuspendCallbacks.push(this.show)}}},toggle:function(){if(this.elem&&this._visibility>0&&this._static){this.toggleOut()}else{this.toggleIn()}},toggleIn:function(){this.show();this._static=true},toggleOut:function(){this._static=false;this.hide()},update:function(BT){BD.update.call(this,BT);if(this._behavior&BL&&BT&AS.Widgets.Map.UPDATE_PAN){A5.call(this)}}},{ALIGN_BOTTOM:BQ,ALIGN_LEFT:A3,ALIGN_CENTER:BE,ALIGN_RIGHT:BG,ALIGN_TOP:BR,BALLOON_LEFT_CLICK_HIDE:BA,BALLOON_RIGHT_CLICK_HIDE:BJ,DRAGGABLE:BC,EVENT_UNSUSPEND:BP,REALIGN_TO_VIEWPORT:BL,HOVER_ACTIVE:BS,LEFT_CLICK_TOGGLE:BA|BH,MANUAL_TOGGLE:0,RIGHT_CLICK_TOGGLE:BJ|BN,TARGET_LEFT_CLICK_TOGGLE:BH,TARGET_RIGHT_CLICK_TOGGLE:BN});b(BK,["behavior","behaviour","content","hAlign","skin","vAlign"]);return BK}()})();(function(){c=Ah.BalloonSkin=function(){var A2=AT.DOM.applyStyle,A1=Q.prototype,A3=H(Q,{init:function(A4){if(!A4){A4={}}A1.init.apply(this,arguments);var A5=A4.folder||"";if(A5&&A5.charAt(A5.length-1)!=="/"){A5+="/"}this._images={topRightTag:A5+(A4.topRightTagSrc||"tag-top-right.png"),topLeftTag:A5+(A4.topLeftTagSrc||"tag-top-left.png"),bottomRightTag:A5+(A4.bottomRightTagSrc||"tag-bottom-right.png"),bottomLeftTag:A5+(A4.bottomLeftTagSrc||"tag-bottom-left.png")};this.load();this._tagOverlap=isNaN(A4.tagOverlap)?1:A4.tagOverlap;this._bodyStyle=A4.bodyStyle||{};this._tagAnchorPoint=A4.tagAnchorPoint||new G(0,1)},_bodyStyle:null,_tagAnchorPoint:null,_tagOverlap:1,applyBodyStyle:function(A4){A2(A4,this._bodyStyle)},getTagAnchorPixels:function(A4,A7){var A6=this._sizes.topRightTag;if(!A6){return new G(0,0)}else{var A5=this.getTagAnchorPoint(A4,A7);return new G(A5.x*(A6.width-1),A5.y*(A6.height-1))}},getTagAnchorPoint:function(A4,A7){var A6=Ah.Balloon,A5=new G(this._tagAnchorPoint);if(A4===A6.ALIGN_LEFT){A5.x=1-A5.x}if(A7===A6.ALIGN_BOTTOM){A5.y=1-A5.y}return A5},getTagOverlap:function(){return this._tagOverlap},getTagSize:function(){return new AF(this._sizes.topRightTag)},getTagSrc:function(A5,A9){var A7=Ah.Balloon,A8=(A5===A7.ALIGN_LEFT),A4=(A9===A7.ALIGN_BOTTOM),A6=(A4?"bottom":"top")+(A8?"Left":"Right")+"Tag";return this._images[A6]}});b(A3,["bodyStyle","folder","tagAnchorPoint","tagOverlap","bottomLeftTagSrc","bottomRightTagSrc","topLeftTagSrc","topRightTagSrc"]);return A3}()})();(function(){y=Ah.CanvasLayer=function(){var A3=AT.ZIndices.CANVAS_LAYER,A6=1,A5=1,A1=function(){var A8=this._canvas;if(!A8){return }var BP=this.map,BG=this.getPadding(),BI=BP.getPan(),A9=BP.getSize(),BC=A8.elem,BS=BC.style,BB=A8._offset,BE=new G(BC),BO=BI.x,BR=BE.x,BN=BI.y,BQ=BE.y,BL=BG.width,BM=A9.width,BK=BG.height,BJ=A9.height,A7=BO>=-BR,BA=BN>=-BQ,BF=BO<=-BR-2*BL,BH=BN<=-BQ-2*BK,BD=A7||BF||BA||BH;if(A7){BE.x=BR=BM*AZ(-BO/BM)-BL}if(BA){BE.y=BQ=BJ*AZ(-BN/BJ)-BK}if(BF){BE.x=BR=BM*M(-BO/BM)-BL}if(BH){BE.y=BQ=BJ*M(-BN/BJ)-BK}if(BD){BS.display="none"}BS.left=BR+"px";BS.top=BQ+"px";BB.x=-BR-BO;BB.y=-BQ-BN;return BD},A4=AM.prototype,A2=H(AM,{init:function(A8,A9){if(!A8){A8={}}this._fillColor=A8.fillColor||A8.fillColour||new Z(255,255,255);this._lineColor=A8.lineColor||A8.lineColour||new Z(0,0,0);this._lineWidth=isNaN(A8.lineWidth)?1:A8.lineWidth;if("zIndex" in A8){A8.zIndex=NaN}A4.init.call(this,A8);if(isNaN(A9)){A9=A3}else{A9=+A9;if(A9<=AT.ZIndices.INACTIVE_TILE_TRANSITION||A9>=AT.ZIndices.BALLOON){throw"zIndex has to be greater than 10 and less than 80"}}var A7=this;this.whenVisible(function(){if(!A7._canvas){var BC=A7.getPadding(),BA=A7.getPaddedSize(),BB={id:A7.id+"_canvas",parent:A7.elem,size:BA};A7._canvas=new F(BB,function(BE){var BD=BE.style;BD.position="absolute";BD.left=-BC.width+"px";BD.top=-BC.height+"px";BD.zIndex=A9})}})},_canvas:null,_fillColor:null,_lineWidth:null,_lineColor:null,_draw:function(){},setZIndex:function(A7){if(A7>AT.ZIndices.INACTIVE_TILE_TRANSITION&&A7<AT.ZIndices.BALLOON){this._canvas.elem.style.zIndex=A7}else{throw"zIndex has to be greater than "+AT.ZIndices.INACTIVE_TILE_TRANSITION+" and less than "+AT.ZIndices.BALLOON}},getZIndex:function(){return this._canvas.elem.style.zIndex},_update:function(A8){var A9=this._canvas;if(!A9){return }var A7=A9.elem.style,BA=false;if(A8&U.UPDATE_PAN){BA=A1.call(this)}if(A8&U.UPDATE_ZOOM){A7.display="none";BA=true}if(A8&U.UPDATE_SIZE){A9.setSize(this.getPaddedSize());A1.call(this);BA=true}if(BA){this._draw();A7.display="block"}},destroy:function(){AI(this,"_canvas");A4.destroy.call(this)},getFillColor:function(){var A7=this._fillColor;return(A7?new Z(A7):null)},getLineColor:function(){var A7=this._lineColor;return(A7?new Z(A7):null)},getLineWidth:function(){return this._lineWidth},getPaddedLR:function(){var A9=this._canvas,A7=this.getPaddedSize(),BA=A7.width,A8=A7.height;if(A9){var BB=A9._offset;BA-=BB.x;A8-=BB.y}return new G(BA,A8)},getPaddedSize:function(){var A8=this.map,A7=A8?A8.getSize():new AF();A7.width*=2*A6+1;A7.height*=2*A5+1;return A7},getPaddedUL:function(){var A7=this._canvas,A9=0,A8=0;if(A7){var BA=A7._offset;A9-=BA.x;A8-=BA.y}return new G(A9,A8)},getPadding:function(){var A8=this.map,A7=A8?A8.getSize():new AF();A7.width*=A6;A7.height*=A5;return A7},setFillColor:function(A7){this._fillColor=(A7?new Z(A7):null);this._draw()},setLineColor:function(A7){this._lineColor=(A7?new Z(A7):null);this._draw()},setLineWidth:function(A7){this._lineWidth=A7;this._draw()}},{BUFFERING:new G(A6,A5),define:function(A7){var A8=A2.prototype;var A9=H(A2,{init:function(BA){A8.init.call(this,BA);this.update(U.UPDATE_REDRAW)},_draw:function(){A7.call(this,this._canvas)}});b(A9);return A9}});Ao(A2,["_draw"]);b(A2,["fillColor","fillColour","lineColor","lineColour","lineWidth"]);Ad(A2,["_canvas","_fillColor","_lineColor","_lineWidth"]);return A2}()})();(function(){var A1=Ah.GeoFence=function(){var A4=AT.ZIndices.FENCE,A2=y.prototype,A3=H(y,{init:function(A5){if(!A5){A5={}}if(!("lineColor" in A5)&&!("lineColour" in A5)){A5.lineColor=new Z(0,0,0,0.8)}if(!("fillColor" in A5)&&!("fillColour" in A5)){A5.fillColor=new Z(0,0,0,0.2)}if(isNaN(A5.lineWidth)){A5.lineWidth=1}if(!"zIndex" in A5){A5.zIndex=A4}A2.init.call(this,A5,A5.zIndex)},_draw:null,contains:null});b(A3);Ao(A3,["_draw","contains"]);return A3}();Ah.CircleFence=function(){var A4=D.displace,A3=I.MILES,A5=function(){var A8=this.map,A7=this._center,BE=this._radius,BF=this._units,BA=A4(A7,BE,270,BF),BB=A4(A7,BE,0,BF),A9=A8.getXY(A7),BC=A8.getXY(BA),BD=A8.getXY(BB);return new G(B(A9.x-BC.x),B(A9.y-BD.y))},A2=A1.prototype,A6=H(A1,{init:function(A8){if(!A8){A8={}}A2.init.call(this,A8);var A7=A8.center||A8.centre||null;if(A7){this._center=new AJ(A7)}this._radius=isNaN(A8.radius)?0:A8.radius;this._units=A8.units||A3;this.update(U.UPDATE_REDRAW)},_center:null,_radius:0,_units:A3,_draw:function(){var A7=this._canvas,A9=this._center;if(!A7||isNaN(this._radius)||!A9){return }var BB=this.map.getXY(A9),BA=A5.call(this),A8=this._circle;if(!A8){A8=this._circle=A7.ellipse()}A8.fillColor=this._fillColor;A8.lineColor=this._lineColor;A8.lineWidth=this._lineWidth;A8.center=BB;A8.radiusX=BA.x;A8.radiusY=BA.y;A7.update()},contains:function(BA){var A8=this._center,A7=this._radius,A9=this._units;return A7&&A8&&A9&&BA.distanceTo(A8,A9)<=A7},getCenter:function(){return new AJ(this._center)},getDistance:function(){return this._radius},getUnits:function(){return this._units},setCenter:function(A7){this._center=A7;this.update(AS.Widgets.Map.UPDATE_REDRAW)},setRadius:function(A8,A7){this._units=(A7?A7:A3);this._radius=A8;this.update(AS.Widgets.Map.UPDATE_REDRAW)}});b(A6,["center","centre","radius","units"]);return A6}();Ah.PolygonFence=function(){var A5=F.Util.clipPath,A4=function(BA){var A9=this.getPaddedUL(),A8=this.getPaddedLR(),BB=(new Date()).getTime();A5(BA,A9,A8);this.log("clipping to viewport ("+((new Date()).getTime()-BB)+"ms).")},A2=function(BG){var A8=this._canvas,BE=this._lineColor,BD=this._vertices,BF=this._vertexRadius,BB,A9;if(!BD){BD=this._vertices=[]}for(BB=0,A9=BG.length;BB<A9;BB++){var BC=BD[BB];if(!BC){BC=A8.circle();BC.lineWidth=1}BC.center=BG[BB];BC.radiusX=BF;BC.radiusY=BF;BC.fillColor=BE;BC.lineColor=BE;BD[BB]=BC}for(var BA=BD.length-1;BA>=BB;BA--){BD[BA].destroy();BD.splice(BA,1)}},A7=function(){var BB=this.map;if(!BB){return }var BA=this._points,A8=[];for(var A9=0,BC=BA.length;A9<BC;A9++){A8[A9]=BB.getXY(BA[A9])}return A8},A3=A1.prototype,A6=H(A1,{init:function(A8){if(!A8){A8={}}A3.init.call(this,A8);this._points=A8.points||[];this._vertexRadius=isNaN(A8.vertexRadius)?0:A8.vertexRadius;this.update(AS.Widgets.Map.UPDATE_REDRAW)},_boundingBox:null,_points:null,_vertexRadius:0,_draw:function(){var A8=this._canvas;if(!A8||!this._points){return }var BA=A7.call(this);A4.call(this,BA);var A9=this._polygon;if(!A9){A9=this._polygon=A8.polyline();A9.closed=true}if(this._vertexRadius){A2.call(this,BA)}A9.fillColor=this._fillColor;A9.lineColor=this._lineColor;A9.lineWidth=this._lineWidth;A9.points=BA;A8.update()},appendPoint:function(A9){this._points.push(A9);var A8=this._boundingBox;if(!A8){A8=this._boundingBox=new AR()}A8.add(A9);this.update(AS.Widgets.Map.UPDATE_REDRAW)},contains:function(BE){var BA=this._boundingBox,BK=this._points;if(!BA||!BK){return false}var BJ=BK.length;if(BJ<=2||!BA.contains(BE)){return false}var BH=0,BG=null,BC=BK[0],BI=BE.lat,A8=BE.lon;for(var BB=0;BB<BJ;BB++){BG=BC;BC=BK[(BB+1)%BJ];var BD=BG.lat,BF=BC.lat,BL=BG.lon,BM=BC.lon;if(BD===BI&&BL===A8){return false}if((BD<=BI&&BF>BI)||(BD>BI&&BF<=BI)){var A9=(BI-BD)/(BF-BD);if(A8<BL+A9*(BM-BL)){BH++}}}return(BH%2)===1},getPoints:function(){return this._points.slice()},snapToStreets:function(A9,A8){P.invoke(P.GEOFENCE_PAGE,"SnapToStreets",this,A9,A8)}});b(A6,["points","vertexRadius"]);j(A6,"GeoFence.PolygonFence");Ad(A6,["_vertexRadius","_vertices"]);Aw(A6,[["_boundingBox","boundingBox"],["_points","points"]]);m(A6,function(A8){this._points=A8._points;this._boundingBox=A8._boundingBox;this.update(U.UPDATE_REDRAW)});return A6}();Ah.FenceCollection=function(){var A3=AX.prototype,A2=H(AX,{init:function(A4){A3.init.call(this,A4)},contains:function(A6){var A5=this._layers;for(var A4=0,A7=A5.length;A4<A7;A4++){if(A5[A4].contains(A6)){return true}}return false}});b(A2);j(A2,"GeoFence.GeoFenceCollection");m(A2,function(A4){var A5=A4._items;if(!A5){return }for(var A6=0,A7=A5.length;A6<A7;A6++){this._layers[A6]=A5[A6]}});return A2}()})();(function(){Ae=Ah.ImageObject=function(){var A2=AT.DOM.enableTranslucency,A1=p.prototype,A3=H(p,{init:function(A5,A6){var A4=this;if(!A5){A5={}}if("scalable" in A5){this._scalable=A5.scalable}A1.init.call(this,A5,function(A7){if(A4._scalable){A4._img=AQ("img",A7,A4.id+"_image",function(A9){A9.style.position="absolute";A9.style.height="100%";A9.style.width="100%";A2(A9)})}else{A7.style.backgroundRepeat="no-repeat"}var A8=A5.image||A5.src||"";if(A8){A4.setImage(A8)}if(A6){A6(A7)}})},_img:null,_scalable:true,attach:function(A4){if(!this._size.width&&!this._size.height){this._pendingAttach=A4}else{Am.prototype.attach.apply(this,arguments)}},destroy:function(){if(this._img){delete this._img}A1.destroy.call(this)},getImage:function(){if(this._scalable){return this._img.src}else{var A4=this.elem.style.backgroundImage;return A4.substr(4,A4.length-5)}},setAnchorPoint:function(A5,A4){A1.setAnchorPoint.call(this,A5,A4);A5=this._anchorPoint;if(this.elem&&A5&&!this._scalable){this.elem.style.backgroundPosition=(A5.x*100)+"% "+(A5.y*100)+"%"}},setImage:function(A5){if(!this.elem){return }if(A5){if(this._scalable){if(!this._img){return }this._img.src=A5}else{this.elem.style.backgroundImage="url("+A5+")"}}if(!this._size.width&&!this._size.height){var A4=this;Af(A5||this.getImage(),function(A6){A4.setSize(A6);if(A4._pendingAttach){A4.attach(A4._pendingAttach);delete A4._pendingAttach}})}}},{preloadImages:function(A7,A9){var A6=0,A5=A7.length,A4=function(){if(++A6>=A5){A9()}};for(var A8=0;A8<A5;A8++){Af(A7[A8],A4)}}});b(A3,["image","src","scalable"]);return A3}()})();(function(){L=Ah.IndexedImageObject=function(){var A3=AT.DOM.applyStyle,A2=Ae.prototype,A1=H(Ae,{_indexElem:null,init:function(A5){var A4=this;if(!A5){A5={}}if("scalable" in A5){this._scalable=A5.scalable}A2.init.call(this,A5,function(A6){var A8=A5.indexOffset||new G(0,0),A7=Y(A5.indexStyle,{backgroundColor:"#ffffff",fontSize:"10px",fontWeight:"bold"});if(A4._scalable){A4._indexElem=AQ("div",A6,A4.id+"_index",function(A9){A3(A9,Y(A7,{padding:"0px 1px 0px 1px",bottom:-A8.y+"px",position:"absolute",right:-A8.x+"px"}))})}else{A4._indexElem=A6;A3(A6,Y(A7,{textAlign:"right",verticalAlign:"bottom",display:"inline"}))}});this.setIndex(A5.index||0)},destroy:function(){AI(this,"_indexElem");A2.destroy.call(this)},getIndex:function(){return this._index},setIndex:function(A4){this._index=A4;this._indexElem.innerHTML=A4}});b(A1,["index","indexOffset","indexStyle"]);return A1}()})();(function(){AO=Ah.DivObject=function(){var A1=p.prototype,A2=H(p,{init:function(A4,A5){var A3=this;if(!A4){A4={}}if(!("size" in A4)){A4.size=new AF(1,1)}if(!("innerHTML" in A4)){A4.innerHTML=""}A1.init.call(this,A4,function(A6){A3.setInnerHTML(A4.innerHTML);if(A5){A5(A6)}})},destroy:function(){A1.destroy.call(this)},setInnerHTML:function(A3){this.elem.innerHTML=A3}});b(A2,["innerHTML"]);return A2}()})();(function(){AN=Ah.ObjectLayer=function(){var A2=AT.ZIndices.OBJECT,A3=AM.prototype,A1=H(AM,{init:function(A4){if(!A4){A4={}}if(!("managed" in A4)||A4.managed){this._rtree=new S()}if(!("zIndex" in A4)){A4.zIndex=A2}A3.init.call(this,A4)},_addObject:function(A4,A5){if(!(A4 instanceof p)){throw new O("Only AbstractObject instances can be added to an ObjectLayer.")}if(this._rtree&&!A4._unmanaged){this._rtree.insert(A4,A5)}this[A4.id]=A4;if(this.elem){A4.attach(this.elem)}if(this._suspendState===0){this._update(U.UPDATE_PAN)}else{if(this._suspendState<0){this._suspendState=U.UPDATE_PAN}}},_moveObject:function(A4,A6,A5){if(this._rtree&&!A4._unmanaged){this._rtree.remove(A4,A6);this._rtree.insert(A4,A5)}},_removeObject:function(A4,A5){if(this._rtree&&!A4._unmanaged){this._rtree.remove(A4,A5)}delete this[A4.id];A4.detach()},_update:function(A7){var BB=this.map;if(!BB){return }if(this._rtree){var A6=BB.getLatLon(new G(0,0)),BA=BB.getLatLon(new G(BB.getSize())),A5=this.elem,A4=function(BC){BC.detach();if(BC._balloon&&BC._balloon._unmanaged){A4(BC._balloon)}},A9=function(BC){if(BC.elem){if(BC.elem.parentNode==null||BC.elem.parentNode.attributes==null){BC.update(A7|U.UPDATE_ZOOM);BC.attach(A5)}else{BC.update(A7)}}if(BC._balloon&&BC._balloon._unmanaged){A9(BC._balloon)}};if(A7&U.UPDATE_ZOOM||A7&U.UPDATE_SIZE){this._rtree.queryAll(A4)}if(A6.lon>BA.lon){this._rtree.query(new k(A6,new AJ(BA.lat,180)),A9);this._rtree.query(new k(new AJ(A6.lat,-180),BA),A9)}else{this._rtree.query(new k(A6,BA),A9)}}else{for(var A8 in this){if(this[A8] instanceof p){this[A8].update(A7)}}}},startBulkAdd:function(){this.suspend();this.hide()},endBulkAdd:function(){this.show();this.unsuspend()},clear:function(){if(this._rtree){this._rtree.queryAll(function(A5){A5.setLayer(null)})}else{for(var A4 in this){if(this[A4] instanceof p){this[A4].setLayer(null)}}}},destroy:function(){this.clear();if(this._rtree){delete this._rtree}A3.destroy.call(this)}});b(A1,["managed"]);return A1}()})();(function(){r=Ah.RegionShadeLayer=function(){var A5=AT.DOM,A6=A5.bordersOutside,A2=A5.setOpacity,A1=AT.ZIndices.REGION,A7=function(){var BP=this._shade,BJ=this._border,BM=this.map;if(!BM||!BJ||!BP){return }var BK=this._color,BG=BK.toCSSHex(),BO=this._borderWidth,BB=A6()?2*BO:0,BN=BM.getOrigin(),BE=BM.getXY(this._nw),BD=BM.getXY(this._se),BA=BE.x,BC=BE.y,BH=BA-BN.x+"px",A8=BC-BN.y+"px",BI=BD.x-BA,BF=BD.y-BC,BL=BP.style,A9=BJ.style;BL.backgroundColor=BG;BL.left=BH;BL.top=A8;BL.width=BI+BB+"px";BL.height=BF+BB+"px";A2(BP,BK.a);A9.border=BO+"px "+this._borderType+" "+BG;A9.left=BH;A9.top=A8;A9.width=Ac(0,BI)+"px";A9.height=Ac(0,BF)+"px"},A3=AM.prototype,A4=H(AM,{init:function(BA){if(!BA){BA={}}this._nw=BA.nw||new AJ();this._se=BA.se||new AJ();this._color=BA.color||BA.colour||new Z(0,0,0,0.2);this._borderWidth=isNaN(BA.borderWidth)?1:BA.borderWidth;this._borderType=BA.borderType||"solid";var A9=this;if(!("zIndex" in BA)){BA.zIndex=A1}A3.init.call(this,BA,function(BB){var BC=A9.id;A9._border=AQ("div",BB,BC+"_border",function(BE){var BD=BE.style;BD.backgroundColor="transparent";BD.fontSize="0px";BD.position="absolute"});A9._shade=AQ("div",BB,BC+"_shade",function(BD){var BE=BD.style;BE.fontSize="0px";BE.position="absolute"})});var A8=BA.viewport;if(A8){this.setCorners(A8)}else{this.setCorners()}},_borderType:"solid",_borderWidth:1,_color:null,_nw:null,_se:null,_update:function(A8){if(A8&U.UPDATE_ZOOM||A8&U.UPDATE_SIZE){this.setCorners()}},destroy:function(){AI(this,"_border");AI(this,"_shade");A3.destroy.call(this)},setCorners:function(A8,A9){if(typeof (A8)!=="undefined"){if(A8 instanceof U){var BA=A8.getSize();this._nw=A8.getLatLon(new G(0,0));this._se=A8.getLatLon(new G(BA))}else{if(typeof (A9)!=="undefined"){this._nw=new AJ(A8);this._se=new AJ(A9)}}}A7.call(this)},setMap:function(A8){A3.setMap.call(this,A8);A7.call(this)}});b(A4,["borderType","borderWidth","color","colour","nw","se","viewport"]);return A4}()})();(function(){Ah.RouteLayer=function(){var A9=F.COMMAND_LINE,A1=F.COMMAND_MOVE,A2=F.Util,A5=A2.clipPath,BB=A2.reducePath,A7=A2.splitPath,A4=AT.ZIndices.PATH,A8=function(){var BF=this.map,BE=this._points;if(!BF||!BE){return }var BD=[];for(var BC=0,BG=BE.length;BC<BG;BC++){BD[BC]=BF.getXY(BE[BC])}return BD},A6=function(BF){var BH=this.map;if(!BH){return }var BE=this.getPaddedUL(),BD=this.getPaddedLR(),BC=BF.length,BJ=(new Date()).getTime();A5(BF,BE,BD,false);var BI=BF.length;this.log("clipping from "+BC+" to "+BI+" points ("+((new Date()).getTime()-BJ)+"ms).");BJ=(new Date()).getTime();BB(BF,AD(this._renderDetail,BI)/BI);var BG=A7(BF,BE,BD);this.log("simplifying from "+BI+" to "+BF.length+" points ("+((new Date()).getTime()-BJ)+"ms).");return BG},A3=y.prototype,BA=H(y,{init:function(BC){if(!BC){BC={}}if(!("lineColor" in BC)&&!("lineColour" in BC)){BC.lineColor=new Z(0,0,128,0.5)}if(isNaN(BC.lineWidth)){BC.lineWidth=8}if(!"zIndex" in BC){BC.zIndex=A4}A3.init.call(this,BC,BC.zIndex);if(!isNaN(BC.renderDetail)){this._renderDetail=BC.renderDetail}var BD=BC.points;if(!BD){var BE=BC.directions;if(BE){BD=BE.getPoints()}else{BD=[]}}this.setPoints(BD)},_points:null,_bbox:null,_renderDetail:256,_draw:function(){var BE=this._canvas;if(!BE||!this._points){return }var BK=A8.call(this),BI=A6.call(this,BK);var BL=this._path;if(!BL){BL=this._path=BE.path();BL.fillColor=null}var BF=[];for(var BH=0,BC=BI.length;BH<BC;BH++){var BJ=BI[BH];BF.push([A1,BJ[0]]);for(var BG=1,BD=BJ.length;BG<BD;BG++){BF.push([A9,BJ[BG]])}}BL.lineColor=this._lineColor;BL.lineWidth=this._lineWidth;BL.commands=BF;BE.update()},show:function(){A3.show.apply(this,arguments);this._draw()},setPoints:function(BD){var BE=[];this._bbox=new Telogis.GeoBase.BoundingBox(BD[0],BD[0]);for(var BC=0,BF=BD.length;BC<BF;BC++){this._bbox.add(BD[BC]);BE[BC]=new AJ(BD[BC])}this._points=BE;this.update(U.UPDATE_REDRAW)},shouldHandleEvent:function(BG){if(!this._bbox){return false}if(!this._bbox.contains(this.map.mouseLatLon(BG))){return false}function BC(BK,BM,BJ,BL){return Math.sqrt((BJ-=BK)*BJ+(BL-=BM)*BL)}function BF(BM,BT,BL,BS,BK,BQ,BP){var BR=(BK-BM)*(BL-BM)+(BQ-BT)*(BS-BT);var BJ=(BL-BM)*(BL-BM)+(BS-BT)*(BS-BT);if(BJ==0){return false}var BU=BR/BJ;if(BU<0||BU>1){return false}var BO=BM+BU*(BL-BM);var BN=BT+BU*(BS-BT);return BC(BK,BQ,BO,BN)<BP}var BE=this.map.mouseXY(BG);for(var BD=0;BD<this._points.length-1;BD++){var BI=this.map.getXY(this._points[BD]),BH=this.map.getXY(this._points[BD+1]);if(BF(BI.x,BI.y,BH.x,BH.y,BE.x,BE.y,6)){return true}}return false}});b(BA,["directions","points","renderDetail"]);return BA}()})();(function(){Ak=Ah.Tile=function(){var BC=AT.DOM,BA=BC.applyStyle,BD=BC.makeInert,A5=P.whenRegistered,BE=2000,A9=3,A3=null,A4=function(){if(this._errorCallback){this._errorCallback()}this._loadCallback=null;this._errorCallback=null;if(this.Error){this.Error.trigger()}},A8=function(){this._isLoaded=true;if(this._loadCallback){this._loadCallback()}this._loadCallback=null;this._errorCallback=null;if(this.Load){this.Load.trigger()}},A2=function(){return A3||AT.serviceURLs},A7=function(){if(!this._isActive){return }if(this._reloadAttempts>0){var BG=this,BH=0;this._reloadAttempts--;var BF=M((A9-this._reloadAttempts)/A2().length);if(BF>0){BH=t(2,BF-1)*BE}this._reloadID=setTimeout(function(){BG.load()},BH)}else{E.warn("failed to load tile at "+this._coords+".");A4.call(this)}},A6=function(){if(!this._isActive){return }this._img.style.display="block";A8.call(this)},A1=function(BH,BI,BG){var BF=this;return AQ("img",BH,null,function(BK){var BJ=BK.style,BL=BI.getTileSize();BK.setAttribute("galleryimg","no");var BM=BG;if(typeof (BM)==="object"){BA(BK,BM)}BJ.display="none";BJ.position="absolute";BJ.width=BL+"px";BJ.height=BL+"px";BD(BK);BK.onerror=BK.onabort=function(){A7.call(BF)};BK.onload=function(){A6.call(BF)}})},BB=g({init:function(BG){if(!BG){BG={}}var BI=function(BM){throw new x('no valid "'+BM+'" configuration property found for tile.')},BL=BG.map,BJ=BG.parent;if(!BL){BI("map")}if(!BJ){BI("parent")}this.Load=new C();this.Error=new C();var BF=BG.args||{};if("satellite" in BG){if(BG.satellite){BF.satellite="on"}else{if(BF.satellite){delete BF.satellite}}}var BK="";for(var BH in BF){if(BF.hasOwnProperty(BH)){BK+="&"+BH+"="+BF[BH]}}this._args=BK;this._serverPage=BG.serverPage||BB.MAP_SERVER_PAGE;this._map=BL;this._img=A1.call(this,BJ,BL,BG.style)},_args:"",_img:null,_isActive:false,_isLoaded:false,_map:null,_reloadAttempts:A9,_reloadID:0,_serverPage:"",_coords:null,Load:null,Error:null,destroy:function(){var BF=this._img;BF.onload=null;BF.onerror=null;BF.onabort=null;AI(this,"_img");A(this)},load:function(BH,BN,BO){var BM=this._img,BS=this._coords;if(!BM||!BS){return }this._loadCallback=BN;this._errorCallback=BO;if(BH){this._map=BH}BH=this._map;this._isActive=true;this._isLoaded=false;var BI=BS.x,BU=BS.y,BL=BH.getZoomLevel();if(BU<-2*BL||BU>=2*BL){BM.style.display="none";A8.call(this)}else{var BR=this._args,BK=this._reloadAttempts,BJ=BH.getTilesPerSuperTile(),BQ=BJ*BL,BG=((BQ/2+BI)*(BQ+1)+(BQ/2+BU)),BT=A2(),BP=(BG+BK)%BT.length;var BF=BT[BP]+this._serverPage;BF+="t="+BI+","+BU+","+BH.getTileSize()+","+BJ+","+BL;BF+=AP();if(BR){BF+=BR}if(BK<A9){BF+="&r="+BK}BM.style.display="none";A5(function(){BM.src=BF})}},isActive:function(){return this._isActive},isLoaded:function(){return this._isLoaded},setCoords:function(BH){var BG=this._coords,BF=this._reloadID;if(!BG||(BH.x!==BG.x||BH.y!==BG.y)){this._reloadAttempts=A9}if(BF){clearTimeout(BF);this._reloadID=0}if(!this._coords){this._coords=BG=new G()}BG.x=BH.x;BG.y=BH.y;this.unload()},setPosition:function(BG){var BF=this._img.style;BF.top=BG.y+"px";BF.left=BG.x+"px"},unload:function(){this._isActive=false;this._img.style.display="none"}},{BASE_RELOAD_WAIT:BE,MAP_SERVER_PAGE:"tile.aspx?",RELOAD_ATTEMPTS:A9,setService:function(BF){A3=AT.getServiceSet(BF)}});b(BB,["args","map","parent","satellite","serverPage","style"]);return BB}()})();(function(){a=Ah.TileLayer=function(){var A5=E.warn,A3=function(){if(this._tiles){AI(this,"_tiles")}},A4=function(){var A6=this._tileConfig;A6.parent=this.elem;A6.map=this.map;return new Ak(A6)},A2=AT.ZIndices.TILE,A1=AM.prototype;a=H(AM,{init:function(A6){if(!A6){A6={}}this.expirySecs=A6.expirySecs||null;this._updateHook=A6.updateHook||null;this._tileConfig=A6.tileConfig||{};this.reconfigureTiles();this._buffering=A6.buffering||new G();this._tiles=[];this.Load=new C();if(!("zIndex" in A6)){A6.zIndex=A2}A1.init.call(this,A6);var A7=("zoomTransition" in A6)?A6.zoomTransition:null;if(A7&&!A6.transitionConfig){A6.transitionConfig={}}else{if(A7===false){A6.transitionConfig=null}}if(A6.transitionConfig){Ah.TileZoom.setup(this,A6.transitionConfig||{})}this._refreshLoop()},_buffering:null,_lastStartRow:0,_lastStartCol:0,_tileConfig:null,_tiles:null,Load:null,_timeoutHandle:null,expirySecs:null,_updateHook:null,_refreshLoop:function(){if(!this.expirySecs){return }if(this._timeoutHandle){clearTimeout(this._timeoutHandle);this._timeoutHandle=null;this.reconfigureTiles()}if(!this._timeoutHandle){this.setExpiry(this.expirySecs)}},setExpiry:function(A6){var A7=this;if(A7._timeoutHandle){clearTimeout(A7._timeoutHandle)}A7.expirySecs=A6;A7._timeoutHandle=setTimeout(function(){A7._refreshLoop()},A7.expirySecs*1000)},_update:function(BC){var BE=this,BL=this.map,BT=this._tiles,BW=BC&U.UPDATE_SIZE,BO=BL.getPan(),BX=BL.getSize(),Bf=this._buffering,Bc=Bf.x,Bb=Bf.y,Bh=BX.width+2*Bc,A6=BX.height+2*Bb,BV=BO.x+Bc,BU=BO.y+Bb;BL._size=new AF(Bh,A6);var Bd=BL.getTileCoords(0,0),Bj=BL.getTileOffset(),BJ=BL.getTileSize(),BI=BL.getColCount(),BF=BL.getRowCount(),BR=BL.getStartCol(),Be=BL.getStartRow(),BZ=Bj.x-Bc,BY=Bj.y-Bb,BK=Bd.x,BQ=Bd.y;BL._size=BX;var BG=[];for(var Bi=0;Bi<BI*BF;Bi++){BG[Bi]=1}var BS=function(Bn,Bo){return function(){BG[Bn*BF+Bo]=0;if(+BG.join("")===0){BE.log("finished (re-)loading tiles.");BE.Load.trigger()}}},BM=function(Bn,Bo){return new G(BK+BR+Bn,BQ+Be+Bo)},A8=function(Bn,Bo){return new G(BZ+(BR+Bn)*BJ,BY+(Be+Bo)*BJ)},Ba=function(Bn){var Bp=Bn.x+BV,Bo=Bn.y+BU;return(Bp>=-BJ&&Bp<Bh&&Bo>=-BJ&&Bo<A6)},BP=function(){A3.call(BE);BT=[];for(var Bn=0;Bn<BI;Bn++){var Bo=(BT[Bn]=[]);for(var Bp=0;Bp<BF;Bp++){Bo[Bp]=A4.call(BE)}}BE._tiles=BT},Bm=function(){BE.log("(re-)loading tiles...");for(var Bn=0;Bn<BI;Bn++){for(var Bp=0;Bp<BF;Bp++){var Bo=BT[Bn][Bp];if(!Bo){A5("null tile encountered at ("+Bn+", "+Bp+").")}else{var Br=A8(Bn,Bp),Bq=BS(Bn,Bp);Bo.setCoords(BM(Bn,Bp));Bo.setPosition(Br);if(Ba(Br)){Bo.load(BL,Bq)}else{Bq()}}}}},Bl=function(Br,Bq){var Bn=BT;BT=[];for(var Bo=0;Bo<BI;Bo++){BT[Bo]=[];for(var Bv=0;Bv<BF;Bv++){var Bs,Bu=BS(Bo,Bv),Bt=A8(Bo,Bv),Bp=Ba(Bt);if((-Br<=Bo&&Bo+Br<BI)&&(-Bq<=Bv&&Bv+Bq<BF)){Bs=Bn[Bo+Br][Bv+Bq];if(!Bp||Bs.isLoaded()){Bu()}else{Bs._loadCallback=Bu}}else{Bs=Bn[BI-1-Bo][BF-1-Bv];Bs.setCoords(BM(Bo,Bv));Bs.setPosition(Bt);if(!Bp){Bu()}else{Bs.load(BL,Bu)}}BT[Bo][Bv]=Bs}}BE._tiles=BT};if(BW){BP()}if(BC&U.UPDATE_ZOOM||BW){Bm();this._lastStartRow=Be;this._lastStartCol=BR}else{var BD,BH,Bg=[],BA=0;for(BD=0;BD<BI;BD++){Bg[BD]=[];for(BH=0;BH<BF;BH++){Bg[BD][BH]=!BT[BD][BH].isActive()&&Ba(A8(BD,BH));if(Bg[BD][BH]){BA++}}}var A7=BR-this._lastStartCol,Bk=Be-this._lastStartRow;if(BA){if(!A7&&!Bk){for(BD=0;BD<BI;BD++){for(BH=0;BH<BF;BH++){var BB=BT[BD][BH],BN=BB.isLoaded(),A9=false;if(!Bg[BD][BH]){if(BN){A9=true}else{BB._loadCallback=BS(BD,BH)}}BG[BD*BF+BH]=A9?0:1}}}for(BD=0;BD<BI;BD++){for(BH=0;BH<BF;BH++){if(Bg[BD][BH]){BT[BD][BH].load(BL,BS(BD,BH))}}}}if(A7||Bk){Bl(A7,Bk)}this._lastStartRow=Be;this._lastStartCol=BR;this.Update.trigger(BC)}},destroy:function(){A3.call(this);A1.destroy.call(this)},reconfigureTiles:function(A7){var A6=this;if(!A6._tileConfig.args){A6._tileConfig.args={}}Y(A7||{},A6._tileConfig);var A8=function(A9){if(A6.expirySecs){Y({timeStamp:new Date().getTime()},A6._tileConfig.args)}if(A9){if(A9.args){Y(A9.args,A6._tileConfig.args);Y(A6._tileConfig.args,A9.args)}Y(A9,A6._tileConfig)}if(A6._tiles){A6.update(U.UPDATE_SIZE)}};if(A6._updateHook){A6._updateHook(A8)}else{A8({})}}});b(a,["buffering","tileConfig","transitionConfig","zoomTransition","expirySecs","updateHook"]);return a}()})();(function(){Au=Ah.TrafficLayer=function(){var A3,A2=a.prototype,A1=H(a,{init:function(A4){if(!A4.tileConfig){A4.tileConfig={}}if(!A4.tileConfig.args){A4.tileConfig.args={}}this.source=A4.source;A4.tileConfig.args.source=this.source;if(!A4.time||A4.time==A3){this.time=A3;if(!A4.expirySecs){A4.expirySecs=10}A4.tileConfig.args.time=(new Date().toUTCString())}else{this.time=A4.time;A4.tileConfig.args.time=this.time}if(!A4.tileConfig.serverPage){A4.tileConfig.serverPage="trafficoverlay.aspx?"}A4.updateHook=this._trafficUpdateHook;A2.init.call(this,A4)},_time:null,_source:null,reconfigureTraffic:function(A4){this.source=A4.source;if(!A4.time||A4.time==A3){this.time=A3}else{this.time=A4.time}this.reconfigureTiles({})},_trafficUpdateHook:function(A5){var A4=this;if(A4.time==A3){P.invoke(P.TRAFFIC_PAGE,"GetLatestTraffic",[A4.source],function(A6){A4.setExpiry(A6[1]);A5({"args":{"time":A6[0],"source":A4.source}})},function(A6){A4.setExpiry(10)},5*60*1000)}else{A5({"args":{"time":A4.time,"source":A4.source}})}}},{REAL_TIME:A3="realtime"});b(A1,["time","source"]);return A1}()})();(function(){var A1=AT.ZIndices;AA=Ah.TileZoom=function(){var A4=A1.ACTIVE_TILE_TRANSITION,A2=A1.INACTIVE_TILE_TRANSITION,A3=AM.prototype,A5=H(AM,{init:function(A6){if(!A6){A6={}}A3.init.call(this,A6);this.Done=new C();this._origin=new G();this._tileDiv=AQ("div",this.elem,this.id+"_tiles",function(A7){A7.style.position="absolute";A7.onmousedown=A7.ondragstart=A7.oncontextmenu=AW});this._duration=A6.duration||0;this._stepCount=isNaN(A6.stepCount)?1:A6.stepCount;this._tileLayer=A6.tileLayer||null},_active:false,_duration:0,_origin:null,_size:0,_stepCount:1,_tileDiv:null,_tileLayer:null,Done:null,clear:function(){if(this._tileDiv){var A7=this._tileDiv.childNodes;for(var A6=A7.length-1;A6>=0;A6--){T(A7[A6])}}},run:function(BK,BJ){var A9=this._tileLayer;if(!A9){return }var BM=this,A6=this.map,BB=this._duration,BC=this._stepCount,BF=this._tileDiv,A8=BF.style,BI=A6._lastPan,BG=BI.x,BE=BI.y,BL=A6.getTileSize(),BA=BL*BK,BH=this._origin=BJ?new G(BJ):A6.getCenterXY();BH.x-=BG;BH.y-=BE;this._size=BL;BF.innerHTML=A9.elem.innerHTML;A8.left=BG+"px";A8.top=BE+"px";A8.zIndex=A4;this._active=true;this.show();A9.hideCumulative();var A7=(new Date()).getTime();var BD=setInterval(function(){var BP=(new Date()).getTime()-A7,BO=A0(BL+(BA-BL)*BP/BB),BN=false;if((BO>=BA&&BK>1)||(BO<=BA&&BK<1)){BN=true;BO=BA}BM.setSize(BO);if(BN){clearInterval(BD);A8.zIndex=A2;BM._active=false;A9.showCumulative();BM.Done.trigger()}},BB/BC)},destroy:function(){this.clear();AI(this,"_tileDiv");AI(this,"Done");A3.destroy.call(this)},isActive:function(){return this._active},setSize:function(BF){var BB=this._size;if(!BF){BF=this._size}this._size=BF;var A6=this._tileDiv.childNodes,BC=this._origin,BE=BC.x,BD=BC.y;for(var A8=0,A7=A6.length;A8<A7;A8++){var BA=A6[A8].style,A9=BF/BB;BA.left=A0((parseInt(BA.left)-BE)*A9+BE)+"px";BA.top=A0((parseInt(BA.top)-BD)*A9+BD)+"px";BA.width=BF+"px";BA.height=BF+"px";BA.zIndex=""}}},{setup:function(BB,A7){var BA;A7.tileLayer=BB;if(!("silent" in A7)){A7.silent=BB._silent}if(!("id" in A7)){A7.id=BB.id+"_transition"}var A6=function(BD){var BE=BB.map,BF=BE.getZoomLevel()/BE.getLastZoomLevel();if(BF!==1&&0.25<=BF&&BF<=4&&BB.getVisibility()>=0){BA.run(BF,BD)}};var A9=function(){var BD=function(){BA.hide();BA.clear()};if(BA.isActive()){BA.Done.appendOnce(BD)}else{BD()}};var BC=function(){A7.map=BB.map;BA=new A5(A7);BA.hide();BB.map.PreZoom.append(A6)};var A8=function(){if(BA.map){BA.map.Zoom.remove(A6)}BA.destroy()};BB.Load.append(A9);if(BB.map){BC()}BB.Added.append(BC);BB.Removed.append(A8)}});b(A5,["duration","stepCount","tileLayer"]);return A5}()})();(function(){var A1=AT.HTTPClient;u=Ah.XSLTObjectLayer=function(){var BB=AT.ZIndices.OBJECT,A5,A3=function(BC){return'@id="'+BC.getAttribute("id")+'"'},A6=function(){var BD=function(BE,BF){return'<xsl:param name="'+BE+'">'+BF+"</xsl:param>"},BC=function(BE){return"$LAT_XPATH &gt; $"+BE+"MinLat and $LAT_XPATH &lt; $"+BE+"MaxLat and $LON_XPATH &gt; $"+BE+"MinLon and $LON_XPATH &lt; $"+BE+"MaxLon"};return'<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"><xsl:output method="text" />'+BD("queryMinLat",-90)+BD("queryMaxLat",90)+BD("queryMinLon",-180)+BD("queryMaxLon",180)+BD("vpMinLat",-90)+BD("vpMaxLat",90)+BD("vpMinLon",-180)+BD("vpMaxLon",180)+'<xsl:template match="/">var GeoBase=Telogis.GeoBase,LatLon=GeoBase.LatLon,MapLayers=GeoBase.MapLayers,Balloon=MapLayers.Balloon,layer=MapLayers["$ID"],anchor=layer._anchorPoint,balloonCfg=layer._balloonConfig,balloonContentFunc=layer._balloonContentFunc,imgSrcFunc=layer._imgSrcFunc,size=layer._size,origin=layer.map.getOrigin(),offsetX=-origin.x-anchor.x*(size.width-1),offsetY=-origin.y-anchor.y*(size.height-1),objects=layer._objects,processed=layer._processed;<xsl:apply-templates select="//$OBJ_TAG_NAME['+BC("query")+' and ($QUERY_FILTERS)]"></xsl:apply-templates></xsl:template><xsl:template match="$OBJ_TAG_NAME">var id,loc,pos,data={loc:loc=new LatLon(+"<xsl:value-of select="$LAT_XPATH"/>",+"<xsl:value-of select="$LON_XPATH"/>"),pos:pos=layer.map.getXY(loc),id:(loc.lat+"_"+loc.lon).replace (".","_"),src:"$IMG_SRC"};$ED_INSTRUCTIONSid="$ID_"+data.id;processed[id]=true;<xsl:choose><xsl:when test="'+BC("vp")+'">var img=document.getElementById(id),style;if(!img)img=layer._createObject(id);img.src=imgSrcFunc(data);style=img.style;style.left=(pos.x+offsetX)+"px";style.top=(pos.y+offsetY)+"px";USE_BALLOON?var obj=objects[id],balloon=obj.balloon;if(!balloon){var cfg=balloonCfg;cfg.id=id+"_balloon";obj.balloon=balloon=new Balloon(cfg);balloon.setBehavior(img);}balloon.setContent(balloonContentFunc(data));balloon.setLocation(data.loc);?USE_BALLOON</xsl:when><xsl:otherwise>layer._deleteObject(id);</xsl:otherwise></xsl:choose></xsl:template></xsl:stylesheet>'}(),A9=function(){this.elem.innerHTML="";var BC=this._objects;for(var BD in BC){if(BC.hasOwnProperty(BD)){this._deleteObject(BD)}}},A8=function(BF,BD){var BC="";for(var BE in BF){if(BF.hasOwnProperty(BE)){var BG=BF[BE];if(typeof (BG)==="string"||(BG instanceof String)){BC+=BD+"."+BE+'="<xsl:value-of select="'+BG+'"/>";'}}}return BC},A2=function(BD){if(typeof (BD)!=="object"){BD={}}var BJ=this._config,BE=BJ.extraData=(BD.extraData||BJ.extraData),BL=BJ.imgSrc=(BD.imgSrc||BD.imgPath||BJ.imgSrc),BH=BJ.imgXPath=(BD.imgXPath||BJ.imgXPath),BI=BJ.latXPath=(BD.latXPath||BJ.latXPath),BG=BJ.lonXPath=(BD.lonXPath||BJ.lonXPath),BK=BJ.objTagName=(BD.objTagName||BJ.objTagName),BF=BJ.queryFilters=(BD.queryFilters||BJ.queryFilters),BM=A8(BE,"data");var BC=A6;if(this._balloonConfig){BC=BC.replace(/USE_BALLOON\?/g,"").replace(/\?USE_BALLOON/g,"")}else{BC=BC.replace(/USE_BALLOON\?.*?\?USE_BALLOON/g,"")}BC=BC.replace(/\$ID/g,this.id);BC=BC.replace(/\$QUERY_FILTERS/g,BF);BC=BC.replace(/\$IMG_SRC/g,BL||('<xsl:value-of select="'+BH+'" />'));BC=BC.replace(/\$ED_INSTRUCTIONS/g,BM);BC=BC.replace(/\$LAT_XPATH/g,BI);BC=BC.replace(/\$LON_XPATH/g,BG);BC=BC.replace(/\$OBJ_TAG_NAME/g,BK);this._objTagName=BK;this._xslt=new AC(BC)},BA=function(){var BK=this,BL=this.map.getSize(),BI=this._size.width/2,BF=this._size.height/2,BJ=this.map.getLatLon(new G(-BI,BL.height-1+BF)),BD=this.map.getLatLon(new G(BI+BL.width-1,-BF)),BC=new AJ((BD.lat-BJ.lat)/this._cellCount.y,(BD.lon-BJ.lon)/this._cellCount.x);this._processed={};clearTimeout(this._loadID);var BE=function(){var BM=BK._objects,BO=BK._processed;for(var BN in BM){if(BM.hasOwnProperty(BN)&&!BO[BN]){BK._deleteObject(BN)}}BK.Load.trigger()};var BG={};var BH=function(BM){var BN=BM.lat+"_"+BM.lon;if(BM.lat>BD.lat){BE()}else{if(BM.lon>BD.lon){return BH(new AJ(BM.lat+BC.lat,BJ.lon))}else{if(!BG[BN]){var BO=BK._xml.transformXSL(BK._xslt,{"vpMinLat":BJ.lat,"vpMinLon":BJ.lon,"vpMaxLat":BD.lat,"vpMaxLon":BD.lon,"queryMinLat":BM.lat,"queryMinLon":BM.lon,"queryMaxLat":BM.lat+BC.lat,"queryMaxLon":BM.lon+BC.lon});AS.Internal=AT;window["eval"](BO);delete AS.Internal;BG[BN]=true;BK._loadID=setTimeout(function(){BH(new AJ(BM.lat,BM.lon+BC.lon))},0)}}}};setTimeout(function(){BH(BJ)},0)};var A7=AM.prototype;var A4=H(AM,{init:function(BD){var BC=this;if(!("zIndex" in BD)){BD.zIndex=BB}A7.init.call(this,BD);BD=Y(BD||{},{anchorPoint:new G(0.5),balloonConfig:null,balloonContentFunc:function(BF,BE){return""+BF.loc.toString()},cellCount:new G(3,3),extraData:{},imgPath:"",imgSrcFunc:function(BE){return BE.src},imgXPath:"@src",latXPath:"@lat",lonXPath:"@lon",objTagName:"p",queryFilters:"true()",size:A5});this._objects={};this._config={};this.reconfigure(BD,true);this.Load=new C();this.Load.append(function(){BC._loaded=true});if(BD.xml){this.loadXML(BD.xml)}else{if(BD.src){this.loadXMLFromFile(BD.src)}}},_anchorPoint:null,_balloonConfig:null,_balloonContentFunc:null,_cellCount:null,_config:null,_imgSrcFunc:null,_loaded:false,_loadID:0,_objects:null,_objTagName:"p",_processed:null,_size:null,_xml:null,_xslt:null,Load:null,_addObject:function(BC){if(this.elem){BC.attach(this.elem)}this.update(U.UPDATE_PAN)},_createObject:function(BF){var BC=AQ("img"),BE=BC.style,BD=this._size;BC.id=BF;BE.position="absolute";BE.width=BD.width+"px";BE.height=BD.height+"px";this.elem.appendChild(BC);this._objects[BF]={elem:BC};return BC},_deleteObject:function(BG){var BE=this._objects,BF=BE[BG];if(BF){var BD=BF.balloon,BC=BF.elem;if(BD){BD.destroy()}if(BC){T(BC)}delete BE[BG]}},_removeObject:function(BC,BD){BC.detach()},_update:function(BC){if(!this.map||!this._xml){return }var BE=(BC&U.UPDATE_ZOOM||BC&U.UPDATE_SIZE);if(BE){A9.call(this);this._lastPan=this.map.getPan()}var BD=(BC&U.UPDATE_PAN&&!this.map.isDragging())||BC&U.UPDATE_END_PAN;if(BD||BE){BA.call(this)}},destroy:function(){var BC=this;if(!this._loaded){this.Load.append(function(){BC.destroy()})}else{A9.call(this);A7.destroy.call(this)}},getLocation:function(BG){var BD=this._xml.selectSingleNode("//"+this._objTagName+"["+BG+"]");if(BD){var BC=this._config,BE=BD.selectSingleNode(BC.latXPath),BF=BD.selectSingleNode(BC.lonXPath);if(BE){BE=BE.text()}if(BF){BF=BF.text()}return new AJ(BE,BF)}else{return null}},isLoaded:function(){return this._loaded},loadXML:function(BC){this._loaded=false;this._xml=new AC(BC);this.update(U.UPDATE_ZOOM)},loadXMLFromFile:function(BE){var BC=this;var BD=new A1();BD.Load.append(function(BF,BH,BG){BC.loadXML(BG)});BD.get(BE)},reconfigure:function(BD,BF){var BC=this._config;this._anchorPoint=BC.anchorPoint=(BD.anchorPoint||BC.anchorPoint);this._balloonContentFunc=BC.balloonContentFunc=(BD.balloonContentFunc||BC.balloonContentFunc);this._cellCount=BC.cellCount=(BD.cellCount||BC.cellCount);this._imgSrcFunc=BC.imgSrcFunc=(BD.imgSrcFunc||BC.imgSrcFunc);this._size=BC.size=(BD.size||BC.size);var BE=BC.balloonConfig=(BD.balloonConfig||BC.balloonConfig);if(BE){BE.layer=this;BE.silent=true}this._balloonConfig=BE;A2.call(this,BD);if(!BF){BA.call(this)}},removeObjects:function(BD,BI){var BE=this._xml;if(!BE){return }BI=BI||A3;BD=new AC(BD);var BH=this._objTagName,BG=BD.selectNodes("//"+BH),BC=BG.length;for(var BF=0;BF<BC;BF++){BE.removeNode("//"+BH+"["+BI(BG[BF])+"]")}BA.call(this)},removeObjectsFromFile:function(BE,BF){var BC=this;var BD=new A1();BD.Load.append(function(BG,BI,BH){BC.removeObjects(BH,BF)});BD.get(BE)},updateXML:function(BF,BI){if(!this._xml){return }BI=BI||A3;BF=new AC(BF);var BH=BF.selectNodes("//"+this._objTagName);var BC=BH.length;for(var BE=0;BE<BC;BE++){var BD=BH[BE];var BG=this._xml.replaceNode("//"+this._objTagName+"["+BI(BD)+"]",BD);if(!BG){this._xml.appendChild(BD)}}BA.call(this)},updateXMLFromFile:function(BE,BF){var BC=this;var BD=new A1();BD.Load.append(function(BG,BI,BH){BC.updateXML(BH,BF)});BD.get(BE)}},{DEFAULT_SIZE:A5=new AF(16)});b(A4,["anchorPoint","balloonConfig","balloonContentFunc","cellCount","extraData","imgSrc","imgPath","imgSrcFunc","imgXPath","latXPath","lonXPath","objTagName","queryFilters","size","src","xml"]);return A4}()})();(function(){As=Ah.ZoomIndicator=function(){var A2=AT.DOM.setOpacity,A5=AT.ZIndices.ZOOM_INDICATOR,A3=Ae.prototype,A1=A3.init,A6=A3.setSize,A4=H(Ae,{init:function(A7){if(!A7){A7={}}var A9=A7.src||"",A8=A9;if(!A9){A9=A7.srcIn||A7.srcOut||"";A8=A7.srcOut||A7.srcIn||""}this._srcIn=A9;this._srcOut=A8;A7.src=A9;A1.call(this,A7,function(BA){BA.style.zIndex=A5});this._fade=("fade" in A7)?A7.fade:true;this._duration=isNaN(A7.duration)?400:A7.duration;this._maxScale=isNaN(A7.maxScale)?1:A7.maxScale;this._minScale=isNaN(A7.minScale)?0.5:A7.minScale;this._stepCount=isNaN(A7.stepCount)?8:A7.stepCount;this.hide()},_baseSize:null,_duration:400,_fade:true,_maxScale:1,_minScale:0.5,_srcIn:"",_srcOut:"",_stepCount:4,animate:function(BI){var BK=this,BJ=this._baseSize,BE=this._duration,BA=this.elem,BD=this._fade,BG=this._stepCount,A9=this._minScale,A7=this._maxScale,BH=BI?A9:A7,A8=BI?A7:A9,BC=BH,BB;this.setImage(BI?this._srcIn:this._srcOut);var BF=function(){A6.call(BK,new AF(A0(BJ.width*BC),A0(BJ.height*BC)));var BL=(BI&&BC>=A8)||(!BI&&BC<=A8);if(BL){clearInterval(BB);if(BD){A2(BA,1)}BK.hide()}else{BC+=(A8-BH)/BG;if(BD){A2(BA,1-(BC-BH)/(A8-BH))}BK.show()}};BB=setInterval(BF,BE/BG)},setSize:function(A7){this._baseSize=new AF(A7);A6.call(this,A7)}});b(A4,["duration","fade","maxScale","minScale","src","srcIn","srcOut","stepCount"]);return A4}()})();(function(){J=AS.Widgets={}})();(function(){Aa=J.AbstractWidget=function(){var A3=o.addFocal,A1=AT.DOM.disableSelection,A5=function(){var A7=this,A8=this.elem,A6=function(BB){var BA=BB.keyCode||BB.which;if(BA){A7.Key.trigger(BA,BB)}},A9=function(BA){var BB,BC=0;if(BB=BA.wheelDelta){BC=BB/120;if(window.opera){BC=-BC}}else{if(BB=BA.detail){BC=-BB/3}}if(BC){A7.MouseWheel.trigger(BC,BA)}return AW(BA)};A3(A8,"keyup",document,A6);A3(A8,"mousewheel",document,A9);A3(A8,"mousewheel",window,A9);A3(A8,"DOMMouseScroll",window,A9)},A2=Am.prototype,A4=H(Am,{init:function(A6,A7){if(!A6){A6={}}A2.init.call(this,A6,function(A8){var A9=document.getElementById(this.id);if(A9){A1(A9);A7(A9);return A9}else{return AQ("div",A8.parent||null,this.id,A7)}});this.Key=new C();this.MouseWheel=new C();A5.call(this);J[this.id]=this},Key:null,MouseWheel:null,destroy:function(){delete J[this.id];A2.destroy.call(this)}});b(A4,["parent"]);return A4}()})();(function(){if(typeof (Ext)!=="undefined"){var A1=(AS.Widgets.ExtWrapper=function(A3,A4,A5){var A2=this;if(typeof (A4)!=="object"){A4={}}if(typeof (A5)!=="object"){A5={}}A1.superclass.constructor.call(this,A5);this.on("resize",function(A7,BA,A8,A6,A9){if(typeof (this.widget.setSize)==="function"){this.widget.setSize(new AF(2+BA,2+A8))}});this.onRender=function(A7,A6){A1.superclass.onRender.call(this,A7,A6);if(!A2.el){A2.el=A7.createChild({id:A2.id},A6)}A4.parent=A2.el;A2.widget=new A3(A4)}});Ext.extend(A1,Ext.BoxComponent,{})}})();(function(){var A3=AT.DOM,A2=AT.ZIndices,A1=v.indexOf;U=J.Map=function(){var BW=0,A6=1,BV=2,BO=1,BH=2,BB=1,BR=2,A5=4,BG=8,A4=180/An,BJ=An/180,BS=300,BD=4,BU=[1,2,4,8,16,32,64,128,192,256,384,512,1024,2048,4096,8192,16384,32768,75536,124688],BM=BU.length-1,BQ=0,A9="crosshair",BT="default",BF="pointer",A8="pointer",BN,BI=function(BZ,BY){this._zoomBoxLayer.show();var BX=this.getLatLon(this.mouseXY(BY));this._zoomBox.nw=new AJ(Ac(this._zoomBox.orig.lat,BX.lat),AD(this._zoomBox.orig.lon,BX.lon));this._zoomBox.se=new AJ(AD(this._zoomBox.orig.lat,BX.lat),Ac(this._zoomBox.orig.lon,BX.lon));this._zoomBoxLayer.setCorners(this._zoomBox.nw,this._zoomBox.se)},BE=function(Bd,BX){var Bb=this.getPan(),Ba=this._zoomIndex,Bc;Bd=(Bd>0?1:-1);var Bf=Ba+Bd;if(Bf>this._maxZoom||Bf<this._minZoom){return }var BZ=this.getCenterXY();if(this._wheelBehavior===BH){BX=Bc=BZ}else{var BY=BU[Bf]/BU[Ba];Bc=new G((BZ.x-BX.x)/BY+BX.x,(BZ.y-BX.y)/BY+BX.y)}this.hideLayers();this.pan(Bc,true);this.setZoomIndex(Bf,true);this._lastPan=Bb;var Be=this._zoomIndicator;if(Be){Be.setPosition(BX);Be.animate(Bd>0)}this.PrePan.trigger();this.PreZoom.trigger(new G(BX));this.update(BR|A5);this.showLayers();this.Pan.trigger();this.Zoom.trigger(new G(BX));this._lastPan=new G(0,0)},BP=function(BZ){var BX=this;if(!this._uiEnabled){return true}this._dragging=true;var BY;if(BZ.button==2){BY=this._rightDragBehavior}else{BY=this._dragBehavior}switch(BY){case A6:this.elem.style.cursor=A8;AB(this.elem,function(Ba){BX.panBy(Ba)},function(){BX._dragging=false;BX.elem.style.cursor=BF;BX.update(BG)});break;case BV:this.elem.style.cursor=A9;this._zoomBox.orig=this.getLatLon(this.mouseXY(BZ));this._zoomBox.nw=this._zoomBox.orig;this._zoomBox.se=this._zoomBox.orig;AB(this,BI,function(){BX._dragging=false;BX._zoomBoxLayer.hide();var Bb=BX.getXY(BX._zoomBox.nw,false);var Ba=BX.getXY(BX._zoomBox.se,false);if(Ba.x-Bb.x>5&&Ba.y-Bb.y>5){BX.zoomTo(new AR(this._zoomBox.nw,this._zoomBox.se))}BX._zoomBox.nw=new AJ();BX._zoomBox.se=new AJ();BX.elem.style.cursor=BT});break}},BL=function(Ba){if(!Ba){return new G(0,0)}var BY=this._wwp,BZ=BY/(2*An),BX=BY/2+(BJ*Ba.lon)/(2*An)*BY,Bb=BY/2-(BZ*AL(AK(An/4+(BJ*Ba.lat)/2)));return new G(BX,Bb)},BC=function(Bb){var Be=AQ("div",Bb,this.id+"_copyright_row");Be.style.position="absolute";Be.style.bottom="0px";Be.style.width=this._size.width+"px";Be.style.margin="0px 0px 0px 0px";Be.style.padding="0px 0px 0px 0px";Be.style.zIndex=A2.COPYRIGHT;var Bd=AQ("div",Be,this.id+"_copyright_div");Bd.setAttribute("align","right");var BZ=AQ("table",Bd,this.id+"_copyright_table");BZ.setAttribute("cellpadding","0");BZ.setAttribute("cellspacing","0");BZ.style.backgroundColor="#bbddff";BZ.style.borderWidth="0px 0px 0px 0px";BZ.style.padding="0px 0px 0px 0px";var BX=AQ("tbody",BZ,this.id+"_copyright_tbody");var Ba=AQ("tr",BX,this.id+"_copyright_tr");var Bc=AQ("td",Ba,this.id+"_copyright_td");Bc.style.margin="0px 0px 0px 0px";Bc.style.padding="0px 0px 0px 0px";var BY=AQ("div",Bc,this.id+"_copyright_content");BY.style.color="#0000ff";BY.style.fontFamily="verdana, sans-serif";BY.style.fontSize="10px";BY.style.padding="1px 2px 1px 2px";AS.getCopyright(function(Bf){BY.innerHTML=Bf});this._copyrightRow=Be;this._copyrightContent=BY},A7=function(){var BX=this,BY=this.elem,BZ=this.id;BY.style.overflow="hidden";this.frame=AQ("div",BY,BZ+"_frame",function(Bb){var Ba=Bb.style;Ba.position="absolute";Ba.overflow="hidden";BX.container=AQ("div",Bb,BZ+"_container",function(Bc){var Bd=Bc.style;Bd.overflow="visible";Bd.position="absolute";Bd.top="0px";Bd.left="0px"});BC.call(BX,Bb)})},BK=Aa.prototype,BA=H(Aa,{init:function(BY){var Bf=this;if(!BY){BY={}}if(!BY.parent){BY.parent=document.body}BK.init.call(this,BY,function(Bh){Ax(Bh,"mousedown",function(Bi){Bf.Drag.trigger(Bi)});Ax(Bh,"dblclick",function(Bi){Bf.slowPan(Bi)})});this._copyrightOffset=new G();this._timeLine=new K.TimeLine();this._eventTypes=new Array();var Bg=null;if(BY.size){Bg=BY.size}else{var BZ=this.elem,Be=BZ.parentNode;if(BZ.offsetWidth>0&&BZ.offsetHeight>0){Bg=new AF(BZ)}else{if(Be&&Be.offsetWidth>0&&Be.offsetHeight>0){Bg=new AF(Be)}else{Bg=new AF(240,240)}}}this._size=Bg;A7.call(this);var Ba=BY.backgroundColor||BY.backgroundColour||"#ffffff";if(Ba instanceof Z){Ba=Ba.toCSSHex()}this.frame.style.backgroundColor=Ba;this._listeners=[];this._origin=new G(0,0);this._center=BY.center||BY.centre||new AJ(34,-118);var Bd=this._maxZoom=isNaN(BY.maxZoomIndex)?BM:BY.maxZoomIndex;var BX=this._minZoom=isNaN(BY.minZoomIndex)?BQ:BY.minZoomIndex;var Bc=BY.zoomIndex;if(!(Bc>=BX&&Bc<=Bd)){Bc=8}this._zoomIndex=Bc;this._wwp=BD*BS*BU[Bc];this._uiEnabled=("uiEnabled" in BY)?BY.uiEnabled:true;this.AddListener=new C();this.Drag=new C();this.Pan=new C();this.PrePan=new C();this.PreZoom=new C();this.RemoveListener=new C();this.Resize=new C();this.Update=new C();this.Zoom=new C();this.Drag.append(function(Bh){BP.call(Bf,Bh)});this.MouseWheel.append(function(Bi,Bh){if(!Bf._uiEnabled){return true}BE.call(Bf,Bi,Bf.mouseXY(Bh))});this.setDragBehavior(BY.dragBehavior||BY.dragBehaviour||BY.dragMode||A6);this.setRightDragBehavior(BY.rightDragBehavior||BY.rightDragMode||BW);this.setWheelBehavior(BY.wheelBehavior||BY.wheelBehaviour||BY.wheelMode||BO);this.setSize(this._size,true);if(!("createTiles" in BY)||BY.createTiles){var Bb=BY.tileLayerConfig||{};Bb.map=this;if(!Bb.id){Bb.id=this.id+"_tiles"}new a(Bb)}this.setZoomIndicator(BY.zoomIndicator||null)},_center:null,_copyrightOffset:null,_copyrightRow:null,_dragBehavior:A6,_rightDragBehavior:BW,_dragging:false,_listeners:null,_maxZoom:0,_minZoom:0,_origin:null,_size:null,_timeLine:null,_uiEnabled:true,_wheelBehavior:BO,_wwp:0,_zoomIndicator:null,_zoomIndex:0,AddListener:null,container:null,Drag:null,frame:null,Pan:null,PrePan:null,PreZoom:null,RemoveListener:null,Resize:null,Update:null,Zoom:null,addListener:function(BY){if(typeof (BY.update)!=="function"){throw new O("map listener does not specify an update() method.")}if(typeof (BY.setMap)!=="function"){throw new O("map listener does not specify a setMap() method.")}this._listeners.push(BY);var BX=BY.id;if(BX){this[BX]=BY;this.log("added "+BX+".")}this.AddListener.trigger(BY)},_eventTypes:null,_createHandler:function(){var BX=this;return function(BZ){for(var BY=BX._listeners.length-1;BY>=0;BY--){if(BX._listeners[BY]._handleEvent){if(BX._listeners[BY]._handleEvent(BZ)){break}}}}},_checkEventType:function(BY){var BX=this;if(!BX._eventTypes[BY]){BX._eventTypes[BY]=true;Ax(BX.frame,BY,BX._createHandler())}},bind:function(BX,Ba){if(!(BX instanceof BA)){throw new O("invalid GeoBase map binding")}if(!Ba){Ba=0}var BY=this;var Bb=function(){var Bc=BY._center,Bd=BX._center;if(Bc.lat!==Bd.lat||Bc.lon!==Bd.lon){BX.pan(Bc)}};var BZ=function(){var Bc=BY._zoomIndex-Ba;if(Bc<0){Bc=0}if(Bc>BX.getMaxZoomIndex()){Bc=BX.getMaxZoomIndex()}if(BX._zoomIndex!=Bc){BX.setZoomIndex(Bc)}Bb()};this.Pan.append(Bb);Bb();this.Zoom.append(BZ);BZ()},changeSize:function(BX){this.setSize(new AF(this._size.width+BX.width,this._size.height+BX.height))},destroy:function(){var BY=this._listeners;for(var BX=BY.length-1;BX>=0;BX--){BY[BX].setMap(null)}BK.destroy.call(this)},disableUI:function(){this.setUIEnabled(false)},enableUI:function(){this.setUIEnabled(true)},getCenter:function(){return this.getLatLon(this.getCenterXY())},getCenterXY:function(){var BX=this._size;return new G(A0(BX.width/2),A0(BX.height/2))},getColCount:function(){return AZ(this._size.width/BS)+1},getHeight:function(){return this._size.height},getLastZoomIndex:function(){return this._lastZoomIndex},getLastZoomLevel:function(){return BU[this._lastZoomIndex]},getLatLon:function(BY){var BZ=this._wwp/2,Bc=BZ/An,BX=BL.call(this,this._center);BX.x+=BY.x-this._size.width/2-this._origin.x;BX.y+=BY.y-this._size.height/2-this._origin.y;var Ba=(BZ-BX.y)/Bc,Bb=(BX.x-BZ)/Bc;Bb=Bb*A4;Ba=AE((i(Ba)-i(-Ba))/2)*A4;while(!isNaN(Bb)&&Bb<-180){Bb+=360}while(!isNaN(Bb)&&Bb>180){Bb-=360}return new AJ(Ba,Bb)},getMaxZoomIndex:function(){return this._maxZoom},getMinZoomIndex:function(){return this._minZoom},getOrigin:function(){return new G(this._origin)},getPan:function(){return new G(parseInt(this.container.style.left),parseInt(this.container.style.top))},getRowCount:function(){return AZ(this._size.height/BS)+1},getSize:function(){return new AF(this._size)},getStartCol:function(){var BX=this.getTileOffset();return M(-(this._origin.x+BX.x)/BS)},getStartRow:function(){var BX=this.getTileOffset();return M(-(this._origin.y+BX.y)/BS)},getTileCoords:function(Bb,BX){var BY=this._size,Ba=BD*BU[this._zoomIndex]/2,BZ=BL.call(this,this._center);BZ.x=M((BZ.x-(BY.width/2))/BS)+BX-Ba;BZ.y=M((BZ.y-(BY.height/2))/BS)+Bb-Ba;if(BZ.x<-Ba){BZ.x+=2*Ba}if(BZ.x>=Ba){BZ.x-=2*Ba}return BZ},getTileLayer:function(){var BY=this._listeners;for(var BX=0,Ba=BY.length;BX<Ba;BX++){var BZ=BY[BX];if(BZ instanceof a){return BZ}}return null},getTileLayers:function(){var BY=this._listeners,Bb=[];for(var BX=0,Ba=BY.length;BX<Ba;BX++){var BZ=BY[BX];if(BZ instanceof a){Bb.push(BZ)}}return Bb},getTileOffset:function(){var BX=this._size,BY=BL.call(this,this._center);BY.x=-((A0(BY.x)-M(BX.width/2))%BS);BY.y=-((A0(BY.y)-M(BX.height/2))%BS);if(BY.x>0){BY.x-=BS}if(BY.y>0){BY.y-=BS}return BY},getTileSize:function(){return BS},getTilesPerSuperTile:function(){return BD},getWidth:function(){return this._size.width},getXY:function(Bc,BX){var Bb=this._wwp*(Bc.lon-this._center.lon)/360,BZ=Aj(BJ*(this._center.lat+Bc.lat)/2),BY=l(BJ*(this._center.lat-Bc.lat)/2),Ba=this._wwp*AL((BZ+BY)/(BZ-BY))/(2*An);Bb+=this._origin.x+this._size.width/2;Ba+=this._origin.y+this._size.height/2;if(BX!==false){Bb=A0(Bb);Ba=A0(Ba)}return new G(Bb,Ba)},getZoomIndex:function(){return this._zoomIndex},getZoomLevel:function(BX){return BU[this._zoomIndex]},hideCopyright:function(){this._copyrightRow.style.display="none"},hideLayers:function(BX){for(var BY=0;BY<this._listeners.length;BY++){var BZ=this._listeners[BY];if(BZ instanceof AM){if(BX&&BX(BZ)){BZ.hideCumulative()}else{BZ.hideCumulative()}}}},isDragging:function(){return this._dragging},isUIEnabled:function(){return this._uiEnabled},mouseLatLon:function(BX){return this.getLatLon(this.mouseXY(BX))},mouseXY:function(BX){return A3.relMousePos(BX,this.frame)},panBy:function(Ba,BZ){var BX=new G(Ba),BY=this.container.style;BX.x+=parseInt(BY.left);BX.y+=parseInt(BY.top);this.panToCorner(BX,BZ)},pan:BN=function(BX,Ba){if(BX instanceof AJ){return this.pan(this.getXY(BX,false))}var BY=new G(BX),BZ=this._size;BY.x=BZ.width/2-BY.x;BY.y=BZ.height/2-BY.y;this.panBy(BY,Ba)},setCenter:BN,panToCorner:function(Be,BY){var Bb=false,BZ=this.container.style,Ba=BZ.left=A0(Be.x)+"px",Bc=BZ.top=A0(Be.y)+"px";if(BZ.left!==Ba||BZ.top!==Bc){if(!BY){this.hideLayers()}var Bf=this._size;var BX=new G(Bf.width/2-Be.x,Bf.height/2-Be.y);this._center=this.getLatLon(BX);this.resetOrigin();Bb=true}else{var Bd=this._origin;Bd.x=Be.x;Bd.y=Be.y}if(!BY){this.PrePan.trigger();this.update(Bb?(A5|BR):A5);if(Bb){this.showLayers()}this.Pan.trigger()}},removeListener:function(BZ){var BY=this._listeners;BY.splice(A1(BY,BZ),1);var BX=BZ.id;if(BX){delete this[BX];this.log("removed "+BX+".")}this.RemoveListener.trigger(BZ)},resetOrigin:function(){var BX=this._origin,BY=this.container.style;BX.x=BX.y=0;BY.left=BY.top="0px"},setSize:function(Bc,Bd){var Ba=this._size,Bb=Bc.width,BX=Bc.height;if(Ba.width!==Bb||Ba.height!==BX||Bd){this._size=new AF(Bc);var BZ=this.elem.style,BY=this.frame.style;BZ.width=BY.width=Bb+"px";BZ.height=BY.height=BX+"px";this.setCopyrightOffset();this.hideLayers();this.update(BB);this.showLayers();this.Resize.trigger()}},setBackColor:function(BX){this.frame.style.background=BX},setCopyrightOffset:function(BX){if(BX){this._copyrightOffset=new G(BX)}this._copyrightRow.style.width=this._size.width-this._copyrightOffset.x+"px";this._copyrightRow.style.bottom=this._copyrightOffset.y+"px"},setCursor:function(BY){var BX=this.elem.style,BZ=BX.cursor;BX.cursor=BY;return BZ},setDragBehavior:function(BX){switch(BX){case BV:this._dragBehavior=BV;if(this._uiEnabled){this.elem.style.cursor=BT}this._zoomBox={orig:new AJ(),nw:new AJ(),se:new AJ()};if(!this._zoomBoxLayer){this._zoomBoxLayer=new r({borderType:"dashed",borderWidth:1,color:new Z(0,0,128,0.2),id:this.id+"_zoombox",parent:this});this._zoomBoxLayer.hide()}break;case A6:this._dragBehavior=A6;if(this._zoomBox&&!(this._rightDragBehavior==BV)){delete this._zoomBox}if(this._zoomBoxLayer&&!(this._rightDragBehavior==BV)){this._zoomBoxLayer.destroy();delete this._zoomBoxLayer}if(this._uiEnabled){this.elem.style.cursor=BF}break;default:throw new f("unrecognised dragging behavior #"+BX+' for map "'+this.id+'".')}},setRightDragBehavior:function(BX){switch(BX){case BV:this._rightDragBehavior=BV;if(this._uiEnabled){this.elem.style.cursor=BT}this._zoomBox={orig:new AJ(),nw:new AJ(),se:new AJ()};if(!this._zoomBoxLayer){this._zoomBoxLayer=new r({borderType:"dashed",borderWidth:1,color:new Z(0,0,128,0.2),id:this.id+"_zoombox",parent:this});this._zoomBoxLayer.hide()}break;case A6:this._rightDragBehavior=A6;if(this._zoomBox&&!(this._dragBehavior==BV)){delete this._zoomBox}if(this._zoomBoxLayer&&!(this._dragBehavior==BV)){this._zoomBoxLayer.destroy();delete this._zoomBoxLayer}break;case BW:this._rightDragBehavior=BW;if(this._zoomBox&&!(this._dragBehavior==BV)){delete this._zoomBox}if(this._zoomBoxLayer&&!(this._dragBehavior==BV)){this._zoomBoxLayer.destroy();delete this._zoomBoxLayer}break;default:throw new f("unrecognised dragging behavior #"+BX+' for map "'+this.id+'".')}},setHeight:function(BX){this.setSize(new AF(this._size.width,BX))},setMaxZoomIndex:function(BX){BX=AD(BX,this._maxZoom);this._maxZoom=BX;if(this._zoomIndex>BX){this.setZoomIndex(BX)}},setMinZoomIndex:function(BX){BX=Ac(BX,this._minZoom);this._minZoom=BX;if(this._zoomIndex<BX){this.setZoomIndex(BX)}},setUIEnabled:function(BX){this._uiEnabled=BX;if(!BX){this.elem.style.cursor=BT}},setWheelBehavior:function(BX){if(BX!==BH&&BX!==BO){throw new f("unrecognised dragging behavior #"+BX+' for map "'+this.id+'".')}this._wheelBehavior=BX},setZoomIndicator:function(BX){if(BX instanceof As){BX.setLayer(this)}else{BX=null}this._zoomIndicator=BX},setWidth:function(BX){this.setSize(new AF(BX,this._size.height))},setZoomIndex:function(BX,BZ){if(BX<this._minZoom||BX>this._maxZoom){return }var Ba=this._zoomIndex;if(Ba===BX){return }this._lastZoomIndex=Ba;this._lastPan=this.getPan();if(!BZ){this.hideLayers()}this._center=this.getCenter();this._zoomIndex=BX;this._wwp=BD*BS*BU[BX];this.resetOrigin();if(!BZ){var BY=this.getCenterXY();this.PrePan.trigger();this.PreZoom.trigger(new G(BY));this.update(BR|A5);this.showLayers();this.Pan.trigger();this.Zoom.trigger(BY)}this._lastPan=new G(0,0)},shade:function(BX,BZ){if(!(BX instanceof BA)){throw new O("cannot place a layer on an object that is not a map.")}if(typeof (BZ)!=="object"){BZ={}}var BY=this;BZ.parent=BX;BZ.viewport=this;var Ba=new r(BZ);var Bb=function(){Ba.setCorners(BY)};this.Resize.append(Bb);this.Pan.append(Bb);this.Zoom.append(Bb)},showCopyright:function(){this._copyrightRow.style.display="block"},showLayers:function(BX){for(var BY=0;BY<this._listeners.length;BY++){var BZ=this._listeners[BY];if(BZ instanceof AM){if(BX){if(BX(BZ)){BZ.showCumulative()}}else{BZ.showCumulative()}}}},slowPan:function(Bb,Ba){if(!this._uiEnabled){return true}var Bd=0;var BX=this;var BY=this.mouseXY(Bb);var Bc=new G((this._size.width/2)-BY.x,(this._size.height/2)-BY.y);var BZ=function(Be){var Bf=new G(A0((Be-Bd)*Bc.x),A0((Be-Bd)*Bc.y));Bd=Be;BX.panBy(Bf)};this._timeLine.append(new K.Transition(500,BZ,K.sine))},update:function(BX){var Ba=this._listeners;for(var BZ=0,Bb=Ba.length;BZ<Bb;BZ++){Ba[BZ].update(BX)}if((BX&BA.UPDATE_FULL)==BA.UPDATE_FULL){var BY=this;AS.getCopyright(function(Bc){if(BY._copyrightContent){BY._copyrightContent.innerHTML=Bc}})}this.Update.trigger()},worldWidthPixels:function(){return this._wwp},zoomIn:function(){if(this._zoomIndex<this._maxZoom){this.setZoomIndex(this._zoomIndex+1)}},zoomOut:function(){if(this._zoomIndex>this._minZoom){this.setZoomIndex(this._zoomIndex-1)}},zoomTo:function(Bi){var Bd=this.getPan();var Bh=this._zoomIndex;var Ba;for(Ba=this._maxZoom;Ba>=0;Ba--){this.setZoomIndex(Ba,true);var Bl=this.getXY(Bi.getSW(),false);var Bg=this.getXY(Bi.getNE(),false);var Bm=Bg.x-Bl.x;var Bj=Bl.y-Bg.y;if(Bm<this._size.width&&Bj<this._size.height){break}}this._lastZoomIndex=Bh;this._lastPan=Bd;var Bq=new G();var Bf=this._lastZoomIndex-Ba;if(Bf){var Bn=this.getCenterXY();var BY=this.getXY(Bi.getCenter(),false);var Br=t(2,Bf);var Bk=this.getSize();var BX=new AF(Bk).multiply(Br);var Be=new G(Bn.x-Bk.width/2,Bn.y+Bk.height/2);var Bc=new G(Bn.x+Bk.width/2,Bn.y-Bk.height/2);var Bp=new G(BY.x-BX.width/2,BY.y+BX.height/2);var Bo=new G(BY.x+BX.width/2,BY.y-BX.height/2);var Bb=(Be.y-Bp.y)/(Be.x-Bp.x);var BZ=(Bc.y-Bo.y)/(Bc.x-Bo.x);Bq.x=(Bb*Be.x-BZ*Bc.x-Be.y+Bc.y)/(Bb-BZ);Bq.y=Bb*(Bq.x-Be.x)+Be.y;Bq.x=A0(Bn.x+(Bq.x-Bn.x)*Br);Bq.y=A0(Bn.y+(Bq.y-Bn.y)*Br);this.hideLayers()}else{Bq=null}this.resetOrigin();this._center=Bi.getCenter();this.PrePan.trigger();if(Bq){this.PreZoom.trigger(new G(Bq))}this.update(BR|A5);if(Bf){this.showLayers()}this.Pan.trigger();if(Bq){this.Zoom.trigger(Bq)}this._lastPan=new G(0,0)}},{DRAG_NONE:BW,DRAG_PAN:A6,DRAG_ZOOM:BV,WHEEL_ZOOM_TO_CENTER:BH,WHEEL_ZOOM_TO_CURSOR:BO,UPDATE_SIZE:BB,UPDATE_ZOOM:BR,UPDATE_PAN:A5,UPDATE_END_PAN:BG,UPDATE_REDRAW:BR|A5,UPDATE_FULL:BB|BR|A5,getBoxingCursor:function(){return A9},getDefaultCursor:function(){return BT},getPanCursor:function(){return BF},getPanningCursor:function(){return A8},setBoxingCursor:function(BX){A9=BX||"crosshair"},setDefaultCursor:function(BX){BT=BX||"default"},setPanCursor:function(BX){BF=BX||"pointer"},setPanningCursor:function(BX){A8=BX||"pointer"}});b(BA,["backgroundColor","backgroundColour","center","centre","createTiles","dragBehavior","dragBehaviour","dragMode","rightDragBehavior","rightDragMode","maxZoomIndex","minZoomIndex","size","tileLayerConfig","uiEnabled","wheelBehavior","wheelBehaviour","wheelMode","zoomIndex","zoomIndicator"]);return BA}()})();(function(){Av=J.MapControl=function(){var A5=AT.DOM,A4=AT.ZIndices,A1=U.UPDATE_FULL,A3=Aa.prototype,A2=H(Aa,{init:function(A6){if(!A6){A6={}}this.map=((A6.map instanceof U)?A6.map:J[A6.map])||null;if(!A6.parent&&this.map){A6.parent=this.map.frame}A3.init.apply(this,arguments);this.elem.style.position="absolute";this.elem.style.zIndex=A4.MAP_CONTROL;this.elem.style.cursor=U.getDefaultCursor();Ar(this.elem);this.Added=new C();this.Removed=new C();this.setPosition(A6.position||new G())},_skin:null,Added:null,map:null,Removed:null,destroy:function(){this.setMap(null);A3.destroy.call(this)},setMap:function(A7,A6,A9){var A8=this.map;if(A7!==A8){if(A8){A8.removeListener(this);if(A9){A9(A8)}this.Removed.trigger(A8)}A7=this.map=((A7 instanceof U)?A7:J[A7])||null}if(A7){A7.addListener(this);if(A6){A6(A7)}this.update(A1);this.Added.trigger(A7)}},setPosition:function(A6){if(this.elem){A5.clearPosition(this.elem);this.elem.style.left=A6.x+"px";this.elem.style.top=A6.y+"px"}this.update()},update:function(A6){},whenAdded:function(A6){if(this.map){A6()}else{this.Added.appendOnce(A6)}}});b(A2,["map","position"]);Ao(A2,["getSize","update"]);return A2}()})();(function(){var A3=AT.DOM;var A2=AT.ZIndices;var A1=U.UPDATE_SIZE;J.Dock=function(){var A8=0,A4=function(){var BA=this.elem.appendChild(this._skin.createFill("dock_fill_"+A8++));BA.style.zIndex=A2.MAP_CONTROL;Ar(BA);return BA},A9=function(BB,BE,BF,BD){var BC=J.Map;if(BF<=0){return }if(!this._fills[this._fills.top]){this._fills[this._fills.top]=A4.call(this)}var BG=this._fills[this._fills.top++];var BA=this.isVertical();A3.clearPosition(BG);BG.style.display="block";BG.style.cursor=BC.getDefaultCursor();BG.style[BA?"top":"left"]=BB+"px";BG.style[BA?"left":"top"]=BE+"px";BG.style[BA?"height":"width"]=BF+"px";BG.style[BA?"width":"height"]=BD+"px"},A7=function(BC){var BB=this,BA=!isNaN(BC),BD=BA?this._items[BC]:BC;BD.control.getSize(function(BF){if(!BA){BB._items.push(BD)}BB.elem.appendChild(BD.control.elem);var BE=BB.isVertical();if(BE){BD.thickness=BF.width;BD.length=BF.height}else{BD.thickness=BF.height;BD.length=BF.width}BB.update(A1)})};var A6=Av.prototype;var A5=H(Av,{init:function(BB){if(!BB){BB={}}A6.init.call(this,BB);var BA=BB.items||[];this._align=BB.align||"bottom";this._items=[];this._fills=[];this._fills.top=0;this._skin=(BB.skin instanceof q)?BB.skin:q.standard;if(!this._skin){throw new x("no skin available for "+this.id+".")}this.elem.style.overflow="hidden";this.elem.style.zIndex=A2.MAP_CONTROL-1;this.setMap(BB.map||BB.parent||null);for(var BC=0;BC<BA.length;BC++){this.add(BA[BC])}},_align:"bottom",_fills:null,_items:null,_skin:null,map:null,add:function(BB){BB.hide();if(this.map){BB.setMap(this.map)}this.elem.appendChild(BB.elem);var BA={control:BB};A7.call(this,BA)},destroy:function(){A6.destroy.call(this)},getLength:function(){return this.map?(this.isVertical()?this.map.getHeight():this.map.getWidth()):0},getSize:function(BD){var BC=this.getLength();var BB=this.getThickness();var BA=this.isVertical();BD(BA?new AF(BB,BC):new AF(BC,BB))},getThickness:function(){var BA=this._items;var BC=0;for(var BB=0;BB<this._items.length;BB++){var BD=BA[BB].thickness;if(BD>BC){BC=BD}}return BC},isVertical:function(){return(this._align==="left"||this._align==="right")},setMap:function(BF){var BB=this,BC=this.elem,BA=this._items,BE=BA.length,BD=function(BI){BI.frame.appendChild(BC);if(BA){for(var BH=0;BH<BE;BH++){BA[BH].control.setMap(BI);A7.call(BB,BH)}}},BG=function(BI){BI.frame.removeChild(BB.elem);if(BA){for(var BH=0;BH<BE;BH++){BA[BH].control.setMap(null)}}};A6.setMap.call(this,BF,BD,BG)},update:function(BO){if(BO&A1){if(!this.map||!this._skin){return }var BH=A3.opposite(this._align);var BE=this.isVertical();var BA=this.getLength();var BK=this.getThickness();var BG;var BB=0;for(BG=0;BG<this._items.length;BG++){BB+=this._items[BG].length}A3.clearPosition(this.elem);this.elem.style[this._align]="0px";this.elem.style[BE?"height":"width"]=BA+"px";this.elem.style[BE?"width":"height"]=BK+"px";this._skin.applyBorder(this.elem,BH);this._fills.top=0;for(BG=0;BG<this._fills.length;BG++){this._fills[BG].style.display="none"}var BN=this;var BM=function(BP,BT){var BS=BP.control;A3.clearPosition(BS.elem);BS.elem.style[BE?"top":"left"]=BT+"px";BS.elem.style[BH]="0px";BS.elem.style.display="block";var BR=BK-BP.thickness;if(BR>0){var BQ=BR/2;A9.call(BN,BT,0,BP.length,BQ);A9.call(BN,BT,BK-BQ,BP.length,BQ);BS.elem.style[BE?"left":"top"]=BQ+"px"}};if(this._items.length>1){var BF=0;var BC=BA-BB;var BI=A0(BC/(this._items.length-1));for(BG=0;BG<this._items.length;BG++){BM(this._items[BG],BF);BF+=this._items[BG].length;if(BF<BA){A9.call(this,BF,0,BI,BK)}BF+=BI}}else{if(this._items.length===1){var BD=(BA-this._items[0].length)/2;var BL=BD+this._items[0].length;BM(this._items[0],BD);A9.call(this,0,0,BD,BK);A9.call(this,BL,0,BD,BK)}else{A9.call(this,0,0,BA,BK)}}if(this._align==="bottom"||this._align==="right"){var BJ=new G();BJ[BE?"x":"y"]=BK;this.map.setCopyrightOffset(BJ)}}}});b(A5,["align","items","map"]);return A5}()})();(function(){q=AS.Widgets.DockSkin=function(){var A2=Q.prototype;var A1=H(Q,{_border:"",init:function(A3){if(!A3){A3={}}A2.init.apply(this,arguments);this._border=A3.border||"1px solid black";this._images={background:(A3.background||"")};this.load()},applyBorder:function(A4,A3){var A5="border"+A3.charAt(0).toUpperCase()+A3.substring(1);A4.style[A5]=this._border},createFill:function(A4){var A3=AQ("div",null,A4);A3.style.backgroundImage="url("+this._images.background+")";return A3}});b(A1,["background","border"]);return A1}()})();(function(){var A1=AT.ZIndices;J.Scale=function(){var A7;var A2;var A6;var A5;A7=function(A9){var A8=this;var BB=function(BF){var BG=M(A9/A8._scales[BF]);return B(BG-A8._markCount)};var BA=0;var BE=BB(BA);for(var BD=1;BD<this._scales.length;BD++){var BC=BB(BD);if(BC<BE){BA=BD;BE=BC}}this._activeScale=this._scales[BA]};A2=function(){var A8=this;A8._skin.whenLoaded(function(){A8._skin.initBody(A8.elem);var BA=AQ("div",A8.elem,A8.id+"_scale_indicator");var A9=AQ("div",A8.elem,A8.id+"_unit_indicator");BA.style.zIndex=A1.MAP_CONTROL+1;A9.style.zIndex=A1.MAP_CONTROL+1;A8._skin.applyScaleLabelStyle(BA);A8._skin.applyUnitLabelStyle(A9);BA.style.position="absolute";A9.style.position="absolute";A8._scaleLabel=BA;A8._unitLabel=A9})};A6=function(){var A8;for(A8=this._markElements.length;A8<this._markPositions.length;A8++){var A9=this.elem.appendChild(this._skin.createMark(this.id+"_mark_"+A8));A9.style.zIndex=A1.MAP_CONTROL+1;this._markElements[A8]=A9}for(A8=0;A8<this._markElements.length;A8++){this._markElements[A8].style.display="none"}};A5=function(){var BF=new G(this.elem);var A9=new G(this.map.elem);var BH=new G(BF.x-A9.x,BF.y-A9.y);var BI=this._skin.getBarStart().add(BH);var BC=this._skin.getBarEnd().add(BH);var BA=this.map.getLatLon(BI);var BD=this.map.getLatLon(BC);var BG=BA.distanceTo(BD,this._unit);var BB=this._skin.getBarLength();A7.call(this,BG);var A8=A0(this._activeScale*BB/BG);this._markPositions=[];for(var BE=0;BE<BB;BE+=A8){this._markPositions.push(BE)}A6.call(this)};var A4=Av.prototype;var A3=H(Av,{_activeScale:0,_markCount:6,_markElements:null,_markPositions:null,_scales:null,_unit:I.KILOMETERS,init:function(A9){var A8=this;if(!A9){A9={}}A4.init.apply(this,arguments);this._skin=A9.skin||J.ScaleSkin.standard;if(!this._skin){throw new x('no skin available for scale "'+this.id+'".')}this._markCount=(isNaN(A9.markCount)?5:A9.markCount)+1;this._unit=A9.unit||A9.units||I.KILOMETERS;this._markElements=[];this._markPositions=[];if(A9.scales){this._scales=A9.scales}else{this._scales=[0.1,0.2,0.5,0.8,1,2,5,8,10,20,50,80,100,200,500,800,1000,2000,5000,8000]}A2.call(this);this._skin.whenLoaded(function(){A8.setMap(A8.map)})},getSize:function(A9){var A8=this;this._skin.whenLoaded(function(){A9(A8._skin.getSize())})},setMap:function(A8){A4.setMap.call(this,A8)},update:function(A8){if(!this._skin){return }var A9=this;this._skin.whenLoaded(function(){A5.call(A9);for(var BA=0;BA<A9._markPositions.length;BA++){A9._skin.placeMark(A9._markElements[BA],A9._markPositions[BA]);A9._markElements[BA].style.display="block"}A9._unitLabel.innerHTML=A9._unit;A9._scaleLabel.innerHTML="x"+A9._activeScale})}});b(A3,["markCount","scales","skin","unit","units"]);return A3}()})();(function(){var A2=AT.DOM;var A1=1;var A3=2;J.ScaleSkin=function(){var A5=Q.prototype;var A4=H(Q,{_barDepth:0,_barEnd:0,_barStart:0,_labelStyle:null,_layout:0,_scaleLabelStyle:null,_unitLabelStyle:null,init:function(A6){if(!A6){A6={}}A5.init.apply(this,arguments);var A7=A6.folder||"";if(A7&&A7.charAt(A7.length-1)!=="/"){A7+="/"}this._images={body:A7+(A6.bodySrc||"body.png"),mark:A7+(A6.markSrc||"mark.png")};this.load();this._layout=A6.layout||A1;this._barDepth=A6.barDepth||0;this._barStart=A6.barStart||0;this._barEnd=A6.barEnd||0;this._labelStyle=A6.labelStyle||{};this._scaleLabelStyle=A6.scaleLabelStyle||{};this._unitLabelStyle=A6.unitLabelStyle||{}},applyScaleLabelStyle:function(A6){A2.applyStyle(A6,this._labelStyle);A2.applyStyle(A6,this._scaleLabelStyle)},applyUnitLabelStyle:function(A6){A2.applyStyle(A6,this._labelStyle);A2.applyStyle(A6,this._unitLabelStyle)},createMark:function(A7){var A6=AQ("img",null,A7);A6.setAttribute("src",this._images.mark);return A6},getBarEnd:function(){if(this._layout===A3){return new G(this._barDepth,this._barEnd)}else{return new G(this._barEnd,this._barDepth)}},getBarStart:function(){if(this._layout===A3){return new G(this._barDepth,this._barStart)}else{return new G(this._barStart,this._barDepth)}},getBarLength:function(){return this._barEnd-this._barStart},getSize:function(){return new AF(this._sizes.body)},initBody:function(A6){this._initImageDiv(A6,"body")},placeMark:function(A8,BA){var A7=this._layout===A3;var A9=M(this._sizes.mark[A7?"height":"width"]/2);var A6=M(this._sizes.mark[A7?"width":"height"]/2);A2.clearPosition(A8);A8.style[A7?"top":"left"]=this._barStart-A9+BA+"px";A8.style[A7?"left":"top"]=this._barDepth-A6+"px"}},{HORIZONTAL:A1,VERTICAL:A3});b(A4,["barDepth","barEnd","barStart","bodySrc","folder","labelStyle","layout","markSrc","scaleLabelStyle","unitLabelStyle"]);return A4}()})();(function(){var A1=U.UPDATE_ZOOM;J.Slider=function(){var A5=function(A8,A7,A9){o.add(A8,A7,A9);this._events.push({elem:A8,name:A7,callback:A9})};var A2=function(){var A7=this;this._skin.whenLoaded(function(){if(!A7._cells){var BB=A7._skin.getSize(A7._tickCount);A7.elem.style.width=BB.width;A7.elem.style.height=BB.height;A7.elem.innerHTML="";var BA=AQ("table",A7.elem,A7.id+"_table");var A8=AQ("tbody",BA,A7.id+"_table_body");BA.style.borderCollapse="collapse";BA.style.padding="0px 0px 0px 0px";A7._cells=A7._skin.createCells(A7.id,A8,A7._tickCount);for(var A9=0;A9<A7._cells.length;A9++){A7._cells[A9].style.cursor="pointer"}}})};var A6=function(){var A7=this;if(!this._cells){return }var BC=false;var BA=function(BD){return function(){if(BC){A7.map.setZoomIndex(A7.map.getMinZoomIndex()+BD);BC=false}}};var A9,A8=this._events,BB=A8.length;for(A9=0;A9<BB;A9++){o.remove(A8[A9].elem,A8[A9].name,A8[A9].callback)}this._events=[];A5.call(this,this.elem,"mousedown",function(){BC=true});for(A9=0;A9<A7._cells.length-2;A9++){A5.call(this,A7._cells[A9+1],"mouseup",BA(A9))}A5.call(this,A7._cells[0],"mouseup",function(){A7.map.zoomOut()});A5.call(this,A7._cells[A7._cells.length-1],"mouseup",function(){A7.map.zoomIn()})};var A3=Av.prototype;var A4=H(Av,{init:function(A8){var A7=this;if(!A8){A8={}}A3.init.apply(this,arguments);this._skin=A8.skin||J.SliderSkin.standard;if(!this._skin){throw new x('no skin available for slider "'+this.id+'".')}this._events=[];this._skin.whenLoaded(function(){A7.setMap(A7.map)})},_cells:null,_events:null,_tickCount:0,getSize:function(A8){var A7=this;this._skin.whenLoaded(function(){A8(A7._skin.getSize(A7._tickCount))})},setMap:function(A9){var A7=this,A8=function(BB){A7._tickCount=A7.map.getMaxZoomIndex()-A7.map.getMinZoomIndex()+1;A2.call(A7);A6.call(A7)},BA=function(BB){T(A7.elem.firstChild);A7._cells=null};A3.setMap.call(this,A9,A8,BA)},_selectedTick:null,update:function(A7){if(!this.map){return }if(!this._cells){return }if(A7&A1){var A8=this.map.getMinZoomIndex();if(this._selectedTick!=null){this._skin.unselectTick(this._cells[this._selectedTick])}this._selectedTick=this.map.getZoomIndex()-A8+1;this._skin.selectTick(this._cells[this._selectedTick])}}});b(A4,["skin"]);return A4}()})();(function(){var A1=1;var A2=2;J.SliderSkin=function(){var A4=Q.prototype;var A3=H(Q,{_layout:A1,init:function(A5){if(!A5){A5={}}A4.init.apply(this,arguments);var A6=A5.folder||"";if(A6&&A6.charAt(A6.length-1)!=="/"){A6+="/"}this._images={leftButton:A6+(A5.leftButtonSrc||"left-button.png"),rightButton:A6+(A5.rightButtonSrc||"right-button.png"),selTick:A6+(A5.selTickSrc||"tick-sel.png"),tick:A6+(A5.tickSrc||"tick.png")};this.load();this._layout=A5.layout||A1},createCells:function(BC,A9,A6){var A8=this._layout===A2;var BB=A8?A9:AQ("tr",A9,BC+"_row");var A5=function(BE){var BD=(A8?AQ("tr",BB,BE+"_row"):BB);return AQ("td",BD,BE)};var A7=[];A7.push(this._initImageDiv(A5(BC+"_left"),"leftButton"));for(var BA=0;BA<A6;BA++){A7.push(this._initImageDiv(A5(BC+"_tick_"+BA),"tick"))}A7.push(this._initImageDiv(A5(BC+"_right"),"rightButton"));return A7},getSize:function(A5){var BA=this._sizes,A6=this._layout===A2,A8=(A6?"height":"width"),BB=(A6?"width":"height"),A9=BA.tick[A8]+BA.selTick[A8]*(A5-1)+BA.leftButton[A8]+BA.rightButton[A8],A7=Ac(BA.tick[BB],BA.selTick[BB],BA.leftButton[BB],BA.rightButton[BB]);return A6?new AF(A7,A9):new AF(A9,A7)},selectTick:function(A5){this._initImageDiv(A5,"selTick")},unselectTick:function(A5){this._initImageDiv(A5,"tick")}},{HORIZONTAL:A1,VERTICAL:A2});b(A3,["folder","layout"]);return A3}()})()})()