@model SentinelMobile.Models.DriverPending
@{
    ViewBag.dplTitle = "Driver Pending List";
    ViewBag.HasLeftPanel = false;
    Layout = "~/Views/Shared/_DriverLayout.cshtml";
}

@section Header {
    <script type="text/javascript">
        var IsAuthorizedPath = "@Url.Content("~/Home/IsAuthorized/")";

        $(document).ready(function () {
            setCookie('language', '@ViewBag.DefaultLanguage', 30);
            // $("#divFootNavbar").hide();
            getPendingList(populateLV);
           // $('input[type="checkbox"]').change(_chg_);

        });

        window.onload = function () {
            $.ajax({
                url: IsAuthorizedPath,
                success: function (result) {
                    //if (result.indexOf("<!DOCTYPE html>") != -1) {
                    if (result.IsAuthorized == 0) {
                        location.replace('@Url.Content("~/Account/Login/")');
                        return;
                    }
                },
                error: function (msg) {
                }
            });
        }

        window.onunload = function () { };

        function setCookie(c_name, value, exdays) {
            var exdate = new Date();
            exdate.setDate(exdate.getDate() + exdays);
            var c_value = escape(value) + ((exdays == null) ? "" : "; expires=" + exdate.toUTCString()) + "; path=@Url.Content("~")";
            document.cookie = c_name + "=" + c_value;

            c_value = escape(value) + ((exdays == null) ? "" : "; expires=" + exdate.toUTCString()) + "; path=@Url.Content("~")" + "Account/";
            document.cookie = c_name + "=" + c_value;
        }
        //****************************************************************************
        var flag;
        function populateLV(v) {
            
            if (v == 1) {
                var len = dpl.length;
                for (var i = 0; i < len; i++) {
                    var o = dpl[i];
                    var _li = '<li data-role="fieldcontain" >';
                    _li = _li + '<div  style="height:40px;">';
                    var s = "'"+o.rID+ "','"+ o.dID +"','"+ o.dName+"'";
                    var a = '<a href="#" onclick="dplRefLog('+s+');" >' + o.dName + '</a>';
                                  
                    _li = _li + '<div  style="float: left; width: 45%; padding-top: 10px;color:brown;">' + a + '</div>';
                    _li = _li + '<div  style="float: left; width: 45%;padding-top:10px;">' + o.time + '</div>';
                    _li = _li + '<div  style="float: left; width: 10%; ">';

                    _li = _li + '<fieldset data-role="controlgroup" style="width:64px;float:right;">';
                    _li = _li + ' <input type="checkbox"  id="cb_' + i + '" data-iconpos="notext" />';
                    _li = _li + '<label for="cb_' + i + '" ></label>';
                    _li = _li + '</fieldset></div></div></li>';
                    $("#ulDpl").append(_li);
                }
                $('#ulDpl').listview('refresh');
                //$('[type="checkbox"]').checkboxradio();
                $('#dplContent').trigger('create');

                $('input[type="checkbox"]').change(_chg_);
                flag = false;
            }
        }
        
        function dplCheckAll(_this) {
            var el = _this;
            if (el)
            {
                if (!flag)
                {
                    el.title = "Uncheck All";
                    flag = true;
                    $(el).buttonMarkup({ icon: 'minus' });
                }
                else
                {
                    el.title = "Check All";
                    flag = false;
                    $(el).buttonMarkup({ icon: 'check' });
                }
            
                var len = dpl.length;
                for (var i = 0; i < len; i++) {
                    var o = dpl[i];
                    var v = $('#cb_' + i);
                   
                        o.chked = flag;
                        $(v).prop('checked', flag).checkboxradio('refresh');
                   
                }
            }
        }
        function _chg_() {
            var v = this;
            var id = v.id;
            var n = v.id.split("_");
            var i = parseInt(n[1]);
            var o = dpl[i];
            o.chked = v.checked;
        }

    </script>

    <style type="text/css">
        .ui-panel-inner {
            padding: 0;
        }

        .ui-content {
            padding: 0;
        }

            .ui-content .ui-listview {
                margin: 0;
            }

        .ui-panel .ui-body-f {
            border: none;
        }

        .ui-panel ul.ui-listview li .ui-li {
            border-top: 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.3);
        }


       
   
    </style>
}

@section HeaderRightButtons {
    <a href="#" onclick="dplCheckAll(this);" data-role="button" data-icon="check" data-iconpos="notext" data-shadow="false" data-iconshadow="false" data-inline="true">Check All</a>
}




<div data-role="content" id="dplContent">
    @*<div id="DriverPendingViewWrapper" style="margin-bottom:60px">
        <ul data-role="listview" data-filter="false" data-scroll="true" data-filter-placeholder="@SentinelMobile.Resources.HOSResources.SearchDrivers..." id="ulDriverViewList"></ul>
    
    
    </div>*@

    <div id="listviewwrapper_1" >

            <div data-role="fieldcontain" class="searchcontain">
            </div>
        <ul data-role="listview" class="dotted-list" data-filter="true" data-scroll="true" data-filter-placeholder="@SentinelMobile.Resources.HOSResources.SearchDrivers..." id="ulDpl"></ul>
        </div>
  
    <div data-role="footer" data-position="fixed" data-fullscreen="true" data-tap-toggle="false" style="z-index:2000;">
        <div data-role="navbar" data-grid="a" id="divFootNavbar">
            <ul id="ulDriverPView">
                <li><a href="#" onclick="javascript: DriverPendListApprove(); return false;" id="addmanualLog" data-icon="bars" data-role="button" data-rel="dialog" data-transition="none">@SentinelMobile.Resources.HOSResources.ApprovePendings</a></li>
                @{
                    SentinelMobile.Models.User user = Session != null ? (SentinelMobile.Models.User)Session["SentinelUser"] : null;
                    if (!user.IsDriver)
                    {
                        <li id="liaddmanualback"><a href="#" onclick="BackHistory();" id="aliaddmanualback" data-icon="arrow-l" data-role="button" data-rel="dialog" data-transition="none">@SentinelMobile.Resources.HOSResources.Back</a></li>
                    }}
            </ul>
        </div>
    </div>
   
</div>
